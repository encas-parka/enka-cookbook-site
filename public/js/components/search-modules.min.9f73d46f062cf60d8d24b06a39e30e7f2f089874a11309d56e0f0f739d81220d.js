const{createApp}=Vue;document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("app-search-events");if(e){const t=createApp({delimiters:["[[","]]"],data(){return{searchEventsInput:"",eventsData:[],selectedIndex:-1,isAuthenticated:!1,showModificationButton:!1}},created(){const e=localStorage.getItem("sveltia-cms.user");if(e)try{const t=JSON.parse(e);t&&t.token&&t.id?this.isAuthenticated=!0:this.isAuthenticated=!1}catch{this.isAuthenticated=!1}else this.isAuthenticated=!1;this.isAuthenticated&&(this.showModificationButton=!0)},mounted(){this.$refs.searchEventsInput.focus()},watch:{searchEventsInput(){this.selectedIndex=-1}},computed:{sortedEventsData(){return[...this.eventsData].sort((e,t)=>{if(!e.date&&!t.date)return 0;if(!e.date)return 1;if(!t.date)return-1;const n=new Date(e.date),s=new Date(t.date);return s-n})},filteredEvents(){const e=this.searchEventsInput.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"");return this.isAuthenticated?e?this.sortedEventsData.filter(t=>e.split(" ").every(e=>t.title.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").includes(e))):this.sortedEventsData:this.searchEventsInput.length>=4?this.sortedEventsData.filter(t=>e.split(" ").every(e=>t.title.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").includes(e))):[]}},methods:{closeSearch(){this.searchEventsInput="",this.selectedIndex=-1},setEventsData(e){this.eventsData=e},selectNext(){if(this.filteredEvents.length===0)return;this.selectedIndex=(this.selectedIndex+1)%this.filteredEvents.length,this.ensureVisible()},selectPrevious(){if(this.filteredEvents.length===0)return;this.selectedIndex<=0?this.selectedIndex=this.filteredEvents.length-1:this.selectedIndex--,this.ensureVisible()},navigateToSelected(){this.selectedIndex>-1&&this.filteredEvents[this.selectedIndex]&&(window.location.href=this.filteredEvents[this.selectedIndex].url)},ensureVisible(){this.$nextTick(()=>{const e=this.$refs.resultLinks;e&&e[this.selectedIndex]&&e[this.selectedIndex].scrollIntoView({block:"nearest"})})}}}),n=e.dataset.events,s=JSON.parse(n||"[]"),o=t.mount(e);o.setEventsData(s)}})