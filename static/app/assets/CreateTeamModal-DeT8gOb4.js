import{d as Te,J as Qe,A as r,y as w,v as m,k as S,g as s,h as t,K as I,m as e,u as se,af as Ke,b as i,w as X,x as oe,c as Ie,O as De,H as ue,B as qe,W as Ce,C as ve,o as a,z as Oe,e as Xe,I as Pe,ab as ra,D as Ee,V as na,ag as sa,p as fe,M as Je,T as ke,ah as Ye,ai as ia,j as he,aj as la,U as We,S as oa}from"./appwrite-BSIYiA2M.js";import{M as Ge,b as je,c as Se,d as ze}from"./index-BFQ8GO35.js";import{U as Ue,a0 as Ze,a1 as da,T as va,D as $e,a2 as He,M as Fe,e as ca,W as ua,a3 as ma,a4 as fa,C as ba,X as _a,O as ga,d as pa}from"./icons-CuLSGxOa.js";import{C as ea}from"./ConfirmModal-C-Dc5AqB.js";import"./InfoCollapse-BJFPJM04.js";var ha=m('<div class="alert alert-warning alert-soft"><!> <span class="text-sm"> </span></div>'),xa=m(`<div class="space-y-6"><fieldset class="fieldset bg-base-100"><legend class="fieldset-legend">Rôle dans l'équipe</legend> <div class="space-y-3"><label class="label cursor-pointer justify-start gap-3"><input type="radio" class="radio radio-primary"/> <span class="label-text flex flex-1 items-center gap-2"><!> <div><strong class="block">Membre</strong> <span class="text-xs opacity-70">Peut voir les ressources de l'équipe</span></div></span></label> <label class="label cursor-pointer justify-start gap-3"><input type="radio" class="radio radio-primary"/> <span class="label-text flex flex-1 items-center gap-2"><!> <div><strong class="block">Admin (Owner)</strong> <span class="text-xs opacity-70">Peut gérer les membres et les paramètres</span></div></span></label> <label class="label cursor-pointer justify-start gap-3"><input type="radio" class="radio radio-error"/> <span class="label-text flex flex-1 items-center gap-2"><!> <div><strong class="text-error block">Retirer de l'équipe</strong> <span class="text-xs opacity-70">Ce membre ne pourra plus accéder aux ressources de l'équipe</span></div></span></label></div></fieldset> <!></div>`),ya=m('<div class="flex-1"></div> <button class="btn btn-ghost">Annuler</button> <button class="btn btn-primary"><!> Valider</button>',1),wa=m("<!> <!> <!>",1);function Ma(me,n){Te(n,!0);const h=[];let o=w("keep"),q=!1;Qe(()=>{r(o,n.member.roles[0]==="owner"?"owner":"member",!0)});const z=se(()=>n.team.members.filter(P=>P.roles[0]==="owner").length),x=se(()=>n.member.roles[0]==="owner"&&e(z)===1),k=se(()=>!(e(x)&&(e(o)==="member"||e(o)==="remove"))),R=se(()=>e(x)&&(e(o)==="member"||e(o)==="remove")?"Vous devez désigner un autre administrateur avant de pouvoir rétrograder ou supprimer ce rôle.":null);async function u(){if(!e(k)||q)return;if(e(o)==="keep"||e(o)===n.member.roles[0]){n.onClose();return}const P=n.team.$id,U=n.member.$id,L=n.member.name,V=n.onMemberUpdated;n.onClose(),e(o)==="remove"?await De.track(ue.removeMember(P,U),{loading:`Suppression de ${L} de l'équipe...`,success:`${L} a été retiré de l'équipe`,error:"Erreur lors de la suppression du membre"}):await De.track(ue.updateMemberRole(P,U,e(o)),{loading:`Mise à jour du rôle de ${L}...`,success:`Rôle de ${L} mis à jour avec succès`,error:"Erreur lors de la mise à jour du rôle"}),V?.()}function $(){n.onClose()}Ge(me,{get isOpen(){return n.isOpen},onClose:$,modalClass:"!z-[1100]",maxWidth:"sm",children:(P,U)=>{var L=wa(),V=S(L);je(V,{title:"Gérer le membre",get subtitle(){return n.member.name},get onClose(){return n.onClose}});var K=s(V,2);Se(K,{children:(ie,ee)=>{var Q=xa(),b=t(Q),O=s(t(b),2),F=t(O),ae=t(F);Ce(ae),ae.disabled=q,ae.value=ae.__value="member";var Y=s(ae,2),l=t(Y);Ue(l,{class:"h-5 w-5"}),ve(2),a(Y),a(F);var v=s(F,2),p=t(v);Ce(p),p.disabled=q,p.value=p.__value="owner";var W=s(p,2),de=t(W);Ze(de,{class:"text-warning h-5 w-5"}),ve(2),a(W),a(v);var A=s(v,2),f=t(A);Ce(f),f.disabled=q,f.value=f.__value="remove";var G=s(f,2),N=t(G);da(N,{class:"text-error h-5 w-5"}),ve(2),a(G),a(A),a(O),a(b);var d=s(b,2);{var _=g=>{var c=ha(),M=t(c);va(M,{class:"h-5 w-5"});var y=s(M,2),H=t(y,!0);a(y),a(c),X(()=>oe(H,e(R))),i(g,c)};I(d,g=>{e(R)&&g(_)})}a(Q),Ke(h,[],ae,()=>e(o),g=>r(o,g)),Ke(h,[],p,()=>e(o),g=>r(o,g)),Ke(h,[],f,()=>e(o),g=>r(o,g)),i(ie,Q)}});var B=s(K,2);ze(B,{children:(ie,ee)=>{var Q=ya(),b=s(S(Q),2);b.__click=$,b.disabled=q;var O=s(b,2);O.__click=u;var F=t(O);$e(F,{class:"h-4 w-4"}),ve(),a(O),X(()=>O.disabled=!e(k)),i(ie,Q)}}),i(P,L)},$$slots:{default:!0}}),Ie()}qe(["click"]);var Ca=m('<div class="py-8 text-center opacity-50"><!> <p class="text-sm">Aucun membre</p></div>'),ka=m('<span class="text-xs opacity-50">(vous)</span>'),Ea=m('<span class="loading loading-spinner loading-xs"></span>'),Ta=m("<!> Renvoyer l'invitation",1),Ia=m('<button class="btn btn-ghost btn-sm btn-circle" title="Gérer ce membre"><!></button>'),qa=m(`<button class="btn btn-error btn-sm" title="Quitter l'équipe"><!></button>`),La=m(`<div class="card bg-base-100 border-base-200 border p-4 transition-shadow hover:shadow-md"><div class="flex items-center justify-between gap-4"><div class="flex flex-1 items-center gap-3"><div class="avatar avatar-placeholder"><div><span class="text-lg"> </span></div></div> <div class="flex-1"><div class="font-medium"> <!></div> <div class="text-sm opacity-70"> <button class="btn btn-info btn-link btn-xs py-4" title="Renvoyer l'invitation par email"><!></button></div></div></div> <div class="flex items-center gap-2"><div><!> </div> <!></div> <div class="flex gap-2"><!></div></div></div>`),Oa=m(`<div class="alert"><!> Seul les admins peuvent modifier les parametre
      de l'équipe</div> <div class="space-y-2"></div>`,1),Pa=m('<div class="space-y-4"><!></div> <!> <!>',1);function Ra(me,n){Te(n,!0);let h=w(Oe({isOpen:!1,member:null})),o=w(!1),q=w(!1),z=w(null);const x=se(()=>Pe.userId),k=se(()=>()=>e(x)&&n.team.members.find(v=>v.id===e(x))?.roles?.[0]||null),R=se(()=>e(k)()==="owner");function u(l){return new Date(l).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})}function $(l){r(h,{isOpen:!0,member:l},!0)}async function P(){await ue.fetchTeam(n.team.$id),n.onMemberRemoved?.(),r(h,{isOpen:!1,member:null},!0)}async function U(){if(!e(x))return;const l=n.team.members.find(v=>v.id===e(x));if(l){if(l.roles[0]==="owner"&&n.team.members.filter(p=>p.roles[0]==="owner"&&p.id!==e(x)).length===0){alert("Vous ne pouvez pas quitter l'équipe car vous êtes le dernier administrateur. Désignez un autre administrateur avant de quitter."),r(o,!1);return}r(q,!0);try{await ue.removeMember(n.team.$id,l.$id),r(o,!1),n.onMemberRemoved?.()}catch(v){console.error("[TeamMembersList] Erreur désinscription:",v),alert("Erreur lors de la désinscription")}finally{r(q,!1)}}}function L(l){return l==="owner"?Ze:Ue}function V(l){return l==="owner"?"badge-primary badge-soft":"badge-ghost"}function K(l){return l==="owner"?"Admin":"Membre"}async function B(l){if(e(R)){r(z,l.id,!0);try{const{functions:v}=await na(),p=sa("usersTeamsManager"),W={action:"native-invite",teamId:n.team.$id,emails:[l.userEmail]};await v.createExecution({functionId:p,body:JSON.stringify(W)}),alert(`Invitation renvoyée à ${l.name}`)}catch(v){console.error("[TeamMembersList] Erreur renvoi invitation:",v),alert("Erreur lors du renvoi de l'invitation : "+v.message)}finally{r(z,null)}}}var ie=Pa(),ee=S(ie),Q=t(ee);{var b=l=>{var v=Ca(),p=t(v);Ue(p,{class:"mx-auto mb-2 h-8 w-8"}),ve(2),a(v),i(l,v)},O=l=>{var v=Oa(),p=S(v),W=t(p);He(W,{class:"size-4 shrink-0"}),ve(),a(p);var de=s(p,2);Xe(de,21,()=>n.team.members.filter(A=>A.confirmed),A=>A.id,(A,f)=>{const G=se(()=>e(f).roles[0]),N=se(()=>L(e(G))),d=se(()=>e(f).id===e(x));var _=La(),g=t(_),c=t(g),M=t(c),y=t(M),H=t(y),te=t(H,!0);a(H),a(y),a(M);var Z=s(M,2),D=t(Z),j=t(D),re=s(j);{var ne=E=>{var T=ka();i(E,T)};I(re,E=>{e(d)&&E(ne)})}a(D);var le=s(D,2),C=t(le),J=s(C);J.__click=()=>B(e(f));var ge=t(J);{var xe=E=>{var T=Ea();i(E,T)},Le=E=>{var T=Ta(),_e=S(T);Fe(_e,{class:"h-4 w-4"}),ve(),i(E,T)};I(ge,E=>{e(z)===e(f).id?E(xe):E(Le,!1)})}a(J),a(le),a(Z),a(c);var ce=s(c,2),be=t(ce),pe=t(be);ra(pe,()=>e(N),(E,T)=>{T(E,{class:"h-3 w-3"})});var Re=s(pe);a(be);var Ne=s(be,2);{var Ve=E=>{var T=Ia();T.__click=()=>$(e(f));var _e=t(T);$e(_e,{class:"h-4 w-4"}),a(T),X(()=>T.disabled=e(q)),i(E,T)};I(Ne,E=>{e(R)&&!e(d)&&E(Ve)})}a(ce);var Ae=s(ce,2),ye=t(Ae);{var we=E=>{var T=qa();T.__click=()=>r(o,!0);var _e=t(T);ca(_e,{class:"h-4 w-4"}),a(T),X(()=>T.disabled=e(q)),i(E,T)};I(ye,E=>{e(d)&&e(f).roles?.[0]!=="owner"&&E(we)})}a(Ae),a(g),a(_),X((E,T,_e,Be)=>{Ee(y,1,`${e(f).name===Pe.userName?"bg-accent":"bg-neutral"} text-neutral-content w-12 rounded-full`),oe(te,E),oe(j,`${e(f).name??""} `),oe(C,`Membre depuis ${T??""} `),J.disabled=e(z)===e(f).id,Ee(be,1,`badge ${_e??""} gap-1`),oe(Re,` ${Be??""}`)},[()=>e(f).name.split(" ").map(E=>E[0]).join("").toUpperCase().slice(0,2),()=>u(e(f).joinedAt),()=>V(e(G)),()=>K(e(G))]),i(A,_)}),a(de),i(l,v)};I(Q,l=>{n.team.members.length===0?l(b):l(O,!1)})}a(ee);var F=s(ee,2);{var ae=l=>{Ma(l,{get isOpen(){return e(h).isOpen},get team(){return n.team},get member(){return e(h).member},onClose:()=>r(h,{isOpen:!1,member:null},!0),onMemberUpdated:P})};I(F,l=>{e(h).isOpen&&e(h).member&&l(ae)})}var Y=s(F,2);ea(Y,{get isOpen(){return e(o)},title:"Quitter l'équipe",message:"Êtes-vous sûr de vouloir quitter cette équipe ? Vous devrez être réinvité pour y revenir.",variant:"warning",confirmLabel:"Quitter",cancelLabel:"Annuler",onConfirm:U,onCancel:()=>r(o,!1)}),i(me,ie),Ie()}qe(["click"]);var Aa=m(`<div class="alert alert-soft alert-warning @max-lg:alert-vertical"><!> Seul·es les admins peuvent modifier
      les paramètres de l'équipe.</div>`),Da=m('<div class="grid grid-cols-2 gap-4"><fieldset class="fieldset"><legend class="fieldset-legend flex items-center gap-1"><!> Département</legend> <label class="input"><input type="text" placeholder="Ex: Île-de-France" maxlength="50"/></label></fieldset> <fieldset class="fieldset"><legend class="fieldset-legend flex items-center gap-1"><!> Ville</legend> <label class="input"><input type="text" placeholder="Ex: Paris" maxlength="50"/></label></fieldset></div>'),ja=m(`<div class="@container space-y-4"><!> <fieldset class="fieldset"><legend class="fieldset-legend required">Nom de l'équipe</legend> <label class="input"><input type="text" placeholder="Ex: Équipe Marketing" required aria-required="true"/></label> <span class="fieldset-label text-xs"> </span></fieldset> <fieldset class="fieldset"><legend class="fieldset-legend">Description</legend> <textarea class="textarea w-full" rows="3"></textarea> <span class="fieldset-label text-xs"> </span></fieldset> <!></div>`);function aa(me,n){Te(n,!0);let h=fe(n,"name",15),o=fe(n,"description",15),q=fe(n,"location",15,""),z=fe(n,"city",15,""),x=fe(n,"showLocation",3,!1),k=fe(n,"disabled",3,!1),R=fe(n,"nameMaxLength",3,50),u=fe(n,"descriptionMaxLength",3,350),$=h()!=="";var P=ja(),U=t(P);{var L=l=>{var v=Aa(),p=t(v);He(p,{class:"size-5 shrink-0 self-baseline"}),ve(),a(v),i(l,v)};I(U,l=>{$&&l(L)})}var V=s(U,2),K=s(t(V),2),B=t(K);Ce(B),B.__keydown=l=>n.onNameKeydown?.(l),a(K);var ie=s(K,2),ee=t(ie);a(ie),a(V);var Q=s(V,2),b=s(t(Q),2);Ye(b);var O=s(b,2),F=t(O);a(O),a(Q);var ae=s(Q,2);{var Y=l=>{var v=Da(),p=t(v),W=t(p),de=t(W);ua(de,{class:"h-4 w-4"}),ve(),a(W);var A=s(W,2),f=t(A);Ce(f),a(A),a(p);var G=s(p,2),N=t(G),d=t(N);ma(d,{class:"h-4 w-4"}),ve(),a(N);var _=s(N,2),g=t(_);Ce(g),a(_),a(G),a(v),X(()=>{f.disabled=k(),g.disabled=k()}),ke(f,q),ke(g,z),i(l,v)};I(ae,l=>{x()&&l(Y)})}a(P),X(()=>{Je(B,"maxlength",R()),B.disabled=k(),oe(ee,`${h().length??""}/${R()??""} caractères`),Je(b,"maxlength",u()),b.disabled=k(),oe(F,`${o().length??""}/${u()??""} caractères`)}),ke(B,h),ke(b,o),i(me,P),Ie()}qe(["keydown"]);function Sa(me){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(me)}var za=m('<div class="alert alert-error"><!> <span> </span></div>'),Ua=m('<label for="" class="select"><span class="label">Rôle</span> <select class="select"><option class="flex" selected>Membre</option><option>Administrateur</option></select></label>'),Fa=m('<div class="badge badge-primary badge-lg gap-2"><!> <button class="btn btn-circle btn-ghost btn-xs" title="Retirer"><!></button></div>'),Na=m('<div><div class="mb-2 text-sm font-medium opacity-70"> </div> <div class="flex flex-wrap gap-2"></div></div>'),Va=m(`<div class="@container space-y-4"><div class="alert alert-soft alert-info @max-lg:alert-vertical"><!> <div><p>Envoyez des invitations aux personnes qui font partie de votre cantine.
        Si elles possèdent déjà un compte enka-cookbook, elles pourront
        directement acceder aux événements de l'équipe, sinon, elles recevrons
        un lien pour créer leur compte.</p> <p>Il est aussi possible d'inviter des personnes individuellement à
        participer aux évenements (depuis les pages d'évenements), même si elles
        ne font pas partie de vos équipes.</p></div></div> <!> <!> <div class="rounded-box bg-base-200 flex flex-col gap-2 p-4"><div class="flex flex-wrap gap-2"><label class="input min-w-56 flex-1 gap-2"><!> <input type="email" placeholder="email@example.com"/></label> <!></div> <div>Les administrateur·ices sont seul·es autorisé·es à modifier les
      informations concernant l'équipe et à supprimer des membres.</div> <button class="btn btn-primary btn-sm ml-auto w-fit" title="Ajouter à la liste"><!> Ajouter</button></div> <!> <div><label class="label" for="invite-message"><span class="label-text">Message personnalisé (optionnel)</span></label> <textarea id="invite-message" class="textarea textarea-bordered w-full" placeholder="Ajoutez un message pour les personnes invitées..." rows="3" maxlength="200"></textarea> <span class="label label-text-alt opacity-50"> </span></div></div>`);function ta(me,n){Te(n,!0);let h=fe(n,"invitedEmails",31,()=>Oe([])),o=fe(n,"customMessage",15,""),q=fe(n,"loading",3,!1),z=fe(n,"role",15,"member"),x=w(""),k=w(null);const R=se(()=>Pe.isTeamOwner(n.team.$id));function u(){const d=e(x).trim().toLowerCase();if(!d){r(k,"Veuillez entrer une adresse email");return}if(!Sa(d)){r(k,"Adresse email invalide");return}if(h().includes(d)){r(k,"Cet email est déjà dans la liste");return}h().push(d),r(x,""),r(k,null)}function $(d){h(h().filter(_=>_!==d))}function P(d){d.key==="Enter"&&(d.preventDefault(),u())}var U=Va(),L=t(U),V=t(L);He(V,{class:"h-6 w-6 shrink-0 self-baseline"}),ve(2),a(L);var K=s(L,2);I(K,d=>{});var B=s(K,2);{var ie=d=>{var _=za(),g=t(_);ba(g,{class:"h-6 w-6 shrink-0"});var c=s(g,2),M=t(c,!0);a(c),a(_),X(()=>oe(M,e(k))),i(d,_)};I(B,d=>{e(k)&&d(ie)})}var ee=s(B,2),Q=t(ee),b=t(Q),O=t(b);Fe(O,{class:"h-4 w-4 opacity-50"});var F=s(O,2);Ce(F),F.__keydown=P,a(b);var ae=s(b,2);{var Y=d=>{var _=Ua(),g=s(t(_),2),c=t(g);c.value=c.__value="member";var M=s(c);M.value=M.__value="owner",a(g),a(_),ia(g,z),i(d,_)};I(ae,d=>{e(R)&&d(Y)})}a(Q);var l=s(Q,2),v=s(l,2);v.__click=u;var p=t(v);fa(p,{class:" h-5 w-5"}),ve(),a(v),a(ee);var W=s(ee,2);{var de=d=>{var _=Na(),g=t(_),c=t(g);a(g);var M=s(g,2);Xe(M,20,h,y=>y,(y,H)=>{var te=Fa(),Z=t(te);Fe(Z,{class:"h-3 w-3"});var D=s(Z),j=s(D);j.__click=()=>$(H);var re=t(j);_a(re,{class:"h-3 w-3"}),a(j),a(te),X(()=>{oe(D,` ${H??""} `),j.disabled=q()}),i(y,te)}),a(M),a(_),X(()=>oe(c,`Personnes à inviter (${h().length??""})`)),i(d,_)};I(W,d=>{h().length>0&&d(de)})}var A=s(W,2),f=s(t(A),2);Ye(f);var G=s(f,2),N=t(G);a(G),a(A),a(U),X(d=>{F.disabled=q(),Ee(l,1,`fieldset-label text-xs ${!e(R)&&"hidden"}`),v.disabled=d,f.disabled=q(),oe(N,`${o().length??""}/200 caractères`)},[()=>q()||!e(x).trim()]),ke(F,()=>e(x),d=>r(x,d)),ke(f,o),i(me,U),Ie()}qe(["keydown","click"]);var Ba=m('<div class="bg-warning ml-1 h-2 w-2 rounded-full"></div>'),Ka=m('<div><h4 class=" text-sm font-medium opacity-70">Inviter de nouveaux membres</h4> <!></div>'),Qa=m('<div class="tabs tabs-border mb-6 flex-none" role="tablist"><button role="tab"><!> Membres <span class="badge badge-sm badge-secondary ml-1"> </span></button> <button role="tab"><!> Invitations</button> <button role="tab"><!> Paramètres <!></button></div> <!>',1),Wa=m('<span class="loading loading-spinner loading-sm"></span>'),Ga=m('<button class="btn btn-ghost">Annuler</button> <button class="btn btn-primary"><!></button>',1),Ha=m('<span class="loading loading-spinner loading-sm"></span>'),Ja=m('<button class="btn btn-ghost">Fermer</button> <button class="btn btn-primary"><!></button>',1),Xa=m('<button class="btn btn-ghost">Fermer</button>'),Ya=m("<!> <!> <!>",1),Za=m("<!> <!>",1);function mt(me,n){Te(n,!0);let h=fe(n,"initialTab",3,"members"),o=w(Oe(h())),q=w(!1),z=w(!1),x=w(Oe([])),k=w(""),R=w(!1);const u=se(()=>n.teamId?ue.getTeamById(n.teamId):null),$=se(()=>!e(u)||!Pe.userId?null:e(u).members.find(l=>l.id===Pe.userId)?.roles?.[0]||null),P=se(()=>e($)==="owner");let U=w(""),L=w(""),V=w(""),K=w(""),B=w(!1);Qe(()=>{e(u)&&(r(U,e(u).name,!0),r(L,e(u).prefs?.description||"",!0),r(V,e(u).prefs?.location||"",!0),r(K,e(u).prefs?.city||"",!0),r(B,!1))}),Qe(()=>{e(u)&&r(B,e(U)!==e(u).name||e(L)!==(e(u).prefs?.description||"")||e(V)!==(e(u).prefs?.location||"")||e(K)!==(e(u).prefs?.city||""),!0)});async function ie(){if(!(!e(u)||!e(B))){r(z,!0);try{await ue.updateTeam(e(u).$id,e(U).trim()||void 0,{description:e(L).trim()||void 0,location:e(V).trim()||void 0,city:e(K).trim()||void 0}),r(B,!1)}catch(Y){console.error("[TeamDetailModal] Erreur sauvegarde:",Y),alert("Erreur lors de la sauvegarde")}finally{r(z,!1)}}}async function ee(){if(e(u)){r(z,!0);try{await ue.deleteTeam(e(u).$id),r(q,!1),n.onClose()}catch(Y){console.error("[TeamDetailModal] Erreur suppression:",Y),alert("Erreur lors de la suppression de l'équipe")}finally{r(z,!1)}}}async function Q(){n.teamId&&await ue.fetchTeam(n.teamId)}async function b(){if(!(!e(u)||e(x).length===0)){r(R,!0);try{await De.track(ue.inviteTeamMember(e(u).$id,e(x),e(k)||void 0),{loading:"Envoi des invitations en cours...",success:`${e(x).length} invitation${e(x).length>1?"s":""} envoyée${e(x).length>1?"s":""} avec succès`,error:"Erreur lors de l'envoi des invitations"}),r(x,[],!0),r(k,""),n.teamId&&await ue.fetchTeam(n.teamId)}catch(Y){console.error("[TeamDetailModal] Erreur envoi invitations:",Y)}finally{r(R,!1)}}}var O=Za(),F=S(O);{let Y=se(()=>n.teamId!==null);Ge(F,{get isOpen(){return e(Y)},get onClose(){return n.onClose},children:(l,v)=>{var p=he(),W=S(p);{var de=A=>{var f=Ya(),G=S(f);je(G,{get title(){return e(u).name},get subtitle(){return e(u).description},get onClose(){return n.onClose}});var N=s(G,2);Se(N,{children:(_,g)=>{var c=Qa(),M=S(c),y=t(M);y.__click=()=>r(o,"members");var H=t(y);Ue(H,{class:"mr-1 h-5 w-5"});var te=s(H,2),Z=t(te,!0);a(te),a(y);var D=s(y,2);D.__click=()=>r(o,"invitations");var j=t(D);Fe(j,{class:"mr-1 h-5 w-5"}),ve(),a(D);var re=s(D,2);re.__click=()=>r(o,"settings");var ne=t(re);ga(ne,{class:"mr-1 h-5 w-5"});var le=s(ne,2);{var C=ge=>{var xe=Ba();i(ge,xe)};I(le,ge=>{e(B)&&ge(C)})}a(re),a(M);var J=s(M,2);la(J,()=>e(o),ge=>{var xe=he(),Le=S(xe);{var ce=pe=>{Ra(pe,{get team(){return e(u)},onMemberRemoved:Q})},be=pe=>{var Re=he(),Ne=S(Re);{var Ve=ye=>{var we=Ka(),E=s(t(we),2);ta(E,{get team(){return e(u)},get loading(){return e(R)},get invitedEmails(){return e(x)},set invitedEmails(T){r(x,T,!0)},get customMessage(){return e(k)},set customMessage(T){r(k,T,!0)}}),a(we),i(ye,we)},Ae=ye=>{var we=he(),E=S(we);{var T=_e=>{{let Be=se(()=>e(z)||!e(P));aa(_e,{showLocation:!0,get disabled(){return e(Be)},get name(){return e(U)},set name(Me){r(U,Me,!0)},get description(){return e(L)},set description(Me){r(L,Me,!0)},get location(){return e(V)},set location(Me){r(V,Me,!0)},get city(){return e(K)},set city(Me){r(K,Me,!0)}})}};I(E,_e=>{e(o)==="settings"&&_e(T)},!0)}i(ye,we)};I(Ne,ye=>{e(o)==="invitations"?ye(Ve):ye(Ae,!1)},!0)}i(pe,Re)};I(Le,pe=>{e(o)==="members"?pe(ce):pe(be,!1)})}i(ge,xe)}),X(()=>{Ee(y,1,`tab ${e(o)==="members"?"tab-active":""}`),oe(Z,e(u).members.length),Ee(D,1,`tab ${e(o)==="invitations"?"tab-active":""}`),Ee(re,1,`tab ${e(o)==="settings"?"tab-active":""}`)}),i(_,c)}});var d=s(N,2);ze(d,{children:(_,g)=>{var c=he(),M=S(c);{var y=te=>{var Z=Ga(),D=S(Z);D.__click=function(...C){n.onClose?.apply(this,C)};var j=s(D,2);j.__click=ie;var re=t(j);{var ne=C=>{var J=Wa();i(C,J)},le=C=>{var J=We("Enregistrer");i(C,J)};I(re,C=>{e(z)?C(ne):C(le,!1)})}a(j),X(()=>j.disabled=e(z)||!e(B)),i(te,Z)},H=te=>{var Z=he(),D=S(Z);{var j=ne=>{var le=Ja(),C=S(le);C.__click=function(...ce){n.onClose?.apply(this,ce)};var J=s(C,2);J.__click=b;var ge=t(J);{var xe=ce=>{var be=Ha();i(ce,be)},Le=ce=>{var be=We();X(()=>oe(be,`Envoyer ${e(x).length??""} invitation${e(x).length>1?"s":""}`)),i(ce,be)};I(ge,ce=>{e(R)?ce(xe):ce(Le,!1)})}a(J),X(()=>J.disabled=e(R)||e(x).length===0),i(ne,le)},re=ne=>{var le=Xa();le.__click=function(...C){n.onClose?.apply(this,C)},i(ne,le)};I(D,ne=>{e(o)==="invitations"?ne(j):ne(re,!1)},!0)}i(te,Z)};I(M,te=>{e(o)==="settings"?te(y):te(H,!1)})}i(_,c)}}),i(A,f)};I(W,A=>{e(u)&&A(de)})}i(l,p)},$$slots:{default:!0}})}var ae=s(F,2);ea(ae,{get isOpen(){return e(q)},title:"Supprimer l'équipe",message:"Êtes-vous sûr de vouloir supprimer définitivement cette équipe ? Tous les membres seront retirés et cette action est irréversible.",variant:"danger",confirmLabel:"Supprimer définitivement",cancelLabel:"Annuler",onConfirm:ee,onCancel:()=>r(q,!1)}),i(me,O),Ie()}qe(["click"]);var $a=m('<div class="alert alert-error"><span class="text-sm"> </span></div>'),et=m('<form class="space-y-4"><!> <!></form>'),at=m('<span class="loading loading-spinner loading-sm"></span>'),tt=m(`<button class="btn btn-ghost">Annuler</button> <button class="btn btn-primary"><!> Créer l'équipe</button>`,1),rt=m("<!> <!> <!>",1),nt=m('<div class="mb-4"><div class="alert alert-success alert-soft flex flex-col"><p> </p> <p>Ajoutez les email des personnes que vous souhaitez inviter</p></div></div> <!>',1),st=m('<span class="loading loading-spinner loading-sm"></span>'),it=m('<button class="btn btn-ghost">Passer cette étape</button> <button class="btn btn-primary"><!></button>',1),lt=m("<!> <!> <!>",1);function ft(me,n){Te(n,!0);let h=w(""),o=w(""),q=w(""),z=w(""),x=w(!1),k=w(!1),R=w(null),u=w("create"),$=w(null),P=w(Oe([])),U=w(""),L=w(!1);function V(){r(h,""),r(o,""),r(q,""),r(z,""),r(x,!1),r(R,null),r(u,"create"),r($,null),r(P,[],!0),r(U,""),r(L,!1)}async function K(){if(!e(h).trim()){r(R,"Le nom de l'équipe est requis");return}r(k,!0),r(R,null);try{const b={description:e(o).trim()||void 0,location:e(q).trim()||void 0,city:e(z).trim()||void 0,isPublic:e(x)},O=await ue.createTeam(e(h).trim(),b);r($,O.$id,!0),r(u,"invite")}catch(b){r(R,b.message||"Erreur lors de la création de l'équipe",!0),console.error("[CreateTeamModal] Erreur:",b)}finally{r(k,!1)}}async function B(){if(!e($)||e(P).length===0)return;const b=e($),O=[...e(P)],F=e(U)||void 0;ie();try{await De.track(ue.inviteTeamMember(b,O,F),{loading:"Envoi des invitations en cours...",success:`${O.length} invitation${O.length>1?"s":""} envoyée${O.length>1?"s":""} avec succès`,error:"Erreur lors de l'envoi des invitations"}),await ue.fetchTeam(b)}catch(ae){console.error("[CreateTeamModal] Erreur envoi invitations:",ae)}}function ie(){const b=e($);b&&n.onSuccess?.(b),V(),n.onClose()}function ee(){V(),n.onClose()}function Q(b){b.key==="Enter"&&e(u)==="create"&&(b.preventDefault(),K())}Ge(me,{get isOpen(){return n.isOpen},onClose:ee,children:(b,O)=>{var F=he(),ae=S(F);{var Y=v=>{var p=rt(),W=S(p);je(W,{title:"Créer une équipe",onClose:ee});var de=s(W,2);Se(de,{children:(f,G)=>{var N=et(),d=t(N);aa(d,{showLocation:!0,get disabled(){return e(k)},onNameKeydown:Q,get name(){return e(h)},set name(c){r(h,c,!0)},get description(){return e(o)},set description(c){r(o,c,!0)},get location(){return e(q)},set location(c){r(q,c,!0)},get city(){return e(z)},set city(c){r(z,c,!0)}});var _=s(d,2);{var g=c=>{var M=$a(),y=t(M),H=t(y,!0);a(y),a(M),X(()=>oe(H,e(R))),i(c,M)};I(_,c=>{e(R)&&c(g)})}a(N),oa("submit",N,c=>c.preventDefault()),i(f,N)}});var A=s(de,2);ze(A,{children:(f,G)=>{var N=tt(),d=S(N);d.__click=ee;var _=s(d,2);_.__click=K;var g=t(_);{var c=y=>{var H=at();i(y,H)},M=y=>{pa(y,{class:"h-5 w-5"})};I(g,y=>{e(k)?y(c):y(M,!1)})}ve(),a(_),X(y=>{d.disabled=e(k),_.disabled=y},[()=>e(k)||!e(h).trim()]),i(f,N)}}),i(v,p)},l=v=>{var p=he(),W=S(p);{var de=A=>{const f=se(()=>ue.getTeamById(e($)));var G=he(),N=S(G);{var d=_=>{var g=lt(),c=S(g);je(c,{title:"Inviter des membres",onClose:ee});var M=s(c,2);Se(M,{children:(H,te)=>{var Z=nt(),D=S(Z),j=t(D),re=t(j),ne=t(re);a(re),ve(2),a(j),a(D);var le=s(D,2);ta(le,{get team(){return e(f)},get loading(){return e(L)},get invitedEmails(){return e(P)},set invitedEmails(C){r(P,C,!0)},get customMessage(){return e(U)},set customMessage(C){r(U,C,!0)}}),X(()=>oe(ne,`Équipe "${e(f).name??""}" créée avec succès !`)),i(H,Z)}});var y=s(M,2);ze(y,{children:(H,te)=>{var Z=it(),D=S(Z);D.__click=ie;var j=s(D,2);j.__click=B;var re=t(j);{var ne=C=>{var J=st();i(C,J)},le=C=>{var J=We();X(()=>oe(J,`Envoyer ${e(P).length??""} invitation${e(P).length>1?"s":""}`)),i(C,J)};I(re,C=>{e(L)?C(ne):C(le,!1)})}a(j),X(()=>j.disabled=e(L)||e(P).length===0),i(H,Z)}}),i(_,g)};I(N,_=>{e(f)&&_(d)})}i(A,G)};I(W,A=>{e(u)==="invite"&&e($)&&A(de)},!0)}i(v,p)};I(ae,v=>{e(u)==="create"?v(Y):v(l,!1)})}i(b,F)},$$slots:{default:!0}}),Ie()}qe(["click"]);export{ft as C,mt as T};
