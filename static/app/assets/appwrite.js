const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomePage.js","assets/index.js","assets/icons.js","assets/index.css","assets/index2.js","assets/legacy.js","assets/EmailVerificationAlert.js","assets/HomePage.css","assets/VerifyEmailPage.js","assets/RecipesListPage.js","assets/Fieldset.js","assets/AutocompleteInput.js","assets/keyboardNavigation.svelte.js","assets/BadgeList.js","assets/CheckboxBadge.js","assets/RecipeRegimeBadges.js","assets/LeftPanel.js","assets/RecipeDataStore.svelte.js","assets/RecipeDetailPage.js","assets/RecipePreparation.js","assets/products-display.js","assets/SvelteMarkdown.js","assets/SvelteMarkdown.css","assets/RecipeMetadata.js","assets/AcceptInvite.js","assets/ResetPassword.js","assets/ResetPassword.css","assets/DashboardPage.js","assets/date-helpers.js","assets/CreateTeamModal.js","assets/ConfirmModal.js","assets/InfoCollapse.js","assets/EventCard.js","assets/event-stats-helpers.js","assets/BadgeEventStatus.js","assets/DocCard.js","assets/UserPage.js","assets/TeamsManagement.js","assets/EventCreatePage.js","assets/EventMealCard.js","assets/MaterielPage.js","assets/LoansPage.js","assets/BtnGroupCheck.js","assets/LoanReturnPage.js","assets/RecipeCreatePage.js","assets/RecipeEditPage2.js","assets/tiptap-markdown.es.js","assets/RecipeEditPage.css","assets/UnsavedChangesGuard.js","assets/RecipeEditPage.js","assets/EventListPage.js","assets/CreateDocumentPage.js","assets/MarkdownEditorAdvanced.js","assets/MarkdownEditorAdvanced.css","assets/CreateDocumentPage.css","assets/EditDocumentPage.js","assets/EditDocumentPage.css","assets/DocumentListPage.js","assets/EventEditPage.js","assets/EventInvitationAlert.js","assets/EventStats.js","assets/EventRecipesPage.js","assets/EventRecipesPage.css","assets/EventProductsPage.js","assets/EventProductsPage.css","assets/EventPosterPage.js","assets/EventPosterPage.css","assets/NotFoundPage.js"])))=>i.map(i=>d[i]);
var Qd=Object.defineProperty;var Jd=Object.getPrototypeOf;var Kd=Reflect.get;var oc=t=>{throw TypeError(t)};var Yd=(t,e,r)=>e in t?Qd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var T=(t,e,r)=>Yd(t,typeof e!="symbol"?e+"":e,r),xi=(t,e,r)=>e.has(t)||oc("Cannot "+r);var i=(t,e,r)=>(xi(t,e,"read from private field"),r?r.call(t):e.get(t)),y=(t,e,r)=>e.has(t)?oc("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),I=(t,e,r,s)=>(xi(t,e,"write to private field"),s?s.call(t,r):e.set(t,r),r),b=(t,e,r)=>(xi(t,e,"access private method"),r);var cc=(t,e,r)=>Kd(Jd(t),r,e);var $i=Array.isArray,Xd=Array.prototype.indexOf,Ys=Array.prototype.includes,ki=Array.from,Zd=Object.defineProperty,Ur=Object.getOwnPropertyDescriptor,vl=Object.getOwnPropertyDescriptors,bl=Object.prototype,zd=Array.prototype,Ci=Object.getPrototypeOf,lc=Object.isExtensible;function _s(t){return typeof t=="function"}const un=()=>{};function Fd(t){return t()}function Fi(t){for(var e=0;e<t.length;e++)t[e]()}function El(){var t,e,r=new Promise((s,n)=>{t=s,e=n});return{promise:r,resolve:t,reject:e}}function Xg(t,e,r=!1){return t===void 0?r?e():e:t}function Zg(t,e){if(Array.isArray(t))return t;if(!(Symbol.iterator in t))return Array.from(t);const r=[];for(const s of t)if(r.push(s),r.length===e)break;return r}const Te=2,ri=4,ga=8,So=1<<24,Qt=16,Pt=32,Jr=64,Io=128,ht=512,Me=1024,ze=2048,mr=4096,ot=8192,dr=16384,ya=32768,Ht=65536,uc=1<<17,Sl=1<<18,ws=1<<19,Il=1<<20,ur=1<<25,gs=32768,eo=1<<21,Ao=1<<22,Br=1<<23,xt=Symbol("$state"),Al=Symbol("legacy props"),ef=Symbol(""),Ms=new class extends Error{constructor(){super(...arguments);T(this,"name","StaleReactionError");T(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}},tf=1,wa=3,tn=8;function _l(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function rf(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function sf(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function nf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function af(t){throw new Error("https://svelte.dev/e/effect_orphan")}function of(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function cf(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function lf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function uf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function df(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function ff(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const hf=1,pf=2,Rl=4,mf=8,gf=16,yf=1,wf=2,vf=4,bf=8,Ef=16,Sf=1,If=2,Af=4,_f=1,Rf=2,Pf="[",Ti="[!",_o="]",va={},Pe=Symbol(),Df="http://www.w3.org/1999/xhtml",Mf="http://www.w3.org/2000/svg",$f="@attach";function ba(t){console.warn("https://svelte.dev/e/hydration_mismatch")}function kf(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Cf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let C=!1;function _t(t){C=t}let K;function $e(t){if(t===null)throw ba(),va;return K=t}function Vt(){return $e(Jt(K))}function Tf(t){if(C){if(Jt(K)!==null)throw ba(),va;K=t}}function Nf(t=1){if(C){for(var e=t,r=K;e--;)r=Jt(r);K=r}}function si(t=!0){for(var e=0,r=K;;){if(r.nodeType===tn){var s=r.data;if(s===_o){if(e===0)return r;e-=1}else(s===Pf||s===Ti)&&(e+=1)}var n=Jt(r);t&&r.remove(),r=n}}function Pl(t){if(!t||t.nodeType!==tn)throw ba(),va;return t.data}function Dl(t){return t===this.v}function Lf(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Ml(t){return!Lf(t,this.v)}let rn=!1;function Fg(){rn=!0}const jf=[];function Rs(t,e=!1,r=!1){return xa(t,new Map,"",jf,null,r)}function xa(t,e,r,s,n=null,a=!1){if(typeof t=="object"&&t!==null){var o=e.get(t);if(o!==void 0)return o;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if($i(t)){var c=Array(t.length);e.set(t,c),n!==null&&e.set(n,c);for(var l=0;l<t.length;l+=1){var u=t[l];l in t&&(c[l]=xa(u,e,r,s,null,a))}return c}if(Ci(t)===bl){c={},e.set(t,c),n!==null&&e.set(n,c);for(var d in t)c[d]=xa(t[d],e,r,s,null,a);return c}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!a)return xa(t.toJSON(),e,r,s,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}let ye=null;function Xs(t){ye=t}function Ro(t,e=!1,r){ye={p:ye,i:!1,c:null,e:null,s:t,x:null,l:rn&&!e?{s:null,u:null,$:[]}:null}}function Po(t){var e=ye,r=e.e;if(r!==null){e.e=null;for(var s of r)eu(s)}return t!==void 0&&(e.x=t),e.i=!0,ye=e.p,t??{}}function sn(){return!rn||ye!==null&&ye.l===null}let Zr=[];function $l(){var t=Zr;Zr=[],Fi(t)}function Xe(t){if(Zr.length===0&&!bn){var e=Zr;queueMicrotask(()=>{e===Zr&&$l()})}Zr.push(t)}function qf(){for(;Zr.length>0;)$l()}function kl(t){var e=Y;if(e===null)return X.f|=Br,t;if((e.f&ya)===0){if((e.f&Io)===0)throw t;e.b.error(t)}else Zs(t,e)}function Zs(t,e){for(;e!==null;){if((e.f&Io)!==0)try{e.b.error(t);return}catch(r){t=r}e=e.parent}throw t}const Of=-7169;function _e(t,e){t.f=t.f&Of|e}function Do(t){(t.f&ht)!==0||t.deps===null?_e(t,Me):_e(t,mr)}function Cl(t){if(t!==null)for(const e of t)(e.f&Te)===0||(e.f&gs)===0||(e.f^=gs,Cl(e.deps))}function Tl(t,e,r){(t.f&ze)!==0?e.add(t):(t.f&mr)!==0&&r.add(t),Cl(t.deps),_e(t,Me)}const Ta=new Set;let ee=null,ni=null,St=null,nt=[],Ni=null,to=!1,bn=!1;var $s,ks,es,Cs,Rn,Pn,ts,Ts,Gt,ro,so,Nl;const Jo=class Jo{constructor(){y(this,Gt);T(this,"committed",!1);T(this,"current",new Map);T(this,"previous",new Map);y(this,$s,new Set);y(this,ks,new Set);y(this,es,0);y(this,Cs,0);y(this,Rn,null);y(this,Pn,new Set);y(this,ts,new Set);T(this,"skipped_effects",new Set);T(this,"is_fork",!1);y(this,Ts,!1)}is_deferred(){return this.is_fork||i(this,Cs)>0}process(e){nt=[],this.apply();var r=[],s=[];for(const n of e)b(this,Gt,ro).call(this,n,r,s);if(this.is_deferred()){b(this,Gt,so).call(this,s),b(this,Gt,so).call(this,r);for(const n of this.skipped_effects)Ol(n)}else{for(const n of i(this,$s))n();i(this,$s).clear(),i(this,es)===0&&b(this,Gt,Nl).call(this),ni=this,ee=null,dc(s),dc(r),ni=null,i(this,Rn)?.resolve()}St=null}capture(e,r){r!==Pe&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&Br)===0&&(this.current.set(e,e.v),St?.set(e,e.v))}activate(){ee=this,this.apply()}deactivate(){ee===this&&(ee=null,St=null)}flush(){if(this.activate(),nt.length>0){if(Ll(),ee!==null&&ee!==this)return}else i(this,es)===0&&this.process([]);this.deactivate()}discard(){for(const e of i(this,ks))e(this);i(this,ks).clear()}increment(e){I(this,es,i(this,es)+1),e&&I(this,Cs,i(this,Cs)+1)}decrement(e){I(this,es,i(this,es)-1),e&&I(this,Cs,i(this,Cs)-1),!i(this,Ts)&&(I(this,Ts,!0),Xe(()=>{I(this,Ts,!1),this.is_deferred()?nt.length>0&&this.flush():this.revive()}))}revive(){for(const e of i(this,Pn))i(this,ts).delete(e),_e(e,ze),hr(e);for(const e of i(this,ts))_e(e,mr),hr(e);this.flush()}oncommit(e){i(this,$s).add(e)}ondiscard(e){i(this,ks).add(e)}settled(){return(i(this,Rn)??I(this,Rn,El())).promise}static ensure(){if(ee===null){const e=ee=new Jo;Ta.add(ee),bn||Xe(()=>{ee===e&&e.flush()})}return ee}apply(){}};$s=new WeakMap,ks=new WeakMap,es=new WeakMap,Cs=new WeakMap,Rn=new WeakMap,Pn=new WeakMap,ts=new WeakMap,Ts=new WeakMap,Gt=new WeakSet,ro=function(e,r,s){e.f^=Me;for(var n=e.first,a=null;n!==null;){var o=n.f,c=(o&(Pt|Jr))!==0,l=c&&(o&Me)!==0,u=l||(o&ot)!==0||this.skipped_effects.has(n);if(!u&&n.fn!==null){c?n.f^=Me:a!==null&&(o&(ri|ga|So))!==0?a.b.defer_effect(n):(o&ri)!==0?r.push(n):_a(n)&&((o&Qt)!==0&&i(this,ts).add(n),In(n));var d=n.first;if(d!==null){n=d;continue}}var h=n.parent;for(n=n.next;n===null&&h!==null;)h===a&&(a=null),n=h.next,h=h.parent}},so=function(e){for(var r=0;r<e.length;r+=1)Tl(e[r],i(this,Pn),i(this,ts))},Nl=function(){var n;if(Ta.size>1){this.previous.clear();var e=St,r=!0;for(const a of Ta){if(a===this){r=!1;continue}const o=[];for(const[l,u]of this.current){if(a.current.has(l))if(r&&u!==a.current.get(l))a.current.set(l,u);else continue;o.push(l)}if(o.length===0)continue;const c=[...a.current.keys()].filter(l=>!this.current.has(l));if(c.length>0){var s=nt;nt=[];const l=new Set,u=new Map;for(const d of o)jl(d,c,l,u);if(nt.length>0){ee=a,a.apply();for(const d of nt)b(n=a,Gt,ro).call(n,d,[],[]);a.deactivate()}nt=s}}ee=null,St=e}this.committed=!0,Ta.delete(this)};let fr=Jo;function Uf(t){var e=bn;bn=!0;try{for(var r;;){if(qf(),nt.length===0&&(ee?.flush(),nt.length===0))return Ni=null,r;Ll()}}finally{bn=e}}function Ll(){to=!0;var t=null;try{for(var e=0;nt.length>0;){var r=fr.ensure();if(e++>1e3){var s,n;Bf()}r.process(nt),xr.clear()}}finally{to=!1,Ni=null}}function Bf(){try{of()}catch(t){Zs(t,Ni)}}let Zt=null;function dc(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var s=t[r++];if((s.f&(dr|ot))===0&&_a(s)&&(Zt=new Set,In(s),s.deps===null&&s.first===null&&s.nodes===null&&(s.teardown===null&&s.ac===null?iu(s):s.fn=null),Zt?.size>0)){xr.clear();for(const n of Zt){if((n.f&(dr|ot))!==0)continue;const a=[n];let o=n.parent;for(;o!==null;)Zt.has(o)&&(Zt.delete(o),a.push(o)),o=o.parent;for(let c=a.length-1;c>=0;c--){const l=a[c];(l.f&(dr|ot))===0&&In(l)}}Zt.clear()}}Zt=null}}function jl(t,e,r,s){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const n of t.reactions){const a=n.f;(a&Te)!==0?jl(n,e,r,s):(a&(Ao|Qt))!==0&&(a&ze)===0&&ql(n,e,s)&&(_e(n,ze),hr(n))}}function ql(t,e,r){const s=r.get(t);if(s!==void 0)return s;if(t.deps!==null)for(const n of t.deps){if(Ys.call(e,n))return!0;if((n.f&Te)!==0&&ql(n,e,r))return r.set(n,!0),!0}return r.set(t,!1),!1}function hr(t){for(var e=Ni=t;e.parent!==null;){e=e.parent;var r=e.f;if(to&&e===Y&&(r&Qt)!==0&&(r&Sl)===0)return;if((r&(Jr|Pt))!==0){if((r&Me)===0)return;e.f^=Me}}nt.push(e)}function Ol(t){if(!((t.f&Pt)!==0&&(t.f&Me)!==0)){_e(t,Me);for(var e=t.first;e!==null;)Ol(e),e=e.next}}function Mo(t){let e=0,r=pr(0),s;return()=>{Co()&&(f(r),Aa(()=>(e===0&&(s=gr(()=>t(()=>De(r)))),e+=1,()=>{Xe(()=>{e-=1,e===0&&(s?.(),s=void 0,De(r))})})))}}var xf=Ht|ws|Io;function Hf(t,e,r){new Vf(t,e,r)}var et,Dn,Mt,rs,$t,ut,xe,kt,Ft,br,ss,er,Ns,ns,Ls,js,tr,gi,Ee,Ul,Bl,no,Ha,Va,ao;class Vf{constructor(e,r,s){y(this,Ee);T(this,"parent");T(this,"is_pending",!1);y(this,et);y(this,Dn,C?K:null);y(this,Mt);y(this,rs);y(this,$t);y(this,ut,null);y(this,xe,null);y(this,kt,null);y(this,Ft,null);y(this,br,null);y(this,ss,0);y(this,er,0);y(this,Ns,!1);y(this,ns,!1);y(this,Ls,new Set);y(this,js,new Set);y(this,tr,null);y(this,gi,Mo(()=>(I(this,tr,pr(i(this,ss))),()=>{I(this,tr,null)})));I(this,et,e),I(this,Mt,r),I(this,rs,s),this.parent=Y.b,this.is_pending=!!i(this,Mt).pending,I(this,$t,vs(()=>{if(Y.b=this,C){const a=i(this,Dn);Vt(),a.nodeType===tn&&a.data===Ti?b(this,Ee,Bl).call(this):(b(this,Ee,Ul).call(this),i(this,er)===0&&(this.is_pending=!1))}else{var n=b(this,Ee,no).call(this);try{I(this,ut,Je(()=>s(n)))}catch(a){this.error(a)}i(this,er)>0?b(this,Ee,Va).call(this):this.is_pending=!1}return()=>{i(this,br)?.remove()}},xf)),C&&I(this,et,K)}defer_effect(e){Tl(e,i(this,Ls),i(this,js))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!i(this,Mt).pending}update_pending_count(e){b(this,Ee,ao).call(this,e),I(this,ss,i(this,ss)+e),!(!i(this,tr)||i(this,Ns))&&(I(this,Ns,!0),Xe(()=>{I(this,Ns,!1),i(this,tr)&&zs(i(this,tr),i(this,ss))}))}get_effect_pending(){return i(this,gi).call(this),f(i(this,tr))}error(e){var r=i(this,Mt).onerror;let s=i(this,Mt).failed;if(i(this,ns)||!r&&!s)throw e;i(this,ut)&&(ke(i(this,ut)),I(this,ut,null)),i(this,xe)&&(ke(i(this,xe)),I(this,xe,null)),i(this,kt)&&(ke(i(this,kt)),I(this,kt,null)),C&&($e(i(this,Dn)),Nf(),$e(si()));var n=!1,a=!1;const o=()=>{if(n){Cf();return}n=!0,a&&ff(),fr.ensure(),I(this,ss,0),i(this,kt)!==null&&ms(i(this,kt),()=>{I(this,kt,null)}),this.is_pending=this.has_pending_snippet(),I(this,ut,b(this,Ee,Ha).call(this,()=>(I(this,ns,!1),Je(()=>i(this,rs).call(this,i(this,et)))))),i(this,er)>0?b(this,Ee,Va).call(this):this.is_pending=!1};Xe(()=>{try{a=!0,r?.(e,o),a=!1}catch(c){Zs(c,i(this,$t)&&i(this,$t).parent)}s&&I(this,kt,b(this,Ee,Ha).call(this,()=>{fr.ensure(),I(this,ns,!0);try{return Je(()=>{s(i(this,et),()=>e,()=>o)})}catch(c){return Zs(c,i(this,$t).parent),null}finally{I(this,ns,!1)}}))})}}et=new WeakMap,Dn=new WeakMap,Mt=new WeakMap,rs=new WeakMap,$t=new WeakMap,ut=new WeakMap,xe=new WeakMap,kt=new WeakMap,Ft=new WeakMap,br=new WeakMap,ss=new WeakMap,er=new WeakMap,Ns=new WeakMap,ns=new WeakMap,Ls=new WeakMap,js=new WeakMap,tr=new WeakMap,gi=new WeakMap,Ee=new WeakSet,Ul=function(){try{I(this,ut,Je(()=>i(this,rs).call(this,i(this,et))))}catch(e){this.error(e)}},Bl=function(){const e=i(this,Mt).pending;e&&(I(this,xe,Je(()=>e(i(this,et)))),Xe(()=>{var r=b(this,Ee,no).call(this);I(this,ut,b(this,Ee,Ha).call(this,()=>(fr.ensure(),Je(()=>i(this,rs).call(this,r))))),i(this,er)>0?b(this,Ee,Va).call(this):(ms(i(this,xe),()=>{I(this,xe,null)}),this.is_pending=!1)}))},no=function(){var e=i(this,et);return this.is_pending&&(I(this,br,Be()),i(this,et).before(i(this,br)),e=i(this,br)),e},Ha=function(e){var r=Y,s=X,n=ye;Wt(i(this,$t)),mt(i(this,$t)),Xs(i(this,$t).ctx);try{return e()}catch(a){return kl(a),null}finally{Wt(r),mt(s),Xs(n)}},Va=function(){const e=i(this,Mt).pending;i(this,ut)!==null&&(I(this,Ft,document.createDocumentFragment()),i(this,Ft).append(i(this,br)),lu(i(this,ut),i(this,Ft))),i(this,xe)===null&&I(this,xe,Je(()=>e(i(this,et))))},ao=function(e){var r;if(!this.has_pending_snippet()){this.parent&&b(r=this.parent,Ee,ao).call(r,e);return}if(I(this,er,i(this,er)+e),i(this,er)===0){this.is_pending=!1;for(const s of i(this,Ls))_e(s,ze),hr(s);for(const s of i(this,js))_e(s,mr),hr(s);i(this,Ls).clear(),i(this,js).clear(),i(this,xe)&&ms(i(this,xe),()=>{I(this,xe,null)}),i(this,Ft)&&(i(this,et).before(i(this,Ft)),I(this,Ft,null))}};function xl(t,e,r,s){const n=sn()?Ea:$o;var a=t.filter(p=>!p.settled);if(r.length===0&&a.length===0){s(e.map(n));return}var o=ee,c=Y,l=Wf(),u=a.length===1?a[0].promise:a.length>1?Promise.all(a.map(p=>p.promise)):null;function d(p){l();try{s(p)}catch(g){(c.f&dr)===0&&Zs(g,c)}o?.deactivate(),io()}if(r.length===0){u.then(()=>d(e.map(n)));return}function h(){l(),Promise.all(r.map(p=>Gf(p))).then(p=>d([...e.map(n),...p])).catch(p=>Zs(p,c))}u?u.then(h):h()}function Wf(){var t=Y,e=X,r=ye,s=ee;return function(a=!0){Wt(t),mt(e),Xs(r),a&&s?.activate()}}function io(){Wt(null),mt(null),Xs(null)}function Ea(t){var e=Te|ze,r=X!==null&&(X.f&Te)!==0?X:null;return Y!==null&&(Y.f|=ws),{ctx:ye,deps:null,effects:null,equals:Dl,f:e,fn:t,reactions:null,rv:0,v:Pe,wv:0,parent:r??Y,ac:null}}function Gf(t,e,r){let s=Y;s===null&&rf();var n=s.b,a=void 0,o=pr(Pe),c=!X,l=new Map;return th(()=>{var u=El();a=u.promise;try{Promise.resolve(t()).then(u.resolve,u.reject).then(()=>{d===ee&&d.committed&&d.deactivate(),io()})}catch(g){u.reject(g),io()}var d=ee;if(c){var h=n.is_rendered();n.update_pending_count(1),d.increment(h),l.get(d)?.reject(Ms),l.delete(d),l.set(d,u)}const p=(g,w=void 0)=>{if(d.activate(),w)w!==Ms&&(o.f|=Br,zs(o,w));else{(o.f&Br)!==0&&(o.f^=Br),zs(o,g);for(const[_,E]of l){if(l.delete(_),_===d)break;E.reject(Ms)}}c&&(n.update_pending_count(-1),d.decrement(h))};u.promise.then(p,g=>p(null,g||"unknown"))}),Sa(()=>{for(const u of l.values())u.reject(Ms)}),new Promise(u=>{function d(h){function p(){h===a?u(o):d(a)}h.then(p,p)}d(a)})}function z(t){const e=Ea(t);return uu(e),e}function $o(t){const e=Ea(t);return e.equals=Ml,e}function Hl(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)ke(e[r])}}function Qf(t){for(var e=t.parent;e!==null;){if((e.f&Te)===0)return(e.f&dr)===0?e:null;e=e.parent}return null}function ko(t){var e,r=Y;Wt(Qf(t));try{t.f&=~gs,Hl(t),e=pu(t)}finally{Wt(r)}return e}function Vl(t){var e=ko(t);if(!t.equals(e)&&(t.wv=fu(),(!ee?.is_fork||t.deps===null)&&(t.v=e,t.deps===null))){_e(t,Me);return}Wr||(St!==null?(Co()||ee?.is_fork)&&St.set(t,e):Do(t))}let oo=new Set;const xr=new Map;let Wl=!1;function pr(t,e){var r={f:0,v:t,reactions:null,equals:Dl,rv:0,wv:0};return r}function P(t,e){const r=pr(t);return uu(r),r}function Jf(t,e=!1,r=!0){var n;const s=pr(t);return e||(s.equals=Ml),rn&&r&&ye!==null&&ye.l!==null&&((n=ye.l).s??(n.s=[])).push(s),s}function m(t,e,r=!1){X!==null&&(!It||(X.f&uc)!==0)&&sn()&&(X.f&(Te|Qt|Ao|uc))!==0&&(pt===null||!Ys.call(pt,t))&&df();let s=r?ge(e):e;return zs(t,s)}function zs(t,e){if(!t.equals(e)){var r=t.v;Wr?xr.set(t,e):xr.set(t,r),t.v=e;var s=fr.ensure();if(s.capture(t,r),(t.f&Te)!==0){const n=t;(t.f&ze)!==0&&ko(n),Do(n)}t.wv=fu(),Gl(t,ze),sn()&&Y!==null&&(Y.f&Me)!==0&&(Y.f&(Pt|Jr))===0&&(lt===null?nh([t]):lt.push(t)),!s.is_fork&&oo.size>0&&!Wl&&Kf()}return e}function Kf(){Wl=!1;for(const t of oo)(t.f&Me)!==0&&_e(t,mr),_a(t)&&In(t);oo.clear()}function ey(t,e=1){var r=f(t),s=e===1?r++:r--;return m(t,r),s}function De(t){m(t,t.v+1)}function Gl(t,e){var r=t.reactions;if(r!==null)for(var s=sn(),n=r.length,a=0;a<n;a++){var o=r[a],c=o.f;if(!(!s&&o===Y)){var l=(c&ze)===0;if(l&&_e(o,e),(c&Te)!==0){var u=o;St?.delete(u),(c&gs)===0&&(c&ht&&(o.f|=gs),Gl(u,mr))}else l&&((c&Qt)!==0&&Zt!==null&&Zt.add(o),hr(o))}}}function ge(t){if(typeof t!="object"||t===null||xt in t)return t;const e=Ci(t);if(e!==bl&&e!==zd)return t;var r=new Map,s=$i(t),n=P(0),a=Rt,o=c=>{if(Rt===a)return c();var l=X,u=Rt;mt(null),yc(a);var d=c();return mt(l),yc(u),d};return s&&r.set("length",P(t.length)),new Proxy(t,{defineProperty(c,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&lf();var d=r.get(l);return d===void 0?d=o(()=>{var h=P(u.value);return r.set(l,h),h}):m(d,u.value,!0),!0},deleteProperty(c,l){var u=r.get(l);if(u===void 0){if(l in c){const d=o(()=>P(Pe));r.set(l,d),De(n)}}else m(u,Pe),De(n);return!0},get(c,l,u){if(l===xt)return t;var d=r.get(l),h=l in c;if(d===void 0&&(!h||Ur(c,l)?.writable)&&(d=o(()=>{var g=ge(h?c[l]:Pe),w=P(g);return w}),r.set(l,d)),d!==void 0){var p=f(d);return p===Pe?void 0:p}return Reflect.get(c,l,u)},getOwnPropertyDescriptor(c,l){var u=Reflect.getOwnPropertyDescriptor(c,l);if(u&&"value"in u){var d=r.get(l);d&&(u.value=f(d))}else if(u===void 0){var h=r.get(l),p=h?.v;if(h!==void 0&&p!==Pe)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return u},has(c,l){if(l===xt)return!0;var u=r.get(l),d=u!==void 0&&u.v!==Pe||Reflect.has(c,l);if(u!==void 0||Y!==null&&(!d||Ur(c,l)?.writable)){u===void 0&&(u=o(()=>{var p=d?ge(c[l]):Pe,g=P(p);return g}),r.set(l,u));var h=f(u);if(h===Pe)return!1}return d},set(c,l,u,d){var h=r.get(l),p=l in c;if(s&&l==="length")for(var g=u;g<h.v;g+=1){var w=r.get(g+"");w!==void 0?m(w,Pe):g in c&&(w=o(()=>P(Pe)),r.set(g+"",w))}if(h===void 0)(!p||Ur(c,l)?.writable)&&(h=o(()=>P(void 0)),m(h,ge(u)),r.set(l,h));else{p=h.v!==Pe;var _=o(()=>ge(u));m(h,_)}var E=Reflect.getOwnPropertyDescriptor(c,l);if(E?.set&&E.set.call(d,u),!p){if(s&&typeof l=="string"){var A=r.get("length"),M=Number(l);Number.isInteger(M)&&M>=A.v&&m(A,M+1)}De(n)}return!0},ownKeys(c){f(n);var l=Reflect.ownKeys(c).filter(h=>{var p=r.get(h);return p===void 0||p.v!==Pe});for(var[u,d]of r)d.v!==Pe&&!(u in c)&&l.push(u);return l},setPrototypeOf(){uf()}})}function fc(t){try{if(t!==null&&typeof t=="object"&&xt in t)return t[xt]}catch{}return t}function Ql(t,e){return Object.is(fc(t),fc(e))}var hc,Jl,Kl,Yl;function Yf(){if(hc===void 0){hc=window,Jl=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;Kl=Ur(e,"firstChild").get,Yl=Ur(e,"nextSibling").get,lc(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),lc(r)&&(r.__t=void 0)}}function Be(t=""){return document.createTextNode(t)}function Ye(t){return Kl.call(t)}function Jt(t){return Yl.call(t)}function ty(t,e){if(!C)return Ye(t);var r=Ye(K);if(r===null)r=K.appendChild(Be());else if(e&&r.nodeType!==wa){var s=Be();return r?.before(s),$e(s),s}return e&&Li(r),$e(r),r}function pc(t,e=!1){if(!C){var r=Ye(t);return r instanceof Comment&&r.data===""?Jt(r):r}if(e){if(K?.nodeType!==wa){var s=Be();return K?.before(s),$e(s),s}Li(K)}return K}function ry(t,e=1,r=!1){let s=C?K:t;for(var n;e--;)n=s,s=Jt(s);if(!C)return s;if(r){if(s?.nodeType!==wa){var a=Be();return s===null?n?.after(a):s.before(a),$e(a),a}Li(s)}return $e(s),s}function Xl(t){t.textContent=""}function Zl(){return!1}function Xf(t=""){return document.createComment(t)}function Li(t){if(t.nodeValue.length<65536)return;let e=t.nextSibling;for(;e!==null&&e.nodeType===wa;)e.remove(),t.nodeValue+=e.nodeValue,e=t.nextSibling}function Zf(t,e){if(e){const r=document.body;t.autofocus=!0,Xe(()=>{document.activeElement===r&&t.focus()})}}function sy(t){C&&Ye(t)!==null&&Xl(t)}let mc=!1;function zl(){mc||(mc=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function nn(t){var e=X,r=Y;mt(null),Wt(null);try{return t()}finally{mt(e),Wt(r)}}function ji(t,e,r,s=r){t.addEventListener(e,()=>nn(r));const n=t.__on_r;n?t.__on_r=()=>{n(),s(!0)}:t.__on_r=()=>s(!0),zl()}function Fl(t){Y===null&&(X===null&&af(),nf()),Wr&&sf()}function zf(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function wt(t,e,r){var s=Y;s!==null&&(s.f&ot)!==0&&(t|=ot);var n={ctx:ye,deps:null,nodes:null,f:t|ze|ht,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{In(n),n.f|=ya}catch(c){throw ke(n),c}else e!==null&&hr(n);var a=n;if(r&&a.deps===null&&a.teardown===null&&a.nodes===null&&a.first===a.last&&(a.f&ws)===0&&(a=a.first,(t&Qt)!==0&&(t&Ht)!==0&&a!==null&&(a.f|=Ht)),a!==null&&(a.parent=s,s!==null&&zf(a,s),X!==null&&(X.f&Te)!==0&&(t&Jr)===0)){var o=X;(o.effects??(o.effects=[])).push(a)}return n}function Co(){return X!==null&&!It}function Sa(t){const e=wt(ga,null,!1);return _e(e,Me),e.teardown=t,e}function Vr(t){Fl();var e=Y.f,r=!X&&(e&Pt)!==0&&(e&ya)===0;if(r){var s=ye;(s.e??(s.e=[])).push(t)}else return eu(t)}function eu(t){return wt(ri|Il,t,!1)}function Ff(t){return Fl(),wt(ga|Il,t,!0)}function tu(t){fr.ensure();const e=wt(Jr|ws,t,!0);return()=>{ke(e)}}function eh(t){fr.ensure();const e=wt(Jr|ws,t,!0);return(r={})=>new Promise(s=>{r.outro?ms(e,()=>{ke(e),s(void 0)}):(ke(e),s(void 0))})}function Ia(t){return wt(ri,t,!1)}function th(t){return wt(Ao|ws,t,!0)}function Aa(t,e=0){return wt(ga|e,t,!0)}function rh(t,e=[],r=[],s=[]){xl(s,e,r,n=>{wt(ga,()=>t(...n.map(f)),!0)})}function vs(t,e=0){var r=wt(Qt|e,t,!0);return r}function ru(t,e=0){var r=wt(So|e,t,!0);return r}function Je(t){return wt(Pt|ws,t,!0)}function su(t){var e=t.teardown;if(e!==null){const r=Wr,s=X;gc(!0),mt(null);try{e.call(null)}finally{gc(r),mt(s)}}}function nu(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const n=r.ac;n!==null&&nn(()=>{n.abort(Ms)});var s=r.next;(r.f&Jr)!==0?r.parent=null:ke(r,e),r=s}}function sh(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Pt)===0&&ke(e),e=r}}function ke(t,e=!0){var r=!1;(e||(t.f&Sl)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(au(t.nodes.start,t.nodes.end),r=!0),nu(t,e&&!r),ai(t,0),_e(t,dr);var s=t.nodes&&t.nodes.t;if(s!==null)for(const a of s)a.stop();su(t);var n=t.parent;n!==null&&n.first!==null&&iu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function au(t,e){for(;t!==null;){var r=t===e?null:Jt(t);t.remove(),t=r}}function iu(t){var e=t.parent,r=t.prev,s=t.next;r!==null&&(r.next=s),s!==null&&(s.prev=r),e!==null&&(e.first===t&&(e.first=s),e.last===t&&(e.last=r))}function ms(t,e,r=!0){var s=[];ou(t,s,!0);var n=()=>{r&&ke(t),e&&e()},a=s.length;if(a>0){var o=()=>--a||n();for(var c of s)c.out(o)}else n()}function ou(t,e,r){if((t.f&ot)===0){t.f^=ot;var s=t.nodes&&t.nodes.t;if(s!==null)for(const c of s)(c.is_global||r)&&e.push(c);for(var n=t.first;n!==null;){var a=n.next,o=(n.f&Ht)!==0||(n.f&Pt)!==0&&(t.f&Qt)!==0;ou(n,e,o?r:!1),n=a}}}function To(t){cu(t,!0)}function cu(t,e){if((t.f&ot)!==0){t.f^=ot,(t.f&Me)===0&&(_e(t,ze),hr(t));for(var r=t.first;r!==null;){var s=r.next,n=(r.f&Ht)!==0||(r.f&Pt)!==0;cu(r,n?e:!1),r=s}var a=t.nodes&&t.nodes.t;if(a!==null)for(const o of a)(o.is_global||e)&&o.in()}}function lu(t,e){if(t.nodes)for(var r=t.nodes.start,s=t.nodes.end;r!==null;){var n=r===s?null:Jt(r);e.append(r),r=n}}let Wa=!1,Wr=!1;function gc(t){Wr=t}let X=null,It=!1;function mt(t){X=t}let Y=null;function Wt(t){Y=t}let pt=null;function uu(t){X!==null&&(pt===null?pt=[t]:pt.push(t))}let Qe=null,Fe=0,lt=null;function nh(t){lt=t}let du=1,zr=0,Rt=zr;function yc(t){Rt=t}function fu(){return++du}function _a(t){var e=t.f;if((e&ze)!==0)return!0;if(e&Te&&(t.f&=~gs),(e&mr)!==0){for(var r=t.deps,s=r.length,n=0;n<s;n++){var a=r[n];if(_a(a)&&Vl(a),a.wv>t.wv)return!0}(e&ht)!==0&&St===null&&_e(t,Me)}return!1}function hu(t,e,r=!0){var s=t.reactions;if(s!==null&&!(pt!==null&&Ys.call(pt,t)))for(var n=0;n<s.length;n++){var a=s[n];(a.f&Te)!==0?hu(a,e,!1):e===a&&(r?_e(a,ze):(a.f&Me)!==0&&_e(a,mr),hr(a))}}function pu(t){var _;var e=Qe,r=Fe,s=lt,n=X,a=pt,o=ye,c=It,l=Rt,u=t.f;Qe=null,Fe=0,lt=null,X=(u&(Pt|Jr))===0?t:null,pt=null,Xs(t.ctx),It=!1,Rt=++zr,t.ac!==null&&(nn(()=>{t.ac.abort(Ms)}),t.ac=null);try{t.f|=eo;var d=t.fn,h=d(),p=t.deps,g=ee?.is_fork;if(Qe!==null){var w;if(g||ai(t,Fe),p!==null&&Fe>0)for(p.length=Fe+Qe.length,w=0;w<Qe.length;w++)p[Fe+w]=Qe[w];else t.deps=p=Qe;if(Co()&&(t.f&ht)!==0)for(w=Fe;w<p.length;w++)((_=p[w]).reactions??(_.reactions=[])).push(t)}else!g&&p!==null&&Fe<p.length&&(ai(t,Fe),p.length=Fe);if(sn()&&lt!==null&&!It&&p!==null&&(t.f&(Te|mr|ze))===0)for(w=0;w<lt.length;w++)hu(lt[w],t);if(n!==null&&n!==t){if(zr++,n.deps!==null)for(let E=0;E<r;E+=1)n.deps[E].rv=zr;if(e!==null)for(const E of e)E.rv=zr;lt!==null&&(s===null?s=lt:s.push(...lt))}return(t.f&Br)!==0&&(t.f^=Br),h}catch(E){return kl(E)}finally{t.f^=eo,Qe=e,Fe=r,lt=s,X=n,pt=a,Xs(o),It=c,Rt=l}}function ah(t,e){let r=e.reactions;if(r!==null){var s=Xd.call(r,t);if(s!==-1){var n=r.length-1;n===0?r=e.reactions=null:(r[s]=r[n],r.pop())}}if(r===null&&(e.f&Te)!==0&&(Qe===null||!Ys.call(Qe,e))){var a=e;(a.f&ht)!==0&&(a.f^=ht,a.f&=~gs),Do(a),Hl(a),ai(a,0)}}function ai(t,e){var r=t.deps;if(r!==null)for(var s=e;s<r.length;s++)ah(t,r[s])}function In(t){var e=t.f;if((e&dr)===0){_e(t,Me);var r=Y,s=Wa;Y=t,Wa=!0;try{(e&(Qt|So))!==0?sh(t):nu(t),su(t);var n=pu(t);t.teardown=typeof n=="function"?n:null,t.wv=du;var a}finally{Wa=s,Y=r}}}async function ih(){await Promise.resolve(),Uf()}function f(t){var e=t.f,r=(e&Te)!==0;if(X!==null&&!It){var s=Y!==null&&(Y.f&dr)!==0;if(!s&&(pt===null||!Ys.call(pt,t))){var n=X.deps;if((X.f&eo)!==0)t.rv<zr&&(t.rv=zr,Qe===null&&n!==null&&n[Fe]===t?Fe++:Qe===null?Qe=[t]:Qe.push(t));else{(X.deps??(X.deps=[])).push(t);var a=t.reactions;a===null?t.reactions=[X]:Ys.call(a,X)||a.push(X)}}}if(Wr&&xr.has(t))return xr.get(t);if(r){var o=t;if(Wr){var c=o.v;return((o.f&Me)===0&&o.reactions!==null||gu(o))&&(c=ko(o)),xr.set(o,c),c}var l=(o.f&ht)===0&&!It&&X!==null&&(Wa||(X.f&ht)!==0),u=o.deps===null;_a(o)&&(l&&(o.f|=ht),Vl(o)),l&&!u&&mu(o)}if(St?.has(t))return St.get(t);if((t.f&Br)!==0)throw t.v;return t.v}function mu(t){if(t.deps!==null){t.f|=ht;for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Te)!==0&&(e.f&ht)===0&&mu(e)}}function gu(t){if(t.v===Pe)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(xr.has(e)||(e.f&Te)!==0&&gu(e))return!0;return!1}function gr(t){var e=It;try{return It=!0,t()}finally{It=e}}function oh(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(xt in t)co(t);else if(!Array.isArray(t))for(let e in t){const r=t[e];typeof r=="object"&&r&&xt in r&&co(r)}}}function co(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let s in t)try{co(t[s],e)}catch{}const r=Ci(t);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const s=vl(r);for(let n in s){const a=s[n].get;if(a)try{a.call(t)}catch{}}}}}function ch(t){return t.endsWith("capture")&&t!=="gotpointercapture"&&t!=="lostpointercapture"}const lh=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function uh(t){return lh.includes(t)}const dh={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function fh(t){return t=t.toLowerCase(),dh[t]??t}const hh=["touchstart","touchmove"];function ph(t){return hh.includes(t)}const mh=["textarea","script","style","title"];function gh(t){return mh.includes(t)}const yu=new Set,lo=new Set;function ny(t){if(!C)return;t.removeAttribute("onload"),t.removeAttribute("onerror");const e=t.__e;e!==void 0&&(t.__e=void 0,queueMicrotask(()=>{t.isConnected&&t.dispatchEvent(e)}))}function No(t,e,r,s={}){function n(a){if(s.capture||mn.call(e,a),!a.cancelBubble)return nn(()=>r?.call(this,a))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Xe(()=>{e.addEventListener(t,n,s)}):e.addEventListener(t,n,s),n}function Fs(t,e,r,s={}){var n=No(e,t,r,s);return()=>{t.removeEventListener(e,n,s)}}function ay(t,e,r,s,n){var a={capture:s,passive:n},o=No(t,e,r,a);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Sa(()=>{e.removeEventListener(t,o,a)})}function yh(t){for(var e=0;e<t.length;e++)yu.add(t[e]);for(var r of lo)r(t)}let wc=null;function mn(t){var e=this,r=e.ownerDocument,s=t.type,n=t.composedPath?.()||[],a=n[0]||t.target;wc=t;var o=0,c=wc===t&&t.__root;if(c){var l=n.indexOf(c);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var u=n.indexOf(e);if(u===-1)return;l<=u&&(o=l)}if(a=n[o]||t.target,a!==e){Zd(t,"currentTarget",{configurable:!0,get(){return a||r}});var d=X,h=Y;mt(null),Wt(null);try{for(var p,g=[];a!==null;){var w=a.assignedSlot||a.parentNode||a.host||null;try{var _=a["__"+s];_!=null&&(!a.disabled||t.target===a)&&_.call(a,t)}catch(E){p?g.push(E):p=E}if(t.cancelBubble||w===e||w===null)break;a=w}if(p){for(let E of g)queueMicrotask(()=>{throw E});throw p}}finally{t.__root=e,delete t.currentTarget,mt(d),Wt(h)}}}function Lo(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function ct(t,e){var r=Y;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function iy(t,e){var r=(e&_f)!==0,s=(e&Rf)!==0,n,a=!t.startsWith("<!>");return()=>{if(C)return ct(K,null),K;n===void 0&&(n=Lo(a?t:"<!>"+t),r||(n=Ye(n)));var o=s||Jl?document.importNode(n,!0):n.cloneNode(!0);if(r){var c=Ye(o),l=o.lastChild;ct(c,l)}else ct(o,o);return o}}function wh(t,e,r="svg"){var s=!t.startsWith("<!>"),n=`<${r}>${s?t:"<!>"+t}</${r}>`,a;return()=>{if(C)return ct(K,null),K;if(!a){var o=Lo(n),c=Ye(o);a=Ye(c)}var l=a.cloneNode(!0);return ct(l,l),l}}function oy(t,e){return wh(t,e,"svg")}function cy(t=""){if(!C){var e=Be(t+"");return ct(e,e),e}var r=K;return r.nodeType!==wa?(r.before(r=Be()),$e(r)):Li(r),ct(r,r),r}function vc(){if(C)return ct(K,null),K;var t=document.createDocumentFragment(),e=document.createComment(""),r=Be();return t.append(e,r),ct(e,r),t}function bc(t,e){if(C){var r=Y;((r.f&ya)===0||r.nodes.end===null)&&(r.nodes.end=K),Vt();return}t!==null&&t.before(e)}let ii=!0;function Na(t){ii=t}function ly(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function uy(t,e){return vh(t,e)}const Ss=new Map;function vh(t,{target:e,anchor:r,props:s={},events:n,context:a,intro:o=!0}){Yf();var c=new Set,l=h=>{for(var p=0;p<h.length;p++){var g=h[p];if(!c.has(g)){c.add(g);var w=ph(g);e.addEventListener(g,mn,{passive:w});var _=Ss.get(g);_===void 0?(document.addEventListener(g,mn,{passive:w}),Ss.set(g,1)):Ss.set(g,_+1)}}};l(ki(yu)),lo.add(l);var u=void 0,d=eh(()=>{var h=r??e.appendChild(Be());return Hf(h,{pending:()=>{}},p=>{if(a){Ro({});var g=ye;g.c=a}if(n&&(s.$$events=n),C&&ct(p,null),ii=o,u=t(p,s)||{},ii=!0,C&&(Y.nodes.end=K,K===null||K.nodeType!==tn||K.data!==_o))throw ba(),va;a&&Po()}),()=>{for(var p of c){e.removeEventListener(p,mn);var g=Ss.get(p);--g===0?(document.removeEventListener(p,mn),Ss.delete(p)):Ss.set(p,g)}lo.delete(l),h!==r&&h.parentNode?.removeChild(h)}});return bh.set(u,d),u}let bh=new WeakMap;var bt,Ct,tt,as,Mn,$n,yi;class Ra{constructor(e,r=!0){T(this,"anchor");y(this,bt,new Map);y(this,Ct,new Map);y(this,tt,new Map);y(this,as,new Set);y(this,Mn,!0);y(this,$n,()=>{var e=ee;if(i(this,bt).has(e)){var r=i(this,bt).get(e),s=i(this,Ct).get(r);if(s)To(s),i(this,as).delete(r);else{var n=i(this,tt).get(r);n&&(i(this,Ct).set(r,n.effect),i(this,tt).delete(r),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),s=n.effect)}for(const[a,o]of i(this,bt)){if(i(this,bt).delete(a),a===e)break;const c=i(this,tt).get(o);c&&(ke(c.effect),i(this,tt).delete(o))}for(const[a,o]of i(this,Ct)){if(a===r||i(this,as).has(a))continue;const c=()=>{if(Array.from(i(this,bt).values()).includes(a)){var u=document.createDocumentFragment();lu(o,u),u.append(Be()),i(this,tt).set(a,{effect:o,fragment:u})}else ke(o);i(this,as).delete(a),i(this,Ct).delete(a)};i(this,Mn)||!s?(i(this,as).add(a),ms(o,c,!1)):c()}}});y(this,yi,e=>{i(this,bt).delete(e);const r=Array.from(i(this,bt).values());for(const[s,n]of i(this,tt))r.includes(s)||(ke(n.effect),i(this,tt).delete(s))});this.anchor=e,I(this,Mn,r)}ensure(e,r){var s=ee,n=Zl();if(r&&!i(this,Ct).has(e)&&!i(this,tt).has(e))if(n){var a=document.createDocumentFragment(),o=Be();a.append(o),i(this,tt).set(e,{effect:Je(()=>r(o)),fragment:a})}else i(this,Ct).set(e,Je(()=>r(this.anchor)));if(i(this,bt).set(s,e),n){for(const[c,l]of i(this,Ct))c===e?s.skipped_effects.delete(l):s.skipped_effects.add(l);for(const[c,l]of i(this,tt))c===e?s.skipped_effects.delete(l.effect):s.skipped_effects.add(l.effect);s.oncommit(i(this,$n)),s.ondiscard(i(this,yi))}else C&&(this.anchor=K),i(this,$n).call(this)}}bt=new WeakMap,Ct=new WeakMap,tt=new WeakMap,as=new WeakMap,Mn=new WeakMap,$n=new WeakMap,yi=new WeakMap;function Eh(t,e,r=!1){C&&Vt();var s=new Ra(t),n=r?Ht:0;function a(o,c){if(C){const u=Pl(t)===Ti;if(o===u){var l=si();$e(l),s.anchor=l,_t(!1),s.ensure(o,c),_t(!0);return}}s.ensure(o,c)}vs(()=>{var o=!1;e((c,l=!0)=>{o=!0,a(l,c)}),o||a(!1,null)},n)}function dy(t,e,r){C&&Vt();var s=new Ra(t),n=!sn();vs(()=>{var a=e();n&&a!==null&&typeof a=="object"&&(a={}),s.ensure(a,r)})}function fy(t,e){return e}function Sh(t,e,r){for(var s=[],n=e.length,a,o=e.length,c=0;c<n;c++){let h=e[c];ms(h,()=>{if(a){if(a.pending.delete(h),a.done.add(h),a.pending.size===0){var p=t.outrogroups;uo(ki(a.done)),p.delete(a),p.size===0&&(t.outrogroups=null)}}else o-=1},!1)}if(o===0){var l=s.length===0&&r!==null;if(l){var u=r,d=u.parentNode;Xl(d),d.append(u),t.items.clear()}uo(e,!l)}else a={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(a)}function uo(t,e=!0){for(var r=0;r<t.length;r++)ke(t[r],e)}var Ec;function hy(t,e,r,s,n,a=null){var o=t,c=new Map,l=(e&Rl)!==0;if(l){var u=t;o=C?$e(Ye(u)):u.appendChild(Be())}C&&Vt();var d=null,h=$o(()=>{var A=r();return $i(A)?A:A==null?[]:ki(A)}),p,g=!0;function w(){E.fallback=d,Ih(E,p,o,e,s),d!==null&&(p.length===0?(d.f&ur)===0?To(d):(d.f^=ur,gn(d,null,o)):ms(d,()=>{d=null}))}var _=vs(()=>{p=f(h);var A=p.length;let M=!1;if(C){var H=Pl(o)===Ti;H!==(A===0)&&(o=si(),$e(o),_t(!1),M=!0)}for(var B=new Set,Q=ee,N=Zl(),O=0;O<A;O+=1){C&&K.nodeType===tn&&K.data===_o&&(o=K,M=!0,_t(!1));var F=p[O],se=s(F,O),V=g?null:c.get(se);V?(V.v&&zs(V.v,F),V.i&&zs(V.i,O),N&&Q.skipped_effects.delete(V.e)):(V=Ah(c,g?o:Ec??(Ec=Be()),F,se,O,n,e,r),g||(V.e.f|=ur),c.set(se,V)),B.add(se)}if(A===0&&a&&!d&&(g?d=Je(()=>a(o)):(d=Je(()=>a(Ec??(Ec=Be()))),d.f|=ur)),C&&A>0&&$e(si()),!g)if(N){for(const[cn,ln]of c)B.has(cn)||Q.skipped_effects.add(ln.e);Q.oncommit(w),Q.ondiscard(()=>{})}else w();M&&_t(!0),f(h)}),E={effect:_,items:c,outrogroups:null,fallback:d};g=!1,C&&(o=K)}function dn(t){for(;t!==null&&(t.f&Pt)===0;)t=t.next;return t}function Ih(t,e,r,s,n){var a=(s&mf)!==0,o=e.length,c=t.items,l=dn(t.effect.first),u,d=null,h,p=[],g=[],w,_,E,A;if(a)for(A=0;A<o;A+=1)w=e[A],_=n(w,A),E=c.get(_).e,(E.f&ur)===0&&(E.nodes?.a?.measure(),(h??(h=new Set)).add(E));for(A=0;A<o;A+=1){if(w=e[A],_=n(w,A),E=c.get(_).e,t.outrogroups!==null)for(const V of t.outrogroups)V.pending.delete(E),V.done.delete(E);if((E.f&ur)!==0)if(E.f^=ur,E===l)gn(E,null,r);else{var M=d?d.next:l;E===t.effect.last&&(t.effect.last=E.prev),E.prev&&(E.prev.next=E.next),E.next&&(E.next.prev=E.prev),yr(t,d,E),yr(t,E,M),gn(E,M,r),d=E,p=[],g=[],l=dn(d.next);continue}if((E.f&ot)!==0&&(To(E),a&&(E.nodes?.a?.unfix(),(h??(h=new Set)).delete(E))),E!==l){if(u!==void 0&&u.has(E)){if(p.length<g.length){var H=g[0],B;d=H.prev;var Q=p[0],N=p[p.length-1];for(B=0;B<p.length;B+=1)gn(p[B],H,r);for(B=0;B<g.length;B+=1)u.delete(g[B]);yr(t,Q.prev,N.next),yr(t,d,Q),yr(t,N,H),l=H,d=N,A-=1,p=[],g=[]}else u.delete(E),gn(E,l,r),yr(t,E.prev,E.next),yr(t,E,d===null?t.effect.first:d.next),yr(t,d,E),d=E;continue}for(p=[],g=[];l!==null&&l!==E;)(u??(u=new Set)).add(l),g.push(l),l=dn(l.next);if(l===null)continue}(E.f&ur)===0&&p.push(E),d=E,l=dn(E.next)}if(t.outrogroups!==null){for(const V of t.outrogroups)V.pending.size===0&&(uo(ki(V.done)),t.outrogroups?.delete(V));t.outrogroups.size===0&&(t.outrogroups=null)}if(l!==null||u!==void 0){var O=[];if(u!==void 0)for(E of u)(E.f&ot)===0&&O.push(E);for(;l!==null;)(l.f&ot)===0&&l!==t.fallback&&O.push(l),l=dn(l.next);var F=O.length;if(F>0){var se=(s&Rl)!==0&&o===0?r:null;if(a){for(A=0;A<F;A+=1)O[A].nodes?.a?.measure();for(A=0;A<F;A+=1)O[A].nodes?.a?.fix()}Sh(t,O,se)}}a&&Xe(()=>{if(h!==void 0)for(E of h)E.nodes?.a?.apply()})}function Ah(t,e,r,s,n,a,o,c){var l=(o&hf)!==0?(o&gf)===0?Jf(r,!1,!1):pr(r):null,u=(o&pf)!==0?pr(n):null;return{v:l,i:u,e:Je(()=>(a(e,l??r,u??n,c),()=>{t.delete(s)}))}}function gn(t,e,r){if(t.nodes)for(var s=t.nodes.start,n=t.nodes.end,a=e&&(e.f&ur)===0?e.nodes.start:r;s!==null;){var o=Jt(s);if(a.before(s),s===n)return;s=o}}function yr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function py(t,e,r=!1,s=!1,n=!1){var a=t,o="";rh(()=>{var c=Y;if(o===(o=e()??"")){C&&Vt();return}if(c.nodes!==null&&(au(c.nodes.start,c.nodes.end),c.nodes=null),o!==""){if(C){K.data;for(var l=Vt(),u=l;l!==null&&(l.nodeType!==tn||l.data!=="");)u=l,l=Jt(l);if(l===null)throw ba(),va;ct(K,u),a=$e(l);return}var d=o+"";r?d=`<svg>${d}</svg>`:s&&(d=`<math>${d}</math>`);var h=Lo(d);if((r||s)&&(h=Ye(h)),ct(Ye(h),h.lastChild),r||s)for(;Ye(h);)a.before(Ye(h));else a.before(h)}})}function my(t,e,...r){var s=new Ra(t);vs(()=>{const n=e()??null;s.ensure(n,n&&(a=>n(a,...r)))},Ht)}function _h(t,e,r){C&&Vt();var s=new Ra(t);vs(()=>{var n=e()??null;s.ensure(n,n&&(a=>r(a,n)))},Ht)}const Rh=()=>performance.now(),lr={tick:t=>requestAnimationFrame(t),now:()=>Rh(),tasks:new Set};function wu(){const t=lr.now();lr.tasks.forEach(e=>{e.c(t)||(lr.tasks.delete(e),e.f())}),lr.tasks.size!==0&&lr.tick(wu)}function Ph(t){let e;return lr.tasks.size===0&&lr.tick(wu),{promise:new Promise(r=>{lr.tasks.add(e={c:t,f:r})}),abort(){lr.tasks.delete(e)}}}function oi(t,e){nn(()=>{t.dispatchEvent(new CustomEvent(e))})}function Dh(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(r=>r[0].toUpperCase()+r.slice(1)).join("")}function Sc(t){const e={},r=t.split(";");for(const s of r){const[n,a]=s.split(":");if(!n||a===void 0)break;const o=Dh(n.trim());e[o]=a.trim()}return e}const Mh=t=>t;let vu=null;function Ic(t){vu=t}function gy(t,e,r){var s=vu??Y,n=s.nodes,a,o,c,l=null;n.a??(n.a={element:t,measure(){a=this.element.getBoundingClientRect()},apply(){if(c?.abort(),o=this.element.getBoundingClientRect(),a.left!==o.left||a.right!==o.right||a.top!==o.top||a.bottom!==o.bottom){const u=e()(this.element,{from:a,to:o},r?.());c=ci(this.element,u,void 0,1,()=>{c?.abort(),c=void 0})}},fix(){if(!t.getAnimations().length){var{position:u,width:d,height:h}=getComputedStyle(t);if(u!=="absolute"&&u!=="fixed"){var p=t.style;l={position:p.position,width:p.width,height:p.height,transform:p.transform},p.position="absolute",p.width=d,p.height=h;var g=t.getBoundingClientRect();if(a.left!==g.left||a.top!==g.top){var w=`translate(${a.left-g.left}px, ${a.top-g.top}px)`;p.transform=p.transform?`${p.transform} ${w}`:w}}}},unfix(){if(l){var u=t.style;u.position=l.position,u.width=l.width,u.height=l.height,u.transform=l.transform}}}),n.a.element=t}function yy(t,e,r,s){var H;var n=(t&Sf)!==0,a=(t&If)!==0,o=n&&a,c=(t&Af)!==0,l=o?"both":n?"in":"out",u,d=e.inert,h=e.style.overflow,p,g;function w(){return nn(()=>u??(u=r()(e,s?.()??{},{direction:l})))}var _={is_global:c,in(){if(e.inert=d,!n){g?.abort(),g?.reset?.();return}a||p?.abort(),p=ci(e,w(),g,1,()=>{oi(e,"introend"),p?.abort(),p=u=void 0,e.style.overflow=h})},out(B){if(!a){B?.(),u=void 0;return}e.inert=!0,g=ci(e,w(),p,0,()=>{oi(e,"outroend"),B?.()})},stop:()=>{p?.abort(),g?.abort()}},E=Y;if(((H=E.nodes).t??(H.t=[])).push(_),n&&ii){var A=c;if(!A){for(var M=E.parent;M&&(M.f&Ht)!==0;)for(;(M=M.parent)&&(M.f&Qt)===0;);A=!M||(M.f&ya)!==0}A&&Ia(()=>{gr(()=>_.in())})}}function ci(t,e,r,s,n){var a=s===1;if(_s(e)){var o,c=!1;return Xe(()=>{if(!c){var E=e({direction:a?"in":"out"});o=ci(t,E,r,s,n)}}),{abort:()=>{c=!0,o?.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(r?.deactivate(),!e?.duration&&!e?.delay)return oi(t,a?"introstart":"outrostart"),n(),{abort:un,deactivate:un,reset:un,t:()=>s};const{delay:l=0,css:u,tick:d,easing:h=Mh}=e;var p=[];if(a&&r===void 0&&(d&&d(0,1),u)){var g=Sc(u(0,1));p.push(g,g)}var w=()=>1-s,_=t.animate(p,{duration:l,fill:"forwards"});return _.onfinish=()=>{_.cancel(),oi(t,a?"introstart":"outrostart");var E=r?.t()??1-s;r?.abort();var A=s-E,M=e.duration*Math.abs(A),H=[];if(M>0){var B=!1;if(u)for(var Q=Math.ceil(M/16.666666666666668),N=0;N<=Q;N+=1){var O=E+A*h(N/Q),F=Sc(u(O,1-O));H.push(F),B||(B=F.overflow==="hidden")}B&&(t.style.overflow="hidden"),w=()=>{var se=_.currentTime;return E+A*h(se/M)},d&&Ph(()=>{if(_.playState!=="running")return!1;var se=w();return d(se,1-se),!0})}_=t.animate(H,{duration:M,fill:"forwards"}),_.onfinish=()=>{w=()=>s,d?.(s,1-s),n()}},{abort:()=>{_&&(_.cancel(),_.effect=null,_.onfinish=un)},deactivate:()=>{n=un},reset:()=>{s===0&&d?.(1,0)},t:()=>w()}}function wy(t,e,r,s,n,a){let o=C;C&&Vt();var c=null;C&&K.nodeType===tf&&(c=K,Vt());var l=C?K:t,u=Y,d=new Ra(l,!1);vs(()=>{const h=e()||null;var p=Mf;if(h===null){d.ensure(null,null),Na(!0);return}return d.ensure(h,g=>{if(h){if(c=C?c:document.createElementNS(p,h),ct(c,c),s){C&&gh(h)&&c.append(document.createComment(""));var w=C?Ye(c):c.appendChild(Be());C&&(w===null?_t(!1):$e(w)),Ic(u),s(c,w),Ic(null)}Y.nodes.end=c,g.before(c)}C&&$e(g)}),Na(!0),()=>{h&&Na(!1)}},Ht),Sa(()=>{Na(!0)}),o&&(_t(!0),$e(l))}function $h(t,e){var r=void 0,s;ru(()=>{r!==(r=e())&&(s&&(ke(s),s=null),r&&(s=Je(()=>{Ia(()=>r(t))})))})}function bu(t){var e,r,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(r=bu(t[e]))&&(s&&(s+=" "),s+=r)}else for(r in t)t[r]&&(s&&(s+=" "),s+=r);return s}function kh(){for(var t,e,r=0,s="",n=arguments.length;r<n;r++)(t=arguments[r])&&(e=bu(t))&&(s&&(s+=" "),s+=e);return s}function Ch(t){return typeof t=="object"?kh(t):t??""}const Ac=[...` 	
\r\fÂ \v\uFEFF`];function Th(t,e,r){var s=t==null?"":""+t;if(e&&(s=s?s+" "+e:e),r){for(var n in r)if(r[n])s=s?s+" "+n:n;else if(s.length)for(var a=n.length,o=0;(o=s.indexOf(n,o))>=0;){var c=o+a;(o===0||Ac.includes(s[o-1]))&&(c===s.length||Ac.includes(s[c]))?s=(o===0?"":s.substring(0,o))+s.substring(c+1):o=c}}return s===""?null:s}function _c(t,e=!1){var r=e?" !important;":";",s="";for(var n in t){var a=t[n];a!=null&&a!==""&&(s+=" "+n+": "+a+r)}return s}function Hi(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Nh(t,e){if(e){var r="",s,n;if(Array.isArray(e)?(s=e[0],n=e[1]):s=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,o=0,c=!1,l=[];s&&l.push(...Object.keys(s).map(Hi)),n&&l.push(...Object.keys(n).map(Hi));var u=0,d=-1;const _=t.length;for(var h=0;h<_;h++){var p=t[h];if(c?p==="/"&&t[h-1]==="*"&&(c=!1):a?a===p&&(a=!1):p==="/"&&t[h+1]==="*"?c=!0:p==='"'||p==="'"?a=p:p==="("?o++:p===")"&&o--,!c&&a===!1&&o===0){if(p===":"&&d===-1)d=h;else if(p===";"||h===_-1){if(d!==-1){var g=Hi(t.substring(u,d).trim());if(!l.includes(g)){p!==";"&&h++;var w=t.substring(u,h).trim();r+=" "+w+";"}}u=h+1,d=-1}}}}return s&&(r+=_c(s)),n&&(r+=_c(n,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Lh(t,e,r,s,n,a){var o=t.__className;if(C||o!==r||o===void 0){var c=Th(r,s,a);(!C||c!==t.getAttribute("class"))&&(c==null?t.removeAttribute("class"):e?t.className=c:t.setAttribute("class",c)),t.__className=r}else if(a&&n!==a)for(var l in a){var u=!!a[l];(n==null||u!==!!n[l])&&t.classList.toggle(l,u)}return a}function Vi(t,e={},r,s){for(var n in r){var a=r[n];e[n]!==a&&(r[n]==null?t.style.removeProperty(n):t.style.setProperty(n,a,s))}}function jh(t,e,r,s){var n=t.__style;if(C||n!==e){var a=Nh(e,s);(!C||a!==t.getAttribute("style"))&&(a==null?t.removeAttribute("style"):t.style.cssText=a),t.__style=e}else s&&(Array.isArray(s)?(Vi(t,r?.[0],s[0]),Vi(t,r?.[1],s[1],"important")):Vi(t,r,s));return s}function li(t,e,r=!1){if(t.multiple){if(e==null)return;if(!$i(e))return kf();for(var s of t.options)s.selected=e.includes(En(s));return}for(s of t.options){var n=En(s);if(Ql(n,e)){s.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Eu(t){var e=new MutationObserver(()=>{li(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Sa(()=>{e.disconnect()})}function vy(t,e,r=e){var s=new WeakSet,n=!0;ji(t,"change",a=>{var o=a?"[selected]":":checked",c;if(t.multiple)c=[].map.call(t.querySelectorAll(o),En);else{var l=t.querySelector(o)??t.querySelector("option:not([disabled])");c=l&&En(l)}r(c),ee!==null&&s.add(ee)}),Ia(()=>{var a=e();if(t===document.activeElement){var o=ni??ee;if(s.has(o))return}if(li(t,a,n),n&&a===void 0){var c=t.querySelector(":checked");c!==null&&(a=En(c),r(a))}t.__value=a,n=!1}),Eu(t)}function En(t){return"__value"in t?t.__value:t.value}const fn=Symbol("class"),hn=Symbol("style"),Su=Symbol("is custom element"),Iu=Symbol("is html");function qh(t){if(C){var e=!1,r=()=>{if(!e){if(e=!0,t.hasAttribute("value")){var s=t.value;ui(t,"value",null),t.value=s}if(t.hasAttribute("checked")){var n=t.checked;ui(t,"checked",null),t.checked=n}}};t.__on_r=r,Xe(r),zl()}}function by(t,e){var r=qi(t);r.value===(r.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function Ey(t,e){var r=qi(t);r.checked!==(r.checked=e??void 0)&&(t.checked=e)}function Oh(t,e){e?t.hasAttribute("selected")||t.setAttribute("selected",""):t.removeAttribute("selected")}function ui(t,e,r,s){var n=qi(t);C&&(n[e]=t.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&t.nodeName==="LINK")||n[e]!==(n[e]=r)&&(e==="loading"&&(t[ef]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Au(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Uh(t,e,r,s,n=!1,a=!1){if(C&&n&&t.tagName==="INPUT"){var o=t,c=o.type==="checkbox"?"defaultChecked":"defaultValue";c in r||qh(o)}var l=qi(t),u=l[Su],d=!l[Iu];let h=C&&u;h&&_t(!1);var p=e||{},g=t.tagName==="OPTION";for(var w in e)w in r||(r[w]=null);r.class?r.class=Ch(r.class):r[fn]&&(r.class=null),r[hn]&&(r.style??(r.style=null));var _=Au(t);for(const N in r){let O=r[N];if(g&&N==="value"&&O==null){t.value=t.__value="",p[N]=O;continue}if(N==="class"){var E=t.namespaceURI==="http://www.w3.org/1999/xhtml";Lh(t,E,O,s,e?.[fn],r[fn]),p[N]=O,p[fn]=r[fn];continue}if(N==="style"){jh(t,O,e?.[hn],r[hn]),p[N]=O,p[hn]=r[hn];continue}var A=p[N];if(!(O===A&&!(O===void 0&&t.hasAttribute(N)))){p[N]=O;var M=N[0]+N[1];if(M!=="$$")if(M==="on"){const F={},se="$$"+N;let V=N.slice(2);var H=uh(V);if(ch(V)&&(V=V.slice(0,-7),F.capture=!0),!H&&A){if(O!=null)continue;t.removeEventListener(V,p[se],F),p[se]=null}if(O!=null)if(H)t[`__${V}`]=O,yh([V]);else{let cn=function(ln){p[N].call(this,ln)};p[se]=No(V,t,cn,F)}else H&&(t[`__${V}`]=void 0)}else if(N==="style")ui(t,N,O);else if(N==="autofocus")Zf(t,!!O);else if(!u&&(N==="__value"||N==="value"&&O!=null))t.value=t.__value=O;else if(N==="selected"&&g)Oh(t,O);else{var B=N;d||(B=fh(B));var Q=B==="defaultValue"||B==="defaultChecked";if(O==null&&!u&&!Q)if(l[N]=null,B==="value"||B==="checked"){let F=t;const se=e===void 0;if(B==="value"){let V=F.defaultValue;F.removeAttribute(B),F.defaultValue=V,F.value=F.__value=se?V:null}else{let V=F.defaultChecked;F.removeAttribute(B),F.defaultChecked=V,F.checked=se?V:!1}}else t.removeAttribute(N);else Q||_.includes(B)&&(u||typeof O!="string")?(t[B]=O,B in l&&(l[B]=Pe)):typeof O!="function"&&ui(t,B,O)}}}return h&&_t(!0),p}function Sy(t,e,r=[],s=[],n=[],a,o=!1,c=!1){xl(n,r,s,l=>{var u=void 0,d={},h=t.nodeName==="SELECT",p=!1;if(ru(()=>{var w=e(...l.map(f)),_=Uh(t,u,w,a,o,c);p&&h&&"value"in w&&li(t,w.value);for(let A of Object.getOwnPropertySymbols(d))w[A]||ke(d[A]);for(let A of Object.getOwnPropertySymbols(w)){var E=w[A];A.description===$f&&(!u||E!==u[A])&&(d[A]&&ke(d[A]),d[A]=Je(()=>$h(t,()=>E))),_[A]=E}u=_}),h){var g=t;Ia(()=>{li(g,u.value,!0),Eu(g)})}p=!0})}function qi(t){return t.__attributes??(t.__attributes={[Su]:t.nodeName.includes("-"),[Iu]:t.namespaceURI===Df})}var Rc=new Map;function Au(t){var e=t.getAttribute("is")||t.nodeName,r=Rc.get(e);if(r)return r;Rc.set(e,r=[]);for(var s,n=t,a=Element.prototype;a!==n;){s=vl(n);for(var o in s)s[o].set&&r.push(o);n=Ci(n)}return r}let Wi=null;function Bh(){if(Wi===null){var t=document.createElement("select");t.innerHTML="<option><span>t</span></option>",Wi=t.firstChild?.firstChild?.nodeType===1}return Wi}function Iy(t,e){var r=C;Bh()||(_t(!1),t.textContent="",t.append(Xf("")));try{e()}finally{r&&(C?Tf(t):(_t(!0),$e(t)))}}function Ay(t,e,r=e){var s=new WeakSet;ji(t,"input",async n=>{var a=n?t.defaultValue:t.value;if(a=Qi(t)?Ji(a):a,r(a),ee!==null&&s.add(ee),await ih(),a!==(a=e())){var o=t.selectionStart,c=t.selectionEnd,l=t.value.length;if(t.value=a??"",c!==null){var u=t.value.length;o===c&&c===l&&u>l?(t.selectionStart=u,t.selectionEnd=u):(t.selectionStart=o,t.selectionEnd=Math.min(c,u))}}}),(C&&t.defaultValue!==t.value||gr(e)==null&&t.value)&&(r(Qi(t)?Ji(t.value):t.value),ee!==null&&s.add(ee)),Aa(()=>{var n=e();if(t===document.activeElement){var a=ni??ee;if(s.has(a))return}Qi(t)&&n===Ji(t.value)||t.type==="date"&&!n&&!t.value||n!==t.value&&(t.value=n??"")})}const Gi=new Set;function _y(t,e,r,s,n=s){var a=r.getAttribute("type")==="checkbox",o=t;let c=!1;if(e!==null)for(var l of e)o=o[l]??(o[l]=[]);o.push(r),ji(r,"change",()=>{var u=r.__value;a&&(u=Pc(o,u,r.checked)),n(u)},()=>n(a?[]:null)),Aa(()=>{var u=s();if(C&&r.defaultChecked!==r.checked){c=!0;return}a?(u=u||[],r.checked=u.includes(r.__value)):r.checked=Ql(r.__value,u)}),Sa(()=>{var u=o.indexOf(r);u!==-1&&o.splice(u,1)}),Gi.has(o)||(Gi.add(o),Xe(()=>{o.sort((u,d)=>u.compareDocumentPosition(d)===4?-1:1),Gi.delete(o)})),Xe(()=>{if(c){var u;if(a)u=Pc(o,u,r.checked);else{var d=o.find(h=>h.checked);u=d?.__value}n(u)}})}function Ry(t,e,r=e){ji(t,"change",s=>{var n=s?t.defaultChecked:t.checked;r(n)}),(C&&t.defaultChecked!==t.checked||gr(e)==null)&&r(t.checked),Aa(()=>{var s=e();t.checked=!!s})}function Pc(t,e,r){for(var s=new Set,n=0;n<t.length;n+=1)t[n].checked&&s.add(t[n].__value);return r||s.delete(e),Array.from(s)}function Qi(t){var e=t.type;return e==="number"||e==="range"}function Ji(t){return t===""?null:+t}function Dc(t,e){return t===e||t?.[xt]===e}function Py(t={},e,r,s){return Ia(()=>{var n,a;return Aa(()=>{n=a,a=s?.()||[],gr(()=>{t!==r(...a)&&(e(t,...a),n&&Dc(r(...n),t)&&e(null,...n))})}),()=>{Xe(()=>{a&&Dc(r(...a),t)&&e(null,...a)})}}),t}function Dy(t=!1){const e=ye,r=e.l.u;if(!r)return;let s=()=>oh(e.s);if(t){let n=0,a={};const o=Ea(()=>{let c=!1;const l=e.s;for(const u in l)l[u]!==a[u]&&(a[u]=l[u],c=!0);return c&&n++,n});s=()=>f(o)}r.b.length&&Ff(()=>{Mc(e,s),Fi(r.b)}),Vr(()=>{const n=gr(()=>r.m.map(Fd));return()=>{for(const a of n)typeof a=="function"&&a()}}),r.a.length&&Vr(()=>{Mc(e,s),Fi(r.a)})}function Mc(t,e){if(t.l.s)for(const r of t.l.s)f(r);e()}let La=!1;function xh(t){var e=La;try{return La=!1,[t(),La]}finally{La=e}}const Hh={get(t,e){if(!t.exclude.includes(e))return t.props[e]},set(t,e){return!1},getOwnPropertyDescriptor(t,e){if(!t.exclude.includes(e)&&e in t.props)return{enumerable:!0,configurable:!0,value:t.props[e]}},has(t,e){return t.exclude.includes(e)?!1:e in t.props},ownKeys(t){return Reflect.ownKeys(t.props).filter(e=>!t.exclude.includes(e))}};function My(t,e,r){return new Proxy({props:t,exclude:e},Hh)}const Vh={get(t,e){let r=t.props.length;for(;r--;){let s=t.props[r];if(_s(s)&&(s=s()),typeof s=="object"&&s!==null&&e in s)return s[e]}},set(t,e,r){let s=t.props.length;for(;s--;){let n=t.props[s];_s(n)&&(n=n());const a=Ur(n,e);if(a&&a.set)return a.set(r),!0}return!1},getOwnPropertyDescriptor(t,e){let r=t.props.length;for(;r--;){let s=t.props[r];if(_s(s)&&(s=s()),typeof s=="object"&&s!==null&&e in s){const n=Ur(s,e);return n&&!n.configurable&&(n.configurable=!0),n}}},has(t,e){if(e===xt||e===Al)return!1;for(let r of t.props)if(_s(r)&&(r=r()),r!=null&&e in r)return!0;return!1},ownKeys(t){const e=[];for(let r of t.props)if(_s(r)&&(r=r()),!!r){for(const s in r)e.includes(s)||e.push(s);for(const s of Object.getOwnPropertySymbols(r))e.includes(s)||e.push(s)}return e}};function $y(...t){return new Proxy({props:t},Vh)}function ky(t,e,r,s){var n=!rn||(r&wf)!==0,a=(r&bf)!==0,o=(r&Ef)!==0,c=s,l=!0,u=()=>(l&&(l=!1,c=o?gr(s):s),c),d;if(a){var h=xt in t||Al in t;d=Ur(t,e)?.set??(h&&e in t?H=>t[e]=H:void 0)}var p,g=!1;a?[p,g]=xh(()=>t[e]):p=t[e],p===void 0&&s!==void 0&&(p=u(),d&&(n&&cf(),d(p)));var w;if(n?w=()=>{var H=t[e];return H===void 0?u():(l=!0,H)}:w=()=>{var H=t[e];return H!==void 0&&(c=void 0),H===void 0?c:H},n&&(r&vf)===0)return w;if(d){var _=t.$$legacy;return(function(H,B){return arguments.length>0?((!n||!B||_||g)&&d(B?w():H),H):w()})}var E=!1,A=((r&yf)!==0?Ea:$o)(()=>(E=!1,w()));a&&f(A);var M=Y;return(function(H,B){if(arguments.length>0){const Q=B?f(A):n&&a?ge(H):H;return m(A,Q),E=!0,c!==void 0&&(c=Q),H}return Wr&&E||(M.f&dr)!==0?A.v:f(A)})}function Wh(t){ye===null&&_l(),rn&&ye.l!==null?Gh(ye).m.push(t):Vr(()=>{const e=gr(t);if(typeof e=="function")return e})}function Cy(t){ye===null&&_l(),Wh(()=>()=>gr(t))}function Gh(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const Qh="5";var wl;typeof window<"u"&&((wl=window.__svelte??(window.__svelte={})).v??(wl.v=new Set)).add(Qh);const Jh="modulepreload",Kh=function(t){return"/app/"+t},$c={},W=function(e,r,s){let n=Promise.resolve();if(r&&r.length>0){let l=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");n=l(r.map(u=>{if(u=Kh(u),u in $c)return;$c[u]=!0;const d=u.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":Jh,d||(p.as="script"),p.crossOrigin="",p.href=u,c&&p.setAttribute("nonce",c),document.head.appendChild(p),d)return new Promise((g,w)=>{p.addEventListener("load",g),p.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return n.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};var Yh=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],Xh=["difference","intersection","symmetricDifference","union"],kc=!1,qs,Et,Er,wi,en,_u,Ru;const vi=class vi extends Set{constructor(r){super();y(this,en);y(this,qs,new Map);y(this,Et,P(0));y(this,Er,P(0));y(this,wi,Rt||-1);if(r){for(var s of r)super.add(s);i(this,Er).v=super.size}kc||b(this,en,Ru).call(this)}has(r){var s=super.has(r),n=i(this,qs),a=n.get(r);if(a===void 0){if(!s)return f(i(this,Et)),!1;a=b(this,en,_u).call(this,!0),n.set(r,a)}return f(a),s}add(r){return super.has(r)||(super.add(r),m(i(this,Er),super.size),De(i(this,Et))),this}delete(r){var s=super.delete(r),n=i(this,qs),a=n.get(r);return a!==void 0&&(n.delete(r),m(a,!1)),s&&(m(i(this,Er),super.size),De(i(this,Et))),s}clear(){if(super.size!==0){super.clear();var r=i(this,qs);for(var s of r.values())m(s,!1);r.clear(),m(i(this,Er),0),De(i(this,Et))}}keys(){return this.values()}values(){return f(i(this,Et)),super.values()}entries(){return f(i(this,Et)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return f(i(this,Er))}};qs=new WeakMap,Et=new WeakMap,Er=new WeakMap,wi=new WeakMap,en=new WeakSet,_u=function(r){return Rt===i(this,wi)?P(r):pr(r)},Ru=function(){kc=!0;var r=vi.prototype,s=Set.prototype;for(const n of Yh)r[n]=function(...a){return f(i(this,Et)),s[n].apply(this,a)};for(const n of Xh)r[n]=function(...a){f(i(this,Et));var o=s[n].apply(this,a);return new vi(o)}};let Cc=vi;var Tt,Nt,rr,bi,At,yn,Ga;const Ko=class Ko extends Map{constructor(r){super();y(this,At);y(this,Tt,new Map);y(this,Nt,P(0));y(this,rr,P(0));y(this,bi,Rt||-1);if(r){for(var[s,n]of r)super.set(s,n);i(this,rr).v=super.size}}has(r){var s=i(this,Tt),n=s.get(r);if(n===void 0){var a=super.get(r);if(a!==void 0)n=b(this,At,yn).call(this,0),s.set(r,n);else return f(i(this,Nt)),!1}return f(n),!0}forEach(r,s){b(this,At,Ga).call(this),super.forEach(r,s)}get(r){var s=i(this,Tt),n=s.get(r);if(n===void 0){var a=super.get(r);if(a!==void 0)n=b(this,At,yn).call(this,0),s.set(r,n);else{f(i(this,Nt));return}}return f(n),super.get(r)}set(r,s){var n=i(this,Tt),a=n.get(r),o=super.get(r),c=super.set(r,s),l=i(this,Nt);if(a===void 0)a=b(this,At,yn).call(this,0),n.set(r,a),m(i(this,rr),super.size),De(l);else if(o!==s){De(a);var u=l.reactions===null?null:new Set(l.reactions),d=u===null||!a.reactions?.every(h=>u.has(h));d&&De(l)}return c}delete(r){var s=i(this,Tt),n=s.get(r),a=super.delete(r);return n!==void 0&&(s.delete(r),m(i(this,rr),super.size),m(n,-1),De(i(this,Nt))),a}clear(){if(super.size!==0){super.clear();var r=i(this,Tt);m(i(this,rr),0);for(var s of r.values())m(s,-1);De(i(this,Nt)),r.clear()}}keys(){return f(i(this,Nt)),super.keys()}values(){return b(this,At,Ga).call(this),super.values()}entries(){return b(this,At,Ga).call(this),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return f(i(this,rr)),super.size}};Tt=new WeakMap,Nt=new WeakMap,rr=new WeakMap,bi=new WeakMap,At=new WeakSet,yn=function(r){return Rt===i(this,bi)?P(r):pr(r)},Ga=function(){f(i(this,Nt));var r=i(this,Tt);if(i(this,rr).v!==r.size){for(var s of cc(Ko.prototype,this,"keys").call(this))if(!r.has(s)){var n=b(this,At,yn).call(this,0);r.set(s,n)}}for([,n]of i(this,Tt))f(n)};let gt=Ko;const Zh=Symbol();var Ne,kn,sr,is,wn;class zh extends URLSearchParams{constructor(){super(...arguments);y(this,is);y(this,Ne,P(0));y(this,kn,ep());y(this,sr,!1)}[Zh](r){if(!i(this,sr)){I(this,sr,!0);for(const s of[...super.keys()])super.delete(s);for(const[s,n]of r)super.append(s,n);De(i(this,Ne)),I(this,sr,!1)}}append(r,s){super.append(r,s),b(this,is,wn).call(this),De(i(this,Ne))}delete(r,s){var n=super.has(r,s);super.delete(r,s),n&&(b(this,is,wn).call(this),De(i(this,Ne)))}get(r){return f(i(this,Ne)),super.get(r)}getAll(r){return f(i(this,Ne)),super.getAll(r)}has(r,s){return f(i(this,Ne)),super.has(r,s)}keys(){return f(i(this,Ne)),super.keys()}set(r,s){var n=super.getAll(r).join("");super.set(r,s),n!==super.getAll(r).join("")&&(b(this,is,wn).call(this),De(i(this,Ne)))}sort(){super.sort(),b(this,is,wn).call(this),De(i(this,Ne))}toString(){return f(i(this,Ne)),super.toString()}values(){return f(i(this,Ne)),super.values()}entries(){return f(i(this,Ne)),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return f(i(this,Ne)),super.size}}Ne=new WeakMap,kn=new WeakMap,sr=new WeakMap,is=new WeakSet,wn=function(){if(!i(this,kn)||i(this,sr))return;I(this,sr,!0);const r=this.toString();i(this,kn).search=r&&`?${r}`,I(this,sr,!1)};let Fh=null;function ep(){return Fh}var Cn,Tn;class Pu{constructor(e,r){y(this,Cn);y(this,Tn);I(this,Cn,e),I(this,Tn,Mo(r))}get current(){return i(this,Tn).call(this),i(this,Cn).call(this)}}Cn=new WeakMap,Tn=new WeakMap;const tp=/\(.+\)/,rp=new Set(["all","print","screen","and","or","not","only"]);class Tc extends Pu{constructor(e,r){let s=tp.test(e)||e.split(/[\s,]+/).some(a=>rp.has(a.trim()))?e:`(${e})`;const n=window.matchMedia(s);super(()=>n.matches,a=>Fs(n,"change",a))}}const Du=typeof window<"u"?window:void 0;function sp(t){let e=t.activeElement;for(;e?.shadowRoot;){const r=e.shadowRoot.activeElement;if(r===e)break;e=r}return e}var Os,Nn;class np{constructor(e={}){y(this,Os);y(this,Nn);const{window:r=Du,document:s=r?.document}=e;r!==void 0&&(I(this,Os,s),I(this,Nn,Mo(n=>{const a=Fs(r,"focusin",n),o=Fs(r,"focusout",n);return()=>{a(),o()}})))}get current(){var e;return(e=i(this,Nn))==null||e.call(this),i(this,Os)?sp(i(this,Os)):null}}Os=new WeakMap,Nn=new WeakMap;new np;function Mu(t){return typeof t=="function"}function $u(t,e){if(Mu(t)){const s=t();return s===void 0?e:s}return t===void 0?e:t}function ap(t,e){let r=P(null);const s=z(()=>$u(e,250));function n(...a){if(f(r))f(r).timeout&&clearTimeout(f(r).timeout);else{let o,c;const l=new Promise((u,d)=>{o=u,c=d});m(r,{timeout:null,runner:null,promise:l,resolve:o,reject:c},!0)}return f(r).runner=async()=>{if(!f(r))return;const o=f(r);m(r,null);try{o.resolve(await t.apply(this,a))}catch(c){o.reject(c)}},f(r).timeout=setTimeout(f(r).runner,f(s)),f(r).promise}return n.cancel=async()=>{(!f(r)||f(r).timeout===null)&&(await new Promise(a=>setTimeout(a,0)),!f(r)||f(r).timeout===null)||(clearTimeout(f(r).timeout),f(r).reject("Cancelled"),m(r,null))},n.runScheduledNow=async()=>{(!f(r)||!f(r).timeout)&&(await new Promise(a=>setTimeout(a,0)),!f(r)||!f(r).timeout)||(clearTimeout(f(r).timeout),f(r).timeout=null,await f(r).runner?.())},Object.defineProperty(n,"pending",{enumerable:!0,get(){return!!f(r)?.timeout}}),n}function ip(t){return Mu(t)?t():t}function Ty(t,e,r={}){const{root:s,rootMargin:n="0px",threshold:a=.1,immediate:o=!0,window:c=Du,once:l=!1}=r;let u=P(ge(o)),d;const h=z(()=>{const g=$u(t);return new Set(g?Array.isArray(g)?g:[g]:[])}),p=tu(()=>{Vr(()=>{if(!f(h).size||!f(u)||!c)return;const g=(w,_)=>{w.forEach(E=>{const A=Array.isArray(a)?a.some(H=>E.intersectionRatio>=H):E.intersectionRatio>=a,M=E.isIntersecting&&A;if(e([E],_),l&&M)return m(u,!1),()=>{_?.disconnect()}})};d=new c.IntersectionObserver(g,{rootMargin:n,root:ip(s),threshold:a});for(const w of f(h))d.observe(w);return()=>{d?.disconnect()}})});return Vr(()=>p),{get isActive(){return f(u)},stop:p,pause(){m(u,!1)},resume(){m(u,!0)}}}function ku(t,e){switch(e){case"kg":case"l.":return Math.round(t*100)/100;case"gr.":case"ml":return Math.round(t);default:return Math.round(t*10)/10}}function ft(t){return t?.length?t.map(e=>Fr(e.q,e.u)).join(" et "):"-"}function op(t,e){const r=typeof t=="number"?t:parseFloat(t);if(isNaN(r))return{value:0,unit:e};let s=e,n=r;return(e==="gr."||e==="ml")&&r>=1e3?(n=r/1e3,s=e==="gr."?"kg":"l."):(e==="kg"||e==="l.")&&r<1&&r>0&&(n=r*1e3,s=e==="kg"?"gr.":"ml"),{value:ku(n,s),unit:s}}function Fr(t,e){const{value:r,unit:s}=op(t,e);let n;return s==="kg"||s==="l."?n=r.toFixed(2).replace(/\.?0+$/,""):n=r.toString(),`${n} ${s}`}function Ny(t,e,r){if(e==="au goÃ»t")return{quantity:t,unit:e,formatted:`${t} ${e}`,formattedNumber:`${t}`};const s=t*r,{q:n,u:a}=cp(s,e),o=ku(n,a);let c=`${o}`;return(a==="kg"||a==="l.")&&(c=o.toFixed(2).replace(/\.?0+$/,"")),{quantity:o,unit:a,formatted:`${c} ${a}`,formattedNumber:c}}function cp(t,e){const r=e.toLowerCase().trim();return(r==="gr."||r==="ml")&&t>=1e3?{q:t/1e3,u:r==="gr."?"kg":"l."}:(r==="kg"||r==="l.")&&t<1&&t>0?{q:t*1e3,u:r==="kg"?"gr.":"ml"}:{q:t,u:e}}function fo(t){if(!t?.length)return[];const e=new Map;return t.forEach(({q:r,u:s})=>{if(typeof r=="number"&&!isNaN(r)){const n=e.get(s)||0;e.set(s,n+r)}}),Array.from(e.entries()).map(([r,s])=>({q:s,u:r}))}function lp(t,e){const r=new Map,s=new Map;t.forEach(({q:o,u:c})=>{r.set(c,(r.get(c)||0)+o)}),e.forEach(({q:o,u:c})=>{s.set(c,(s.get(c)||0)+o)});const n=[],a=new Set([...r.keys(),...s.keys()]);for(const o of a){const c=r.get(o)||0,l=s.get(o)||0,u=c-l;Math.abs(u)>.001&&n.push({q:u,u:o})}return n}function qr(t){if(!t?.trim())return null;try{return JSON.parse(t)}catch(e){return console.warn("[ProductsStore] Erreur parsing JSON:",e),null}}function jo(t){return t?.length?t.filter(e=>e.quantity!=null&&e.unit).map(e=>({q:typeof e.quantity=="number"?e.quantity:parseFloat(e.quantity),u:e.unit})).filter(e=>!isNaN(e.q)):[]}function qo(t){if(!t?.length)return[];const e=new Map;return t.forEach(r=>{if(!r.q||!r.u||typeof r.q!="number"||isNaN(r.q))return;const s=e.get(r.u)||0;e.set(r.u,s+r.q)}),Array.from(e.entries()).map(([r,s])=>({q:s,u:r}))}function Oi(t,e){if(!t?.length)return{numeric:[],display:"â Complet"};if(!e?.length){const c=t.map(l=>Fr(l.q,l.u)).join(" et ");return{numeric:t,display:c}}const r=new Map,s=new Map;t.forEach(c=>{const l=parseFloat(c.q);isNaN(l)||r.set(c.u,(r.get(c.u)||0)+l)}),e.forEach(c=>{s.set(c.u,(s.get(c.u)||0)+c.q)});const n=[],a=[];r.forEach((c,l)=>{const u=s.get(l)||0,d=c-u;d>0&&(n.push({q:d,u:l}),a.push(Fr(d,l)))});const o=a.length>0?a.join(" et "):"â Complet";return{numeric:n,display:o}}function up(t){return t?Object.values(t).some(e=>e.recipes?.some(r=>r.q!==void 0||r.u!==void 0)):!1}function Ly(t){if(!t)return[];const e=[];return Object.entries(t).forEach(([r,s])=>{s.recipes?.forEach(n=>{e.push({...n,date:r,dateTimeService:r})})}),e}function Nc(t){if(!t?.length)return"ÃquilibrÃ©";const e=t.filter(s=>s.q>0),r=t.filter(s=>s.q<0);if(e.length>0&&r.length>0){const s=e.map(a=>Fr(a.q,a.u)).join(" et "),n=r.map(a=>Fr(Math.abs(a.q),a.u)).join(" et ");return`${s} disponibles, ${n} manquant${r.length>1?"s":""}`}else return e.length>0?e.map(s=>"+"+Fr(s.q,s.u)).join(" et ")+" disponibles":r.length>0?r.map(s=>Fr(Math.abs(s.q),s.u)).join(" et ")+` manquant${r.length>1?"s":""}`:"ÃquilibrÃ©"}function dp(t,e){if(e.searchQuery.trim()){const s=e.searchQuery.toLowerCase();if(!t.productName.toLowerCase().includes(s))return!1}if(e.selectedStores.length>0&&(!t.storeInfo?.storeName||!e.selectedStores.includes(t.storeInfo.storeName))||e.selectedWho.length>0&&(!t.who||!t.who.some(s=>e.selectedWho.includes(s)))||e.selectedProductTypes.length>0&&(!t.productType||!e.selectedProductTypes.includes(t.productType)))return!1;const r=e.temperatureFilter;if(r&&r!=="all")switch(r){case"frais":if(!t.pF)return!1;break;case"not-frais":if(t.pF)return!1;break;case"surgele":if(!t.pS)return!1;break;case"not-surgele":if(t.pS)return!1;break}return!0}function Cu(t){return t.toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}function fp(t,e,r=.01){if(!t?.length&&!e?.length)return!0;if(!t?.length||!e?.length)return!1;const s=new Map(t.map(c=>[c.u,c.q])),n=new Map(e.map(c=>[c.u,c.q])),a=Array.from(s.keys()).sort(),o=Array.from(n.keys()).sort();if(a.length!==o.length||!a.every((c,l)=>c===o[l]))return!1;for(const[c,l]of s){const u=n.get(c);if(u===void 0)return!1;const d=Math.abs(l-u),h=Math.max(l,u),p=Math.max(h*r,1);if(d>p)return!1}return!0}function jy(t){const e=t.totalNeededOverrideParsed;if(!e)return{hasMismatch:!1,computedChanged:!1,platesChanged:!1,recipesChanged:!1};if(!(e.totalComputedWhenOverride!==void 0&&e.platesNbWhenOverride!==void 0&&e.recipesNbWhenOverride!==void 0))return{hasMismatch:!1,computedChanged:!1,platesChanged:!1,recipesChanged:!1};const s=e.totalComputedWhenOverride,n=t.totalNeededArray,a=e.platesNbWhenOverride,o=t.totalAssiettes,c=e.recipesNbWhenOverride,l=t.nbRecipes,u=!fp(s,n),d=a!==o,h=c!==l,p=u||d||h;return{hasMismatch:p,computedChanged:u,platesChanged:d,recipesChanged:h,details:p?{oldComputed:s,newComputed:n,oldPlates:a,newPlates:o,oldRecipes:c,newRecipes:l}:void 0}}function Lc(t){return{...t,products:t.products?.map(e=>typeof e=="string"?e:e.$id)||[],mainId:t.mainId}}class Oo{static normalize(e,r,s=""){const n=r.toLowerCase(),a=s.toLowerCase(),o=n.includes("caf"),c=n.includes("soupe"),l=n.includes("pinc"),u=n.includes("gousse"),d=n.includes("tÃªte"),h=n.includes("unit")||n==="piÃ¨ce"||n==="piece",p=a.includes("sucre"),g=a.includes("sel"),w=a.includes("farine"),_=a.includes("crÃ¨me Ã©paisse")||a.includes("creme epaisse"),E=a==="ail",A=a.includes("oignon"),M=a==="tomate",H=a==="poireau",B=a.includes("aubergine"),Q=a==="courgette",N=a==="Ã©chalote"||a==="echalote",O=a==="orange"&&!a.includes("jus"),F=a.includes("citron")&&!a.includes("jus"),se=a==="concombre",V=a==="levure chimique",cn=a==="carotte",ln=a==="betterave rouge",Yo=a.includes("semoule"),Xo=a.includes("poivre"),Zo=a.includes("cacao"),zo=a.includes("sucre glace"),Fo=a.includes("maizena")||a.includes("maÃ¯zena"),ec=a.includes("bicarbonate"),tc=a.includes("curcuma"),rc=a.includes("cumin"),sc=a.includes("curry"),nc=a.includes("muscade"),ac=a.includes("paprika"),ic=a.includes("miel");let Yt=e,Es=r,Dt=!1,Kr="",G="";if(o){Dt=!0;let L="cafe_default";G="ml",p?(L="cafe_sucre",G="gr."):g?(L="cafe_sel",G="gr."):w?(L="cafe_farine",G="gr."):Yo?(L="cafe_semoule",G="gr."):Xo?(L="cafe_poivre",G="gr."):Zo?(L="cafe_cacao",G="gr."):zo?(L="cafe_sucre_glace",G="gr."):Fo?(L="cafe_maizena",G="gr."):ec?(L="cafe_bicarbonate",G="gr."):tc?(L="cafe_curcuma",G="gr."):rc?(L="cafe_cumin",G="gr."):sc?(L="cafe_curry",G="gr."):nc?(L="cafe_muscade",G="gr."):ac?(L="cafe_paprika",G="gr."):ic?(L="cafe_miel",G="gr."):_&&(L="cafe_creme_epaisse",G="ml"),Yt=e*this.CONVERSION_RULES[L],Kr=`1 c. Ã  cafÃ© = ${this.CONVERSION_RULES[L]} ${G}`}else if(c){Dt=!0;let L="soupe_default";G="ml",p?(L="soupe_sucre",G="gr."):g?(L="soupe_sel",G="gr."):w?(L="soupe_farine",G="gr."):Yo?(L="soupe_semoule",G="gr."):Xo?(L="soupe_poivre",G="gr."):Zo?(L="soupe_cacao",G="gr."):zo?(L="soupe_sucre_glace",G="gr."):Fo?(L="soupe_maizena",G="gr."):_?(L="soupe_creme_epaisse",G="ml"):ec?(L="soupe_bicarbonate",G="gr."):tc?(L="soupe_curcuma",G="gr."):rc?(L="soupe_cumin",G="gr."):sc?(L="soupe_curry",G="gr."):nc?(L="soupe_muscade",G="gr."):ac?(L="soupe_paprika",G="gr."):ic&&(L="soupe_miel",G="gr."),Yt=e*this.CONVERSION_RULES[L],Kr=`1 c. Ã  soupe = ${this.CONVERSION_RULES[L]} ${G}`}else if(l)Dt=!0,G="gr.",Yt=e*this.CONVERSION_RULES.pincee,Kr="1 pincÃ©e = 0.4 gr.";else if(u&&E)Dt=!0,G="gr.",Yt=e*this.CONVERSION_RULES.gousse_ail,Kr="1 gousse = 6.5 gr.";else if(d&&E)Dt=!0,G="gr.",Yt=e*this.CONVERSION_RULES.tete_ail,Kr="1 tÃªte = 80 gr.";else if(h){Dt=!0,G="gr.";let L="";A?L="unite_oignon":E?L="unite_ail":M?L="unite_tomate":H?L="unite_poireau":B?L="unite_aubergine":Q?L="unite_courgette":N?L="unite_eshalote":O?L="unite_orange":F?L="unite_citron":se?L="unite_concombre":V?L="unite_levure_chimique":cn?L="unite_carotte":ln?L="unite_betterave_rouge":Dt=!1,Dt&&(Yt=e*this.CONVERSION_RULES[L],Kr=`1 unitÃ© = ${this.CONVERSION_RULES[L]} gr.`)}return Dt?Es=G:n==="kg"?(Yt=e*1e3,Es="gr."):n==="l."?(Yt=e*1e3,Es="ml"):n==="gr."?Es="gr.":n==="ml"&&(Es="ml"),{quantity:Yt,unit:Es,originalUnit:r,ruleUsed:Kr,hasConversion:Dt}}}T(Oo,"CONVERSION_RULES",{cafe_sucre:5,cafe_sel:5,cafe_farine:3,cafe_semoule:4,cafe_poivre:2.5,cafe_cacao:2.5,cafe_sucre_glace:3,cafe_maizena:3,cafe_bicarbonate:5,cafe_curcuma:2,cafe_cumin:2,cafe_curry:2,cafe_muscade:2,cafe_paprika:2,cafe_miel:10,cafe_creme_epaisse:5,cafe_default:5,soupe_sucre:15,soupe_sel:15,soupe_farine:10,soupe_semoule:12,soupe_poivre:8,soupe_cacao:8,soupe_sucre_glace:9,soupe_maizena:10,soupe_creme_epaisse:15,soupe_bicarbonate:15,soupe_curcuma:6,soupe_cumin:6,soupe_curry:6,soupe_muscade:7,soupe_paprika:6,soupe_miel:30,soupe_default:15,pincee:.4,gousse_ail:6.5,tete_ail:80,unite_oignon:120,unite_ail:6.5,unite_tomate:120,unite_poireau:150,unite_aubergine:250,unite_courgette:200,unite_eshalote:30,unite_orange:200,unite_citron:100,unite_concombre:200,unite_levure_chimique:11,unite_carotte:125,unite_betterave_rouge:250});const Tu=2;function hp(t){const r=new Date(t).getHours();return r>=11&&r<=13?"sun":r>=19&&r<=21?"moon":r>=7&&r<=9?"cloud":null}function pp(t){return{formattedDate:new Date(t).toLocaleDateString("fr-FR",{weekday:"short",day:"numeric"}),timeIcon:hp(t)}}function mp(t){const e={};for(const r of t)e[r]=pp(r);return e}function gp(t,e,r){const s=!t.productHugoUuid,n=t.byDate&&Object.keys(t.byDate).length>0,a=s&&(t.totalNeededArray&&t.totalNeededArray.length>0||t.totalNeededOverrideParsed);if(!n&&!a)return{requiredQuantities:[],requiredQuantitiesFormatted:"-",stockBalance:[],availableStockQuantities:[],missingStockQuantities:[],availableStockFormatted:"-",missingStockFormatted:"-",hasAvailableStock:!1,hasMissingStock:!1,totalRecipesInRange:0,totalPortionsInRange:0,datesInSelectedRange:[],recipesByDate:new Map};if(s&&!n){const Q=t.totalNeededOverrideParsed?[t.totalNeededOverrideParsed.totalOverride]:t.totalNeededArray||[],N=Q.length>0?ft(Q):"-",O=jc(t,e,r,Q),F=O.filter(V=>V.q>0),se=O.filter(V=>V.q<0);return{requiredQuantities:Q,requiredQuantitiesFormatted:N,stockBalance:O,availableStockQuantities:F,missingStockQuantities:se,availableStockFormatted:Nc(O),missingStockFormatted:ft(se.map(V=>({q:Math.abs(V.q),u:V.u}))),hasAvailableStock:F.length>0,hasMissingStock:se.length>0,totalRecipesInRange:0,totalPortionsInRange:0,datesInSelectedRange:[],recipesByDate:new Map}}const o=e,c=r,l=[],u=new Map,d=new Map;let h=0,p=0;for(const[Q,N]of Object.entries(t.byDate))Q>=o&&Q<=c&&(l.push(Q),h+=N.totalAssiettes||0,N.recipes?.length&&(u.set(Q,N.recipes),p+=N.recipes.length),N.totalConsolidated&&N.totalConsolidated.forEach(({q:O,u:F})=>{d.set(F,(d.get(F)||0)+O)}));const g=Array.from(d.entries()).map(([Q,N])=>({q:N,u:Q})),w=g.length>0?ft(g):"-",_=t.totalNeededOverrideParsed?[t.totalNeededOverrideParsed.totalOverride]:g,E=jc(t,e,r,_),A=E.filter(Q=>Q.q>0),M=new Date().toISOString().split("T")[0],B=r<M?[]:E.filter(Q=>Q.q<0);return{requiredQuantities:g,requiredQuantitiesFormatted:w,stockBalance:E,availableStockQuantities:A,missingStockQuantities:B,availableStockFormatted:Nc(E),missingStockFormatted:ft(B.map(Q=>({q:Math.abs(Q.q),u:Q.u}))),hasAvailableStock:A.length>0,hasMissingStock:B.length>0,totalRecipesInRange:p,totalPortionsInRange:h,datesInSelectedRange:l,recipesByDate:u}}function jc(t,e,r,s){let n=[],a="";t.stockParsed?.dateTime&&t.stockParsed.dateTime<=e&&(n=[{q:parseFloat(t.stockParsed.quantity),u:t.stockParsed.unit}],a=t.stockParsed.dateTime);const o=[];if(t.purchases)for(const u of t.purchases)yp(u,e,r,a)&&o.push({q:u.quantity,u:u.unit});const c=[...n,...o],l=fo(c);return lp(l,s)}function yp(t,e,r,s=""){if(t.status==="cancelled")return!1;const n=t.deliveryDate||t.$createdAt;if(!n)return!1;const a=new Date(r);return a.setHours(a.getHours()+Tu),!(a<new Date||n>a.toISOString()||s&&t.$createdAt<s)}class wp{constructor(){T(this,"dbName","recipes-cache");T(this,"db",null);T(this,"version",5);T(this,"RECIPES_INDEX_STORE","recipes-index");T(this,"RECIPES_DETAILS_STORE","recipes-details");T(this,"METADATA_STORE","metadata");T(this,"BUILD_TIMESTAMP_KEY","buildTimestamp");T(this,"LAST_APPWRITE_SYNC_KEY","lastAppwriteSync");T(this,"RECIPES_COUNT_KEY","recipesCount")}async open(){if(this.db)return;const e=()=>new Promise((o,c)=>{const l=indexedDB.open(this.dbName,this.version);l.onerror=()=>c(l.error),l.onsuccess=()=>o(l.result),l.onupgradeneeded=u=>{const d=u.target.result;d.objectStoreNames.contains(this.RECIPES_INDEX_STORE)||(d.createObjectStore(this.RECIPES_INDEX_STORE,{keyPath:"$id"}),console.log("[RecipesIDBCache] Object store 'recipes-index' crÃ©Ã©")),d.objectStoreNames.contains(this.RECIPES_DETAILS_STORE)||(d.createObjectStore(this.RECIPES_DETAILS_STORE,{keyPath:"$id"}),console.log("[RecipesIDBCache] Object store 'recipes-details' crÃ©Ã©")),d.objectStoreNames.contains(this.METADATA_STORE)||(d.createObjectStore(this.METADATA_STORE,{keyPath:"key"}),console.log("[RecipesIDBCache] Object store 'metadata' crÃ©Ã©"))}});let r=await e();const s=r.objectStoreNames.contains(this.RECIPES_INDEX_STORE),n=r.objectStoreNames.contains(this.RECIPES_DETAILS_STORE),a=r.objectStoreNames.contains(this.METADATA_STORE);(!s||!n||!a)&&(console.warn(`[RecipesIDBCache] Base corrompue dÃ©tectÃ©e (index=${s}, details=${n}, metadata=${a}), suppression et recrÃ©ation...`),r.close(),await new Promise((o,c)=>{const l=indexedDB.deleteDatabase(this.dbName);l.onsuccess=()=>o(),l.onerror=()=>c(l.error),l.onblocked=()=>{console.warn("[RecipesIDBCache] Suppression bloquÃ©e, rÃ©essai...")}}),r=await e()),this.db=r,console.log(`[RecipesIDBCache] Base ouverte: ${this.dbName}`)}async loadRecipesIndex(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,r)=>{const a=this.db.transaction(this.RECIPES_INDEX_STORE,"readonly").objectStore(this.RECIPES_INDEX_STORE).getAll();a.onsuccess=()=>{const o=new Map;a.result.forEach(c=>{o.set(c.$id,c)}),console.log(`[RecipesIDBCache] ${o.size} recettes (index) chargÃ©es`),e(o)},a.onerror=()=>r(a.error)})}async saveRecipesIndex(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction(this.RECIPES_INDEX_STORE,"readwrite"),a=n.objectStore(this.RECIPES_INDEX_STORE);a.clear(),e.forEach(o=>{a.put(o)}),n.oncomplete=()=>{console.log(`[RecipesIDBCache] ${e.size} recettes (index) sauvegardÃ©es`),r()},n.onerror=()=>s(n.error)})}async loadRecipeDetail(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.RECIPES_DETAILS_STORE,"readonly").objectStore(this.RECIPES_DETAILS_STORE).get(e);o.onsuccess=()=>{const c=o.result;c&&console.log(`[RecipesIDBCache] DÃ©tails de ${e} chargÃ©s depuis le cache`),r(c||null)},o.onerror=()=>s(o.error)})}async saveRecipeDetail(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.RECIPES_DETAILS_STORE,"readwrite").objectStore(this.RECIPES_DETAILS_STORE).put(e);o.onsuccess=()=>{console.log(`[RecipesIDBCache] DÃ©tails de ${e.$id} sauvegardÃ©s`),r()},o.onerror=()=>s(o.error)})}async loadAllRecipeDetails(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,r)=>{const a=this.db.transaction(this.RECIPES_DETAILS_STORE,"readonly").objectStore(this.RECIPES_DETAILS_STORE).getAll();a.onsuccess=()=>{const o=new Map;a.result.forEach(c=>{o.set(c.$id,c)}),console.log(`[RecipesIDBCache] ${o.size} dÃ©tails de recettes chargÃ©s`),e(o)},a.onerror=()=>r(a.error)})}async loadRecipeDetailsBulk(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const a=this.db.transaction(this.RECIPES_DETAILS_STORE,"readonly").objectStore(this.RECIPES_DETAILS_STORE),o=new Map;let c=0;const l=e.length;for(const u of e){const d=a.get(u);d.onsuccess=()=>{const h=d.result;h&&o.set(u,h),c++,c===l&&(console.log(`[RecipesIDBCache] ${o.size}/${l} recettes chargÃ©es en bulk`),r(o))},d.onerror=()=>{console.warn(`[RecipesIDBCache] Erreur chargement ${u} en bulk:`,d.error),c++,c===l&&(console.log(`[RecipesIDBCache] ${o.size}/${l} recettes chargÃ©es en bulk (avec erreurs)`),r(o))}}l===0&&(console.log("[RecipesIDBCache] 0 recettes Ã  charger en bulk"),r(o))})}async saveRecipeDetailsBulk(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction(this.RECIPES_DETAILS_STORE,"readwrite"),a=n.objectStore(this.RECIPES_DETAILS_STORE);let o=0;const c=e.size;e.forEach(l=>{const u=a.put(l);u.onsuccess=()=>{o++,o===c&&(console.log(`[RecipesIDBCache] ${c} recettes sauvegardÃ©es en bulk`),r())},u.onerror=()=>{console.error(`[RecipesIDBCache] Erreur sauvegarde ${l.$id} en bulk:`,u.error),s(u.error)}}),c===0&&(console.log("[RecipesIDBCache] 0 recettes Ã  sauvegarder en bulk"),r()),n.onerror=()=>s(n.error)})}async deleteRecipeDetail(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.RECIPES_DETAILS_STORE,"readwrite").objectStore(this.RECIPES_DETAILS_STORE).delete(e);o.onsuccess=()=>r(),o.onerror=()=>s(o.error)})}async deleteRecipeFromIndex(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction([this.RECIPES_INDEX_STORE,this.RECIPES_DETAILS_STORE],"readwrite"),a=n.objectStore(this.RECIPES_INDEX_STORE),o=n.objectStore(this.RECIPES_DETAILS_STORE);a.delete(e),o.delete(e),n.oncomplete=()=>{console.log(`[RecipesIDBCache] Recette ${e} supprimÃ©e de l'index et des dÃ©tails`),r()},n.onerror=()=>s(n.error)})}async loadMetadata(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,r)=>{const a=this.db.transaction(this.METADATA_STORE,"readonly").objectStore(this.METADATA_STORE).getAll();a.onsuccess=()=>{const o=a.result,c={buildTimestamp:null,lastAppwriteSync:null,recipesCount:0,cacheVersion:1};o.forEach(l=>{l.key===this.RECIPES_COUNT_KEY?c.recipesCount=l.value:l.key===this.BUILD_TIMESTAMP_KEY?c.buildTimestamp=l.value:l.key===this.LAST_APPWRITE_SYNC_KEY&&(c.lastAppwriteSync=l.value)}),console.log(`[RecipesIDBCache] Metadata chargÃ©es: count=${c.recipesCount}, build=${c.buildTimestamp}, sync=${c.lastAppwriteSync}`),e(c)},a.onerror=()=>r(a.error)})}async saveMetadata(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction(this.METADATA_STORE,"readwrite"),a=n.objectStore(this.METADATA_STORE);a.put({key:this.BUILD_TIMESTAMP_KEY,value:e.buildTimestamp}),a.put({key:this.LAST_APPWRITE_SYNC_KEY,value:e.lastAppwriteSync}),a.put({key:this.RECIPES_COUNT_KEY,value:e.recipesCount}),n.oncomplete=()=>{console.log("[RecipesIDBCache] Metadata sauvegardÃ©es"),r()},n.onerror=()=>s(n.error)})}async clear(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,r)=>{const s=this.db.transaction([this.RECIPES_INDEX_STORE,this.RECIPES_DETAILS_STORE,this.METADATA_STORE],"readwrite");s.objectStore(this.RECIPES_INDEX_STORE).clear(),s.objectStore(this.RECIPES_DETAILS_STORE).clear(),s.objectStore(this.METADATA_STORE).clear(),s.oncomplete=()=>{console.log("[RecipesIDBCache] Cache vidÃ©"),e()},s.onerror=()=>r(s.error)})}close(){this.db&&(this.db.close(),this.db=null,console.log("[RecipesIDBCache] Connexion fermÃ©e"))}}async function vp(){const t=new wp;return await t.open(),t}function qy(t){return t.map(e=>JSON.stringify(e))}function Qa(t){return!t||!Array.isArray(t)?[]:t.map(e=>{try{return JSON.parse(e)}catch(r){return console.warn("[ingredientUtils] Failed to parse ingredient:",e,r),null}}).filter(e=>e!==null)}const qc={"BouchÃ©es salÃ©es":"sandwich",Boisson:"cup-soda",Cake:"cake-slice","CrÃ¨mes dessert":"fast-food-pudding",Friture:"fryer",Gateau:"cake-slice",Pain:"bread","Plat au Four":"oven","Plat en Sauce":"pot",Salade:"lettuce",Sauce:"sauce",Snacking:"hamburger",Soupe:"soup","Tarte (salÃ©e)":"pizza","Tarte (sucrÃ©e)":"pie",Tartinade:"tartinade"},bp={entree:"salad",plat:"dish",dessert:"fast-food-pudding"};function Oy(t,e){const r=Array.isArray(e)?e[0]:e;if(r&&qc[r])return{label:r,iconId:qc[r]};const s=Ep(t),n=bp[t]||"no-cat";return{label:s,iconId:n}}function Ep(t){switch(t){case"entree":return"EntrÃ©e";case"plat":return"Plat";case"dessert":return"Dessert";default:return t}}function Ki(t){return!t||!Array.isArray(t)?[]:t.map(e=>{try{const r=JSON.parse(e);if(r&&typeof r.astuce=="string")return r;if(typeof e=="string")return{astuce:e}}catch(r){console.warn("[recipeUtils] Failed to parse astuce:",e,r)}return null}).filter(e=>e!==null)}function Uy(t){return!t||!Array.isArray(t)||t.length===0?null:t.map(e=>JSON.stringify(typeof e=="string"?{astuce:e}:e))}function Sp(t){if(!t||typeof t!="object"||Array.isArray(t))throw new Error(`Format d'ingrÃ©dient invalide: ${JSON.stringify(t)}`);return{uuid:t.uuid||"",name:t.name||"",originalQuantity:t.originalQuantity||0,originalUnit:t.originalUnit||"",normalizedQuantity:t.normalizedQuantity||0,normalizedUnit:t.normalizedUnit||"",comment:t.comment||"",allergens:Array.isArray(t.allergens)?t.allergens:[],type:t.type||"",pF:t.pF??!1,pS:t.pS??!1}}function Oc(t){if(!t||typeof t!="object")throw new Error("DonnÃ©es de recette invalides");const e=[];return Array.isArray(t.ingredients)&&t.ingredients.forEach(r=>{try{e.push(Sp(r))}catch(s){console.warn("[parseRecipeData] IngrÃ©dient invalide ignorÃ©:",s)}}),{...t,$id:t.$id||t.id||"",$createdAt:t.$createdAt||t.createdAt||"",$updatedAt:t.$updatedAt||t.updatedAt||"",ingredients:e}}function Ip(t){if(!t||typeof t!="object")throw new Error("DonnÃ©es d'index de recette invalides");const e=[];return Array.isArray(t.ingredients)&&t.ingredients.forEach(r=>{typeof r=="string"?e.push(r):r&&typeof r.name=="string"&&e.push(r.name)}),{title:t.title||"",typeR:t.typeR||"",categories:Array.isArray(t.categories)?t.categories:[],regime:t.regime||null,draft:t.draft??!1,materiel:Array.isArray(t.materiel)?t.materiel:[],region:t.region||"",serveHot:t.serveHot??!1,cuisson:t.cuisson??!1,check:t.check??!1,saison:Array.isArray(t.saison)?t.saison:[],permissionWrite:Array.isArray(t.permissionWrite)?t.permissionWrite:[],lockedBy:t.lockedBy||null,plate:t.plate??100,ingredients:e,auteur:t.auteur||"",createdBy:t.createdBy||"",$id:t.$id||t.id||"",$createdAt:t.$createdAt||t.createdAt||"",$updatedAt:t.$updatedAt||t.updatedAt||""}}function ja(t){let e=[];return t.ingredients&&(e=Qa(t.ingredients).map(s=>s.name)),{title:t.title,typeR:t.typeR,categories:t.categories,regime:t.regime,draft:t.draft||!1,saison:t.saison,ingredients:e,materiel:t.materiel,region:t.region||null,serveHot:t.serveHot,cuisson:t.cuisson,check:t.check,auteur:t.auteur||t.createdBy,permissionWrite:t.permissionWrite,lockedBy:t.lockedBy||null,$id:t.$id,$createdAt:t.$createdAt,$updatedAt:t.$updatedAt,createdBy:t.createdBy,plate:t.plate,rootRecipeId:t.rootRecipeId||null,versionLabel:t.versionLabel||null}}function Yi(t,e,r,s){function n(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function c(d){try{u(s.next(d))}catch(h){o(h)}}function l(d){try{u(s.throw(d))}catch(h){o(h)}}function u(d){d.done?a(d.value):n(d.value).then(c,l)}u((s=s.apply(t,[])).next())})}function Ap(t,e,r,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?s:r==="a"?s.call(t):s?s.value:e.get(t)}class S{constructor(e,r,s){this.method=e,this.attribute=r,s!==void 0&&(Array.isArray(s)?this.values=s:this.values=[s])}toString(){return JSON.stringify({method:this.method,attribute:this.attribute,values:this.values})}}S.equal=(t,e)=>new S("equal",t,e).toString();S.notEqual=(t,e)=>new S("notEqual",t,e).toString();S.lessThan=(t,e)=>new S("lessThan",t,e).toString();S.lessThanEqual=(t,e)=>new S("lessThanEqual",t,e).toString();S.greaterThan=(t,e)=>new S("greaterThan",t,e).toString();S.greaterThanEqual=(t,e)=>new S("greaterThanEqual",t,e).toString();S.isNull=t=>new S("isNull",t).toString();S.isNotNull=t=>new S("isNotNull",t).toString();S.between=(t,e,r)=>new S("between",t,[e,r]).toString();S.startsWith=(t,e)=>new S("startsWith",t,e).toString();S.endsWith=(t,e)=>new S("endsWith",t,e).toString();S.select=t=>new S("select",void 0,t).toString();S.search=(t,e)=>new S("search",t,e).toString();S.orderDesc=t=>new S("orderDesc",t).toString();S.orderAsc=t=>new S("orderAsc",t).toString();S.orderRandom=()=>new S("orderRandom").toString();S.cursorAfter=t=>new S("cursorAfter",void 0,t).toString();S.cursorBefore=t=>new S("cursorBefore",void 0,t).toString();S.limit=t=>new S("limit",void 0,t).toString();S.offset=t=>new S("offset",void 0,t).toString();S.contains=(t,e)=>new S("contains",t,e).toString();S.notContains=(t,e)=>new S("notContains",t,e).toString();S.notSearch=(t,e)=>new S("notSearch",t,e).toString();S.notBetween=(t,e,r)=>new S("notBetween",t,[e,r]).toString();S.notStartsWith=(t,e)=>new S("notStartsWith",t,e).toString();S.notEndsWith=(t,e)=>new S("notEndsWith",t,e).toString();S.createdBefore=t=>S.lessThan("$createdAt",t);S.createdAfter=t=>S.greaterThan("$createdAt",t);S.createdBetween=(t,e)=>S.between("$createdAt",t,e);S.updatedBefore=t=>S.lessThan("$updatedAt",t);S.updatedAfter=t=>S.greaterThan("$updatedAt",t);S.updatedBetween=(t,e)=>S.between("$updatedAt",t,e);S.or=t=>new S("or",void 0,t.map(e=>JSON.parse(e))).toString();S.and=t=>new S("and",void 0,t.map(e=>JSON.parse(e))).toString();S.distanceEqual=(t,e,r,s=!0)=>new S("distanceEqual",t,[[e,r,s]]).toString();S.distanceNotEqual=(t,e,r,s=!0)=>new S("distanceNotEqual",t,[[e,r,s]]).toString();S.distanceGreaterThan=(t,e,r,s=!0)=>new S("distanceGreaterThan",t,[[e,r,s]]).toString();S.distanceLessThan=(t,e,r,s=!0)=>new S("distanceLessThan",t,[[e,r,s]]).toString();S.intersects=(t,e)=>new S("intersects",t,[e]).toString();S.notIntersects=(t,e)=>new S("notIntersects",t,[e]).toString();S.crosses=(t,e)=>new S("crosses",t,[e]).toString();S.notCrosses=(t,e)=>new S("notCrosses",t,[e]).toString();S.overlaps=(t,e)=>new S("overlaps",t,[e]).toString();S.notOverlaps=(t,e)=>new S("notOverlaps",t,[e]).toString();S.touches=(t,e)=>new S("touches",t,[e]).toString();S.notTouches=(t,e)=>new S("notTouches",t,[e]).toString();class v extends Error{constructor(e,r=0,s="",n=""){super(e),this.name="AppwriteException",this.message=e,this.code=r,this.type=s,this.response=n}}class zt{constructor(){this.config={endpoint:"https://cloud.appwrite.io/v1",endpointRealtime:"",project:"",jwt:"",locale:"",session:"",devkey:""},this.headers={"x-sdk-name":"Web","x-sdk-platform":"client","x-sdk-language":"web","x-sdk-version":"21.5.0","X-Appwrite-Response-Format":"1.8.0"},this.realtime={socket:void 0,timeout:void 0,heartbeat:void 0,url:"",channels:new Set,subscriptions:new Map,subscriptionsCounter:0,reconnect:!0,reconnectAttempts:0,lastMessage:void 0,connect:()=>{clearTimeout(this.realtime.timeout),this.realtime.timeout=window?.setTimeout(()=>{this.realtime.createSocket()},50)},getTimeout:()=>{switch(!0){case this.realtime.reconnectAttempts<5:return 1e3;case this.realtime.reconnectAttempts<15:return 5e3;case this.realtime.reconnectAttempts<100:return 1e4;default:return 6e4}},createHeartbeat:()=>{this.realtime.heartbeat&&clearTimeout(this.realtime.heartbeat),this.realtime.heartbeat=window?.setInterval(()=>{var e;(e=this.realtime.socket)===null||e===void 0||e.send(JSON.stringify({type:"ping"}))},2e4)},createSocket:()=>{var e,r,s;if(this.realtime.channels.size<1){this.realtime.reconnect=!1,(e=this.realtime.socket)===null||e===void 0||e.close();return}const n=new URLSearchParams;this.config.project&&n.set("project",this.config.project),this.realtime.channels.forEach(o=>{n.append("channels[]",o)});const a=this.config.endpointRealtime+"/realtime?"+n.toString();(a!==this.realtime.url||!this.realtime.socket||((r=this.realtime.socket)===null||r===void 0?void 0:r.readyState)>WebSocket.OPEN)&&(this.realtime.socket&&((s=this.realtime.socket)===null||s===void 0?void 0:s.readyState)<WebSocket.CLOSING&&(this.realtime.reconnect=!1,this.realtime.socket.close()),this.realtime.url=a,this.realtime.socket=new WebSocket(a),this.realtime.socket.addEventListener("message",this.realtime.onMessage),this.realtime.socket.addEventListener("open",o=>{this.realtime.reconnectAttempts=0,this.realtime.createHeartbeat()}),this.realtime.socket.addEventListener("close",o=>{var c,l,u;if(!this.realtime.reconnect||((l=(c=this.realtime)===null||c===void 0?void 0:c.lastMessage)===null||l===void 0?void 0:l.type)==="error"&&((u=this.realtime)===null||u===void 0?void 0:u.lastMessage.data).code===1008){this.realtime.reconnect=!0;return}const d=this.realtime.getTimeout();console.error(`Realtime got disconnected. Reconnect will be attempted in ${d/1e3} seconds.`,o.reason),setTimeout(()=>{this.realtime.reconnectAttempts++,this.realtime.createSocket()},d)}))},onMessage:e=>{var r,s;try{const n=JSON.parse(e.data);switch(this.realtime.lastMessage=n,n.type){case"connected":let a=this.config.session;if(!a){const l=JSON.parse((r=window.localStorage.getItem("cookieFallback"))!==null&&r!==void 0?r:"{}");a=l?.[`a_session_${this.config.project}`]}const o=n.data;a&&!o.user&&((s=this.realtime.socket)===null||s===void 0||s.send(JSON.stringify({type:"authentication",data:{session:a}})));break;case"event":let c=n.data;if(c?.channels){if(!c.channels.some(u=>this.realtime.channels.has(u)))return;this.realtime.subscriptions.forEach(u=>{c.channels.some(d=>u.channels.includes(d))&&setTimeout(()=>u.callback(c))})}break;case"pong":break;case"error":throw n.data;default:break}}catch(n){console.error(n)}},cleanUp:e=>{this.realtime.channels.forEach(r=>{e.includes(r)&&(Array.from(this.realtime.subscriptions).some(([n,a])=>a.channels.includes(r))||this.realtime.channels.delete(r))})}}}setEndpoint(e){if(!e.startsWith("http://")&&!e.startsWith("https://"))throw new v("Invalid endpoint URL: "+e);return this.config.endpoint=e,this.config.endpointRealtime=e.replace("https://","wss://").replace("http://","ws://"),this}setEndpointRealtime(e){if(!e.startsWith("ws://")&&!e.startsWith("wss://"))throw new v("Invalid realtime endpoint URL: "+e);return this.config.endpointRealtime=e,this}setProject(e){return this.headers["X-Appwrite-Project"]=e,this.config.project=e,this}setJWT(e){return this.headers["X-Appwrite-JWT"]=e,this.config.jwt=e,this}setLocale(e){return this.headers["X-Appwrite-Locale"]=e,this.config.locale=e,this}setSession(e){return this.headers["X-Appwrite-Session"]=e,this.config.session=e,this}setDevKey(e){return this.headers["X-Appwrite-Dev-Key"]=e,this.config.devkey=e,this}subscribe(e,r){let s=typeof e=="string"?[e]:e;s.forEach(a=>this.realtime.channels.add(a));const n=this.realtime.subscriptionsCounter++;return this.realtime.subscriptions.set(n,{channels:s,callback:r}),this.realtime.connect(),()=>{this.realtime.subscriptions.delete(n),this.realtime.cleanUp(s),this.realtime.connect()}}prepareRequest(e,r,s={},n={}){if(e=e.toUpperCase(),s=Object.assign({},this.headers,s),typeof window<"u"&&window.localStorage){const o=window.localStorage.getItem("cookieFallback");o&&(s["X-Fallback-Cookies"]=o)}let a={method:e,headers:s};if(s["X-Appwrite-Dev-Key"]===void 0&&(a.credentials="include"),e==="GET")for(const[o,c]of Object.entries(zt.flatten(n)))r.searchParams.append(o,c);else switch(s["content-type"]){case"application/json":a.body=JSON.stringify(n);break;case"multipart/form-data":const o=new FormData;for(const[c,l]of Object.entries(n))if(l instanceof File)o.append(c,l,l.name);else if(Array.isArray(l))for(const u of l)o.append(`${c}[]`,u);else o.append(c,l);a.body=o,delete s["content-type"];break}return{uri:r.toString(),options:a}}chunkedUpload(e,r,s={},n={},a){var o;return Yi(this,void 0,void 0,function*(){const[c,l]=(o=Object.entries(n).find(([h,p])=>p instanceof File))!==null&&o!==void 0?o:[];if(!l||!c)throw new Error("File not found in payload");if(l.size<=zt.CHUNK_SIZE)return yield this.call(e,r,s,n);let u=0,d=null;for(;u<l.size;){let h=u+zt.CHUNK_SIZE;h>=l.size&&(h=l.size),s["content-range"]=`bytes ${u}-${h-1}/${l.size}`;const p=l.slice(u,h);let g=Object.assign({},n);g[c]=new File([p],l.name),d=yield this.call(e,r,s,g),a&&typeof a=="function"&&a({$id:d.$id,progress:Math.round(h/l.size*100),sizeUploaded:h,chunksTotal:Math.ceil(l.size/zt.CHUNK_SIZE),chunksUploaded:Math.ceil(h/zt.CHUNK_SIZE)}),d&&d.$id&&(s["x-appwrite-id"]=d.$id),u=h}return d})}ping(){return Yi(this,void 0,void 0,function*(){return this.call("GET",new URL(this.config.endpoint+"/ping"))})}call(e,r,s={},n={},a="json"){var o,c;return Yi(this,void 0,void 0,function*(){const{uri:l,options:u}=this.prepareRequest(e,r,s,n);let d=null;const h=yield fetch(l,u);if(h.type==="opaque")throw new v(`Invalid Origin. Register your new client (${window.location.host}) as a new Web platform on your project console dashboard`,403,"forbidden","");const p=h.headers.get("x-appwrite-warning");if(p&&p.split(";").forEach(w=>console.warn("Warning: "+w)),!((o=h.headers.get("content-type"))===null||o===void 0)&&o.includes("application/json")?d=yield h.json():a==="arrayBuffer"?d=yield h.arrayBuffer():d={message:yield h.text()},400<=h.status){let w="";throw!((c=h.headers.get("content-type"))===null||c===void 0)&&c.includes("application/json")||a==="arrayBuffer"?w=JSON.stringify(d):w=d?.message,new v(d?.message,h.status,d?.type,w)}const g=h.headers.get("X-Fallback-Cookies");return typeof window<"u"&&window.localStorage&&g&&(window.console.warn("Appwrite is using localStorage for session management. Increase your security by adding a custom domain as your API endpoint."),window.localStorage.setItem("cookieFallback",g)),d})}static flatten(e,r=""){let s={};for(const[n,a]of Object.entries(e)){let o=r?r+"["+n+"]":n;Array.isArray(a)?s=Object.assign(Object.assign({},s),zt.flatten(a,o)):s[o]=a}return s}}zt.CHUNK_SIZE=1024*1024*5;class An{constructor(e){this.client=e}static flatten(e,r=""){let s={};for(const[n,a]of Object.entries(e)){let o=r?r+"["+n+"]":n;Array.isArray(a)?s=Object.assign(Object.assign({},s),An.flatten(a,o)):s[o]=a}return s}}An.CHUNK_SIZE=5*1024*1024;class _p{constructor(e){this.client=e}get(){const e="/account",r={},s=new URL(this.client.config.endpoint+e),n={};return this.client.call("get",s,n,r)}create(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={userId:e,email:r[0],password:r[1],name:r[2]};const n=s.userId,a=s.email,o=s.password,c=s.name;if(typeof n>"u")throw new v('Missing required parameter: "userId"');if(typeof a>"u")throw new v('Missing required parameter: "email"');if(typeof o>"u")throw new v('Missing required parameter: "password"');const l="/account",u={};typeof n<"u"&&(u.userId=n),typeof a<"u"&&(u.email=a),typeof o<"u"&&(u.password=o),typeof c<"u"&&(u.name=c);const d=new URL(this.client.config.endpoint+l),h={"content-type":"application/json"};return this.client.call("post",d,h,u)}updateEmail(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={email:e,password:r[0]};const n=s.email,a=s.password;if(typeof n>"u")throw new v('Missing required parameter: "email"');if(typeof a>"u")throw new v('Missing required parameter: "password"');const o="/account/email",c={};typeof n<"u"&&(c.email=n),typeof a<"u"&&(c.password=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("patch",l,u,c)}listIdentities(e,...r){let s;!e||e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={queries:e,total:r[0]};const n=s.queries,a=s.total,o="/account/identities",c={};typeof n<"u"&&(c.queries=n),typeof a<"u"&&(c.total=a);const l=new URL(this.client.config.endpoint+o),u={};return this.client.call("get",l,u,c)}deleteIdentity(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={identityId:e};const s=r.identityId;if(typeof s>"u")throw new v('Missing required parameter: "identityId"');const n="/account/identities/{identityId}".replace("{identityId}",s),a={},o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("delete",o,c,a)}createJWT(){const e="/account/jwts",r={},s=new URL(this.client.config.endpoint+e),n={"content-type":"application/json"};return this.client.call("post",s,n,r)}listLogs(e,...r){let s;!e||e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={queries:e,total:r[0]};const n=s.queries,a=s.total,o="/account/logs",c={};typeof n<"u"&&(c.queries=n),typeof a<"u"&&(c.total=a);const l=new URL(this.client.config.endpoint+o),u={};return this.client.call("get",l,u,c)}updateMFA(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={mfa:e};const s=r.mfa;if(typeof s>"u")throw new v('Missing required parameter: "mfa"');const n="/account/mfa",a={};typeof s<"u"&&(a.mfa=s);const o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("patch",o,c,a)}createMfaAuthenticator(e){let r;e&&typeof e=="object"&&!Array.isArray(e)&&"type"in e?r=e||{}:r={type:e};const s=r.type;if(typeof s>"u")throw new v('Missing required parameter: "type"');const n="/account/mfa/authenticators/{type}".replace("{type}",s),a={},o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("post",o,c,a)}createMFAAuthenticator(e){let r;e&&typeof e=="object"&&!Array.isArray(e)&&"type"in e?r=e||{}:r={type:e};const s=r.type;if(typeof s>"u")throw new v('Missing required parameter: "type"');const n="/account/mfa/authenticators/{type}".replace("{type}",s),a={},o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("post",o,c,a)}updateMfaAuthenticator(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)&&"type"in e?s=e||{}:s={type:e,otp:r[0]};const n=s.type,a=s.otp;if(typeof n>"u")throw new v('Missing required parameter: "type"');if(typeof a>"u")throw new v('Missing required parameter: "otp"');const o="/account/mfa/authenticators/{type}".replace("{type}",n),c={};typeof a<"u"&&(c.otp=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("put",l,u,c)}updateMFAAuthenticator(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)&&"type"in e?s=e||{}:s={type:e,otp:r[0]};const n=s.type,a=s.otp;if(typeof n>"u")throw new v('Missing required parameter: "type"');if(typeof a>"u")throw new v('Missing required parameter: "otp"');const o="/account/mfa/authenticators/{type}".replace("{type}",n),c={};typeof a<"u"&&(c.otp=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("put",l,u,c)}deleteMfaAuthenticator(e){let r;e&&typeof e=="object"&&!Array.isArray(e)&&"type"in e?r=e||{}:r={type:e};const s=r.type;if(typeof s>"u")throw new v('Missing required parameter: "type"');const n="/account/mfa/authenticators/{type}".replace("{type}",s),a={},o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("delete",o,c,a)}deleteMFAAuthenticator(e){let r;e&&typeof e=="object"&&!Array.isArray(e)&&"type"in e?r=e||{}:r={type:e};const s=r.type;if(typeof s>"u")throw new v('Missing required parameter: "type"');const n="/account/mfa/authenticators/{type}".replace("{type}",s),a={},o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("delete",o,c,a)}createMfaChallenge(e){let r;e&&typeof e=="object"&&!Array.isArray(e)&&"factor"in e?r=e||{}:r={factor:e};const s=r.factor;if(typeof s>"u")throw new v('Missing required parameter: "factor"');const n="/account/mfa/challenges",a={};typeof s<"u"&&(a.factor=s);const o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("post",o,c,a)}createMFAChallenge(e){let r;e&&typeof e=="object"&&!Array.isArray(e)&&"factor"in e?r=e||{}:r={factor:e};const s=r.factor;if(typeof s>"u")throw new v('Missing required parameter: "factor"');const n="/account/mfa/challenges",a={};typeof s<"u"&&(a.factor=s);const o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("post",o,c,a)}updateMfaChallenge(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={challengeId:e,otp:r[0]};const n=s.challengeId,a=s.otp;if(typeof n>"u")throw new v('Missing required parameter: "challengeId"');if(typeof a>"u")throw new v('Missing required parameter: "otp"');const o="/account/mfa/challenges",c={};typeof n<"u"&&(c.challengeId=n),typeof a<"u"&&(c.otp=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("put",l,u,c)}updateMFAChallenge(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={challengeId:e,otp:r[0]};const n=s.challengeId,a=s.otp;if(typeof n>"u")throw new v('Missing required parameter: "challengeId"');if(typeof a>"u")throw new v('Missing required parameter: "otp"');const o="/account/mfa/challenges",c={};typeof n<"u"&&(c.challengeId=n),typeof a<"u"&&(c.otp=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("put",l,u,c)}listMfaFactors(){const e="/account/mfa/factors",r={},s=new URL(this.client.config.endpoint+e),n={};return this.client.call("get",s,n,r)}listMFAFactors(){const e="/account/mfa/factors",r={},s=new URL(this.client.config.endpoint+e),n={};return this.client.call("get",s,n,r)}getMfaRecoveryCodes(){const e="/account/mfa/recovery-codes",r={},s=new URL(this.client.config.endpoint+e),n={};return this.client.call("get",s,n,r)}getMFARecoveryCodes(){const e="/account/mfa/recovery-codes",r={},s=new URL(this.client.config.endpoint+e),n={};return this.client.call("get",s,n,r)}createMfaRecoveryCodes(){const e="/account/mfa/recovery-codes",r={},s=new URL(this.client.config.endpoint+e),n={"content-type":"application/json"};return this.client.call("post",s,n,r)}createMFARecoveryCodes(){const e="/account/mfa/recovery-codes",r={},s=new URL(this.client.config.endpoint+e),n={"content-type":"application/json"};return this.client.call("post",s,n,r)}updateMfaRecoveryCodes(){const e="/account/mfa/recovery-codes",r={},s=new URL(this.client.config.endpoint+e),n={"content-type":"application/json"};return this.client.call("patch",s,n,r)}updateMFARecoveryCodes(){const e="/account/mfa/recovery-codes",r={},s=new URL(this.client.config.endpoint+e),n={"content-type":"application/json"};return this.client.call("patch",s,n,r)}updateName(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={name:e};const s=r.name;if(typeof s>"u")throw new v('Missing required parameter: "name"');const n="/account/name",a={};typeof s<"u"&&(a.name=s);const o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("patch",o,c,a)}updatePassword(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={password:e,oldPassword:r[0]};const n=s.password,a=s.oldPassword;if(typeof n>"u")throw new v('Missing required parameter: "password"');const o="/account/password",c={};typeof n<"u"&&(c.password=n),typeof a<"u"&&(c.oldPassword=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("patch",l,u,c)}updatePhone(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={phone:e,password:r[0]};const n=s.phone,a=s.password;if(typeof n>"u")throw new v('Missing required parameter: "phone"');if(typeof a>"u")throw new v('Missing required parameter: "password"');const o="/account/phone",c={};typeof n<"u"&&(c.phone=n),typeof a<"u"&&(c.password=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("patch",l,u,c)}getPrefs(){const e="/account/prefs",r={},s=new URL(this.client.config.endpoint+e),n={};return this.client.call("get",s,n,r)}updatePrefs(e){let r;e&&typeof e=="object"&&!Array.isArray(e)&&"prefs"in e?r=e||{}:r={prefs:e};const s=r.prefs;if(typeof s>"u")throw new v('Missing required parameter: "prefs"');const n="/account/prefs",a={};typeof s<"u"&&(a.prefs=s);const o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("patch",o,c,a)}createRecovery(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={email:e,url:r[0]};const n=s.email,a=s.url;if(typeof n>"u")throw new v('Missing required parameter: "email"');if(typeof a>"u")throw new v('Missing required parameter: "url"');const o="/account/recovery",c={};typeof n<"u"&&(c.email=n),typeof a<"u"&&(c.url=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("post",l,u,c)}updateRecovery(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={userId:e,secret:r[0],password:r[1]};const n=s.userId,a=s.secret,o=s.password;if(typeof n>"u")throw new v('Missing required parameter: "userId"');if(typeof a>"u")throw new v('Missing required parameter: "secret"');if(typeof o>"u")throw new v('Missing required parameter: "password"');const c="/account/recovery",l={};typeof n<"u"&&(l.userId=n),typeof a<"u"&&(l.secret=a),typeof o<"u"&&(l.password=o);const u=new URL(this.client.config.endpoint+c),d={"content-type":"application/json"};return this.client.call("put",u,d,l)}listSessions(){const e="/account/sessions",r={},s=new URL(this.client.config.endpoint+e),n={};return this.client.call("get",s,n,r)}deleteSessions(){const e="/account/sessions",r={},s=new URL(this.client.config.endpoint+e),n={"content-type":"application/json"};return this.client.call("delete",s,n,r)}createAnonymousSession(){const e="/account/sessions/anonymous",r={},s=new URL(this.client.config.endpoint+e),n={"content-type":"application/json"};return this.client.call("post",s,n,r)}createEmailPasswordSession(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={email:e,password:r[0]};const n=s.email,a=s.password;if(typeof n>"u")throw new v('Missing required parameter: "email"');if(typeof a>"u")throw new v('Missing required parameter: "password"');const o="/account/sessions/email",c={};typeof n<"u"&&(c.email=n),typeof a<"u"&&(c.password=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("post",l,u,c)}updateMagicURLSession(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={userId:e,secret:r[0]};const n=s.userId,a=s.secret;if(typeof n>"u")throw new v('Missing required parameter: "userId"');if(typeof a>"u")throw new v('Missing required parameter: "secret"');const o="/account/sessions/magic-url",c={};typeof n<"u"&&(c.userId=n),typeof a<"u"&&(c.secret=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("put",l,u,c)}createOAuth2Session(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)&&"provider"in e?s=e||{}:s={provider:e,success:r[0],failure:r[1],scopes:r[2]};const n=s.provider,a=s.success,o=s.failure,c=s.scopes;if(typeof n>"u")throw new v('Missing required parameter: "provider"');const l="/account/sessions/oauth2/{provider}".replace("{provider}",n),u={};typeof a<"u"&&(u.success=a),typeof o<"u"&&(u.failure=o),typeof c<"u"&&(u.scopes=c);const d=new URL(this.client.config.endpoint+l);u.project=this.client.config.project;for(const[h,p]of Object.entries(An.flatten(u)))d.searchParams.append(h,p);if(typeof window<"u"&&window?.location){window.location.href=d.toString();return}else return d.toString()}updatePhoneSession(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={userId:e,secret:r[0]};const n=s.userId,a=s.secret;if(typeof n>"u")throw new v('Missing required parameter: "userId"');if(typeof a>"u")throw new v('Missing required parameter: "secret"');const o="/account/sessions/phone",c={};typeof n<"u"&&(c.userId=n),typeof a<"u"&&(c.secret=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("put",l,u,c)}createSession(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={userId:e,secret:r[0]};const n=s.userId,a=s.secret;if(typeof n>"u")throw new v('Missing required parameter: "userId"');if(typeof a>"u")throw new v('Missing required parameter: "secret"');const o="/account/sessions/token",c={};typeof n<"u"&&(c.userId=n),typeof a<"u"&&(c.secret=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("post",l,u,c)}getSession(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={sessionId:e};const s=r.sessionId;if(typeof s>"u")throw new v('Missing required parameter: "sessionId"');const n="/account/sessions/{sessionId}".replace("{sessionId}",s),a={},o=new URL(this.client.config.endpoint+n),c={};return this.client.call("get",o,c,a)}updateSession(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={sessionId:e};const s=r.sessionId;if(typeof s>"u")throw new v('Missing required parameter: "sessionId"');const n="/account/sessions/{sessionId}".replace("{sessionId}",s),a={},o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("patch",o,c,a)}deleteSession(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={sessionId:e};const s=r.sessionId;if(typeof s>"u")throw new v('Missing required parameter: "sessionId"');const n="/account/sessions/{sessionId}".replace("{sessionId}",s),a={},o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("delete",o,c,a)}updateStatus(){const e="/account/status",r={},s=new URL(this.client.config.endpoint+e),n={"content-type":"application/json"};return this.client.call("patch",s,n,r)}createPushTarget(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={targetId:e,identifier:r[0],providerId:r[1]};const n=s.targetId,a=s.identifier,o=s.providerId;if(typeof n>"u")throw new v('Missing required parameter: "targetId"');if(typeof a>"u")throw new v('Missing required parameter: "identifier"');const c="/account/targets/push",l={};typeof n<"u"&&(l.targetId=n),typeof a<"u"&&(l.identifier=a),typeof o<"u"&&(l.providerId=o);const u=new URL(this.client.config.endpoint+c),d={"content-type":"application/json"};return this.client.call("post",u,d,l)}updatePushTarget(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={targetId:e,identifier:r[0]};const n=s.targetId,a=s.identifier;if(typeof n>"u")throw new v('Missing required parameter: "targetId"');if(typeof a>"u")throw new v('Missing required parameter: "identifier"');const o="/account/targets/{targetId}/push".replace("{targetId}",n),c={};typeof a<"u"&&(c.identifier=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("put",l,u,c)}deletePushTarget(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={targetId:e};const s=r.targetId;if(typeof s>"u")throw new v('Missing required parameter: "targetId"');const n="/account/targets/{targetId}/push".replace("{targetId}",s),a={},o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("delete",o,c,a)}createEmailToken(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={userId:e,email:r[0],phrase:r[1]};const n=s.userId,a=s.email,o=s.phrase;if(typeof n>"u")throw new v('Missing required parameter: "userId"');if(typeof a>"u")throw new v('Missing required parameter: "email"');const c="/account/tokens/email",l={};typeof n<"u"&&(l.userId=n),typeof a<"u"&&(l.email=a),typeof o<"u"&&(l.phrase=o);const u=new URL(this.client.config.endpoint+c),d={"content-type":"application/json"};return this.client.call("post",u,d,l)}createMagicURLToken(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={userId:e,email:r[0],url:r[1],phrase:r[2]};const n=s.userId,a=s.email,o=s.url,c=s.phrase;if(typeof n>"u")throw new v('Missing required parameter: "userId"');if(typeof a>"u")throw new v('Missing required parameter: "email"');const l="/account/tokens/magic-url",u={};typeof n<"u"&&(u.userId=n),typeof a<"u"&&(u.email=a),typeof o<"u"&&(u.url=o),typeof c<"u"&&(u.phrase=c);const d=new URL(this.client.config.endpoint+l),h={"content-type":"application/json"};return this.client.call("post",d,h,u)}createOAuth2Token(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)&&"provider"in e?s=e||{}:s={provider:e,success:r[0],failure:r[1],scopes:r[2]};const n=s.provider,a=s.success,o=s.failure,c=s.scopes;if(typeof n>"u")throw new v('Missing required parameter: "provider"');const l="/account/tokens/oauth2/{provider}".replace("{provider}",n),u={};typeof a<"u"&&(u.success=a),typeof o<"u"&&(u.failure=o),typeof c<"u"&&(u.scopes=c);const d=new URL(this.client.config.endpoint+l);u.project=this.client.config.project;for(const[h,p]of Object.entries(An.flatten(u)))d.searchParams.append(h,p);if(typeof window<"u"&&window?.location){window.location.href=d.toString();return}else return d.toString()}createPhoneToken(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={userId:e,phone:r[0]};const n=s.userId,a=s.phone;if(typeof n>"u")throw new v('Missing required parameter: "userId"');if(typeof a>"u")throw new v('Missing required parameter: "phone"');const o="/account/tokens/phone",c={};typeof n<"u"&&(c.userId=n),typeof a<"u"&&(c.phone=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("post",l,u,c)}createEmailVerification(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={url:e};const s=r.url;if(typeof s>"u")throw new v('Missing required parameter: "url"');const n="/account/verifications/email",a={};typeof s<"u"&&(a.url=s);const o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("post",o,c,a)}createVerification(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={url:e};const s=r.url;if(typeof s>"u")throw new v('Missing required parameter: "url"');const n="/account/verifications/email",a={};typeof s<"u"&&(a.url=s);const o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("post",o,c,a)}updateEmailVerification(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={userId:e,secret:r[0]};const n=s.userId,a=s.secret;if(typeof n>"u")throw new v('Missing required parameter: "userId"');if(typeof a>"u")throw new v('Missing required parameter: "secret"');const o="/account/verifications/email",c={};typeof n<"u"&&(c.userId=n),typeof a<"u"&&(c.secret=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("put",l,u,c)}updateVerification(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={userId:e,secret:r[0]};const n=s.userId,a=s.secret;if(typeof n>"u")throw new v('Missing required parameter: "userId"');if(typeof a>"u")throw new v('Missing required parameter: "secret"');const o="/account/verifications/email",c={};typeof n<"u"&&(c.userId=n),typeof a<"u"&&(c.secret=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("put",l,u,c)}createPhoneVerification(){const e="/account/verifications/phone",r={},s=new URL(this.client.config.endpoint+e),n={"content-type":"application/json"};return this.client.call("post",s,n,r)}updatePhoneVerification(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={userId:e,secret:r[0]};const n=s.userId,a=s.secret;if(typeof n>"u")throw new v('Missing required parameter: "userId"');if(typeof a>"u")throw new v('Missing required parameter: "secret"');const o="/account/verifications/phone",c={};typeof n<"u"&&(c.userId=n),typeof a<"u"&&(c.secret=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("put",l,u,c)}}class Rp{constructor(e){this.client=e}listTransactions(e){let r;!e||e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={queries:e};const s=r.queries,n="/databases/transactions",a={};typeof s<"u"&&(a.queries=s);const o=new URL(this.client.config.endpoint+n),c={};return this.client.call("get",o,c,a)}createTransaction(e){let r;!e||e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={ttl:e};const s=r.ttl,n="/databases/transactions",a={};typeof s<"u"&&(a.ttl=s);const o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("post",o,c,a)}getTransaction(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={transactionId:e};const s=r.transactionId;if(typeof s>"u")throw new v('Missing required parameter: "transactionId"');const n="/databases/transactions/{transactionId}".replace("{transactionId}",s),a={},o=new URL(this.client.config.endpoint+n),c={};return this.client.call("get",o,c,a)}updateTransaction(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={transactionId:e,commit:r[0],rollback:r[1]};const n=s.transactionId,a=s.commit,o=s.rollback;if(typeof n>"u")throw new v('Missing required parameter: "transactionId"');const c="/databases/transactions/{transactionId}".replace("{transactionId}",n),l={};typeof a<"u"&&(l.commit=a),typeof o<"u"&&(l.rollback=o);const u=new URL(this.client.config.endpoint+c),d={"content-type":"application/json"};return this.client.call("patch",u,d,l)}deleteTransaction(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={transactionId:e};const s=r.transactionId;if(typeof s>"u")throw new v('Missing required parameter: "transactionId"');const n="/databases/transactions/{transactionId}".replace("{transactionId}",s),a={},o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("delete",o,c,a)}createOperations(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={transactionId:e,operations:r[0]};const n=s.transactionId,a=s.operations;if(typeof n>"u")throw new v('Missing required parameter: "transactionId"');const o="/databases/transactions/{transactionId}/operations".replace("{transactionId}",n),c={};typeof a<"u"&&(c.operations=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("post",l,u,c)}listDocuments(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,collectionId:r[0],queries:r[1],transactionId:r[2],total:r[3]};const n=s.databaseId,a=s.collectionId,o=s.queries,c=s.transactionId,l=s.total;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "collectionId"');const u="/databases/{databaseId}/collections/{collectionId}/documents".replace("{databaseId}",n).replace("{collectionId}",a),d={};typeof o<"u"&&(d.queries=o),typeof c<"u"&&(d.transactionId=c),typeof l<"u"&&(d.total=l);const h=new URL(this.client.config.endpoint+u),p={};return this.client.call("get",h,p,d)}createDocument(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,collectionId:r[0],documentId:r[1],data:r[2],permissions:r[3],transactionId:r[4]};const n=s.databaseId,a=s.collectionId,o=s.documentId,c=s.data,l=s.permissions,u=s.transactionId;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "collectionId"');if(typeof o>"u")throw new v('Missing required parameter: "documentId"');if(typeof c>"u")throw new v('Missing required parameter: "data"');const d="/databases/{databaseId}/collections/{collectionId}/documents".replace("{databaseId}",n).replace("{collectionId}",a),h={};typeof o<"u"&&(h.documentId=o),typeof c<"u"&&(h.data=c),typeof l<"u"&&(h.permissions=l),typeof u<"u"&&(h.transactionId=u);const p=new URL(this.client.config.endpoint+d),g={"content-type":"application/json"};return this.client.call("post",p,g,h)}getDocument(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,collectionId:r[0],documentId:r[1],queries:r[2],transactionId:r[3]};const n=s.databaseId,a=s.collectionId,o=s.documentId,c=s.queries,l=s.transactionId;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "collectionId"');if(typeof o>"u")throw new v('Missing required parameter: "documentId"');const u="/databases/{databaseId}/collections/{collectionId}/documents/{documentId}".replace("{databaseId}",n).replace("{collectionId}",a).replace("{documentId}",o),d={};typeof c<"u"&&(d.queries=c),typeof l<"u"&&(d.transactionId=l);const h=new URL(this.client.config.endpoint+u),p={};return this.client.call("get",h,p,d)}upsertDocument(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,collectionId:r[0],documentId:r[1],data:r[2],permissions:r[3],transactionId:r[4]};const n=s.databaseId,a=s.collectionId,o=s.documentId,c=s.data,l=s.permissions,u=s.transactionId;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "collectionId"');if(typeof o>"u")throw new v('Missing required parameter: "documentId"');if(typeof c>"u")throw new v('Missing required parameter: "data"');const d="/databases/{databaseId}/collections/{collectionId}/documents/{documentId}".replace("{databaseId}",n).replace("{collectionId}",a).replace("{documentId}",o),h={};typeof c<"u"&&(h.data=c),typeof l<"u"&&(h.permissions=l),typeof u<"u"&&(h.transactionId=u);const p=new URL(this.client.config.endpoint+d),g={"content-type":"application/json"};return this.client.call("put",p,g,h)}updateDocument(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,collectionId:r[0],documentId:r[1],data:r[2],permissions:r[3],transactionId:r[4]};const n=s.databaseId,a=s.collectionId,o=s.documentId,c=s.data,l=s.permissions,u=s.transactionId;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "collectionId"');if(typeof o>"u")throw new v('Missing required parameter: "documentId"');const d="/databases/{databaseId}/collections/{collectionId}/documents/{documentId}".replace("{databaseId}",n).replace("{collectionId}",a).replace("{documentId}",o),h={};typeof c<"u"&&(h.data=c),typeof l<"u"&&(h.permissions=l),typeof u<"u"&&(h.transactionId=u);const p=new URL(this.client.config.endpoint+d),g={"content-type":"application/json"};return this.client.call("patch",p,g,h)}deleteDocument(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,collectionId:r[0],documentId:r[1],transactionId:r[2]};const n=s.databaseId,a=s.collectionId,o=s.documentId,c=s.transactionId;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "collectionId"');if(typeof o>"u")throw new v('Missing required parameter: "documentId"');const l="/databases/{databaseId}/collections/{collectionId}/documents/{documentId}".replace("{databaseId}",n).replace("{collectionId}",a).replace("{documentId}",o),u={};typeof c<"u"&&(u.transactionId=c);const d=new URL(this.client.config.endpoint+l),h={"content-type":"application/json"};return this.client.call("delete",d,h,u)}decrementDocumentAttribute(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,collectionId:r[0],documentId:r[1],attribute:r[2],value:r[3],min:r[4],transactionId:r[5]};const n=s.databaseId,a=s.collectionId,o=s.documentId,c=s.attribute,l=s.value,u=s.min,d=s.transactionId;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "collectionId"');if(typeof o>"u")throw new v('Missing required parameter: "documentId"');if(typeof c>"u")throw new v('Missing required parameter: "attribute"');const h="/databases/{databaseId}/collections/{collectionId}/documents/{documentId}/{attribute}/decrement".replace("{databaseId}",n).replace("{collectionId}",a).replace("{documentId}",o).replace("{attribute}",c),p={};typeof l<"u"&&(p.value=l),typeof u<"u"&&(p.min=u),typeof d<"u"&&(p.transactionId=d);const g=new URL(this.client.config.endpoint+h),w={"content-type":"application/json"};return this.client.call("patch",g,w,p)}incrementDocumentAttribute(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,collectionId:r[0],documentId:r[1],attribute:r[2],value:r[3],max:r[4],transactionId:r[5]};const n=s.databaseId,a=s.collectionId,o=s.documentId,c=s.attribute,l=s.value,u=s.max,d=s.transactionId;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "collectionId"');if(typeof o>"u")throw new v('Missing required parameter: "documentId"');if(typeof c>"u")throw new v('Missing required parameter: "attribute"');const h="/databases/{databaseId}/collections/{collectionId}/documents/{documentId}/{attribute}/increment".replace("{databaseId}",n).replace("{collectionId}",a).replace("{documentId}",o).replace("{attribute}",c),p={};typeof l<"u"&&(p.value=l),typeof u<"u"&&(p.max=u),typeof d<"u"&&(p.transactionId=d);const g=new URL(this.client.config.endpoint+h),w={"content-type":"application/json"};return this.client.call("patch",g,w,p)}}class Pp{constructor(e){this.client=e}listExecutions(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={functionId:e,queries:r[0],total:r[1]};const n=s.functionId,a=s.queries,o=s.total;if(typeof n>"u")throw new v('Missing required parameter: "functionId"');const c="/functions/{functionId}/executions".replace("{functionId}",n),l={};typeof a<"u"&&(l.queries=a),typeof o<"u"&&(l.total=o);const u=new URL(this.client.config.endpoint+c),d={};return this.client.call("get",u,d,l)}createExecution(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={functionId:e,body:r[0],async:r[1],xpath:r[2],method:r[3],headers:r[4],scheduledAt:r[5]};const n=s.functionId,a=s.body,o=s.async,c=s.xpath,l=s.method,u=s.headers,d=s.scheduledAt;if(typeof n>"u")throw new v('Missing required parameter: "functionId"');const h="/functions/{functionId}/executions".replace("{functionId}",n),p={};typeof a<"u"&&(p.body=a),typeof o<"u"&&(p.async=o),typeof c<"u"&&(p.path=c),typeof l<"u"&&(p.method=l),typeof u<"u"&&(p.headers=u),typeof d<"u"&&(p.scheduledAt=d);const g=new URL(this.client.config.endpoint+h),w={"content-type":"application/json"};return this.client.call("post",g,w,p)}getExecution(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={functionId:e,executionId:r[0]};const n=s.functionId,a=s.executionId;if(typeof n>"u")throw new v('Missing required parameter: "functionId"');if(typeof a>"u")throw new v('Missing required parameter: "executionId"');const o="/functions/{functionId}/executions/{executionId}".replace("{functionId}",n).replace("{executionId}",a),c={},l=new URL(this.client.config.endpoint+o),u={};return this.client.call("get",l,u,c)}}class Dp{constructor(e){this.client=e}listTransactions(e){let r;!e||e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={queries:e};const s=r.queries,n="/tablesdb/transactions",a={};typeof s<"u"&&(a.queries=s);const o=new URL(this.client.config.endpoint+n),c={};return this.client.call("get",o,c,a)}createTransaction(e){let r;!e||e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={ttl:e};const s=r.ttl,n="/tablesdb/transactions",a={};typeof s<"u"&&(a.ttl=s);const o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("post",o,c,a)}getTransaction(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={transactionId:e};const s=r.transactionId;if(typeof s>"u")throw new v('Missing required parameter: "transactionId"');const n="/tablesdb/transactions/{transactionId}".replace("{transactionId}",s),a={},o=new URL(this.client.config.endpoint+n),c={};return this.client.call("get",o,c,a)}updateTransaction(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={transactionId:e,commit:r[0],rollback:r[1]};const n=s.transactionId,a=s.commit,o=s.rollback;if(typeof n>"u")throw new v('Missing required parameter: "transactionId"');const c="/tablesdb/transactions/{transactionId}".replace("{transactionId}",n),l={};typeof a<"u"&&(l.commit=a),typeof o<"u"&&(l.rollback=o);const u=new URL(this.client.config.endpoint+c),d={"content-type":"application/json"};return this.client.call("patch",u,d,l)}deleteTransaction(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={transactionId:e};const s=r.transactionId;if(typeof s>"u")throw new v('Missing required parameter: "transactionId"');const n="/tablesdb/transactions/{transactionId}".replace("{transactionId}",s),a={},o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("delete",o,c,a)}createOperations(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={transactionId:e,operations:r[0]};const n=s.transactionId,a=s.operations;if(typeof n>"u")throw new v('Missing required parameter: "transactionId"');const o="/tablesdb/transactions/{transactionId}/operations".replace("{transactionId}",n),c={};typeof a<"u"&&(c.operations=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("post",l,u,c)}listRows(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,tableId:r[0],queries:r[1],transactionId:r[2],total:r[3]};const n=s.databaseId,a=s.tableId,o=s.queries,c=s.transactionId,l=s.total;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "tableId"');const u="/tablesdb/{databaseId}/tables/{tableId}/rows".replace("{databaseId}",n).replace("{tableId}",a),d={};typeof o<"u"&&(d.queries=o),typeof c<"u"&&(d.transactionId=c),typeof l<"u"&&(d.total=l);const h=new URL(this.client.config.endpoint+u),p={};return this.client.call("get",h,p,d)}createRow(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,tableId:r[0],rowId:r[1],data:r[2],permissions:r[3],transactionId:r[4]};const n=s.databaseId,a=s.tableId,o=s.rowId,c=s.data,l=s.permissions,u=s.transactionId;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "tableId"');if(typeof o>"u")throw new v('Missing required parameter: "rowId"');if(typeof c>"u")throw new v('Missing required parameter: "data"');const d="/tablesdb/{databaseId}/tables/{tableId}/rows".replace("{databaseId}",n).replace("{tableId}",a),h={};typeof o<"u"&&(h.rowId=o),typeof c<"u"&&(h.data=c),typeof l<"u"&&(h.permissions=l),typeof u<"u"&&(h.transactionId=u);const p=new URL(this.client.config.endpoint+d),g={"content-type":"application/json"};return this.client.call("post",p,g,h)}getRow(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,tableId:r[0],rowId:r[1],queries:r[2],transactionId:r[3]};const n=s.databaseId,a=s.tableId,o=s.rowId,c=s.queries,l=s.transactionId;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "tableId"');if(typeof o>"u")throw new v('Missing required parameter: "rowId"');const u="/tablesdb/{databaseId}/tables/{tableId}/rows/{rowId}".replace("{databaseId}",n).replace("{tableId}",a).replace("{rowId}",o),d={};typeof c<"u"&&(d.queries=c),typeof l<"u"&&(d.transactionId=l);const h=new URL(this.client.config.endpoint+u),p={};return this.client.call("get",h,p,d)}upsertRow(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,tableId:r[0],rowId:r[1],data:r[2],permissions:r[3],transactionId:r[4]};const n=s.databaseId,a=s.tableId,o=s.rowId,c=s.data,l=s.permissions,u=s.transactionId;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "tableId"');if(typeof o>"u")throw new v('Missing required parameter: "rowId"');const d="/tablesdb/{databaseId}/tables/{tableId}/rows/{rowId}".replace("{databaseId}",n).replace("{tableId}",a).replace("{rowId}",o),h={};typeof c<"u"&&(h.data=c),typeof l<"u"&&(h.permissions=l),typeof u<"u"&&(h.transactionId=u);const p=new URL(this.client.config.endpoint+d),g={"content-type":"application/json"};return this.client.call("put",p,g,h)}updateRow(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,tableId:r[0],rowId:r[1],data:r[2],permissions:r[3],transactionId:r[4]};const n=s.databaseId,a=s.tableId,o=s.rowId,c=s.data,l=s.permissions,u=s.transactionId;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "tableId"');if(typeof o>"u")throw new v('Missing required parameter: "rowId"');const d="/tablesdb/{databaseId}/tables/{tableId}/rows/{rowId}".replace("{databaseId}",n).replace("{tableId}",a).replace("{rowId}",o),h={};typeof c<"u"&&(h.data=c),typeof l<"u"&&(h.permissions=l),typeof u<"u"&&(h.transactionId=u);const p=new URL(this.client.config.endpoint+d),g={"content-type":"application/json"};return this.client.call("patch",p,g,h)}deleteRow(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,tableId:r[0],rowId:r[1],transactionId:r[2]};const n=s.databaseId,a=s.tableId,o=s.rowId,c=s.transactionId;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "tableId"');if(typeof o>"u")throw new v('Missing required parameter: "rowId"');const l="/tablesdb/{databaseId}/tables/{tableId}/rows/{rowId}".replace("{databaseId}",n).replace("{tableId}",a).replace("{rowId}",o),u={};typeof c<"u"&&(u.transactionId=c);const d=new URL(this.client.config.endpoint+l),h={"content-type":"application/json"};return this.client.call("delete",d,h,u)}decrementRowColumn(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,tableId:r[0],rowId:r[1],column:r[2],value:r[3],min:r[4],transactionId:r[5]};const n=s.databaseId,a=s.tableId,o=s.rowId,c=s.column,l=s.value,u=s.min,d=s.transactionId;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "tableId"');if(typeof o>"u")throw new v('Missing required parameter: "rowId"');if(typeof c>"u")throw new v('Missing required parameter: "column"');const h="/tablesdb/{databaseId}/tables/{tableId}/rows/{rowId}/{column}/decrement".replace("{databaseId}",n).replace("{tableId}",a).replace("{rowId}",o).replace("{column}",c),p={};typeof l<"u"&&(p.value=l),typeof u<"u"&&(p.min=u),typeof d<"u"&&(p.transactionId=d);const g=new URL(this.client.config.endpoint+h),w={"content-type":"application/json"};return this.client.call("patch",g,w,p)}incrementRowColumn(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={databaseId:e,tableId:r[0],rowId:r[1],column:r[2],value:r[3],max:r[4],transactionId:r[5]};const n=s.databaseId,a=s.tableId,o=s.rowId,c=s.column,l=s.value,u=s.max,d=s.transactionId;if(typeof n>"u")throw new v('Missing required parameter: "databaseId"');if(typeof a>"u")throw new v('Missing required parameter: "tableId"');if(typeof o>"u")throw new v('Missing required parameter: "rowId"');if(typeof c>"u")throw new v('Missing required parameter: "column"');const h="/tablesdb/{databaseId}/tables/{tableId}/rows/{rowId}/{column}/increment".replace("{databaseId}",n).replace("{tableId}",a).replace("{rowId}",o).replace("{column}",c),p={};typeof l<"u"&&(p.value=l),typeof u<"u"&&(p.max=u),typeof d<"u"&&(p.transactionId=d);const g=new URL(this.client.config.endpoint+h),w={"content-type":"application/json"};return this.client.call("patch",g,w,p)}}class Mp{constructor(e){this.client=e}list(e,...r){let s;!e||e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={queries:e,search:r[0],total:r[1]};const n=s.queries,a=s.search,o=s.total,c="/teams",l={};typeof n<"u"&&(l.queries=n),typeof a<"u"&&(l.search=a),typeof o<"u"&&(l.total=o);const u=new URL(this.client.config.endpoint+c),d={};return this.client.call("get",u,d,l)}create(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={teamId:e,name:r[0],roles:r[1]};const n=s.teamId,a=s.name,o=s.roles;if(typeof n>"u")throw new v('Missing required parameter: "teamId"');if(typeof a>"u")throw new v('Missing required parameter: "name"');const c="/teams",l={};typeof n<"u"&&(l.teamId=n),typeof a<"u"&&(l.name=a),typeof o<"u"&&(l.roles=o);const u=new URL(this.client.config.endpoint+c),d={"content-type":"application/json"};return this.client.call("post",u,d,l)}get(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={teamId:e};const s=r.teamId;if(typeof s>"u")throw new v('Missing required parameter: "teamId"');const n="/teams/{teamId}".replace("{teamId}",s),a={},o=new URL(this.client.config.endpoint+n),c={};return this.client.call("get",o,c,a)}updateName(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={teamId:e,name:r[0]};const n=s.teamId,a=s.name;if(typeof n>"u")throw new v('Missing required parameter: "teamId"');if(typeof a>"u")throw new v('Missing required parameter: "name"');const o="/teams/{teamId}".replace("{teamId}",n),c={};typeof a<"u"&&(c.name=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("put",l,u,c)}delete(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={teamId:e};const s=r.teamId;if(typeof s>"u")throw new v('Missing required parameter: "teamId"');const n="/teams/{teamId}".replace("{teamId}",s),a={},o=new URL(this.client.config.endpoint+n),c={"content-type":"application/json"};return this.client.call("delete",o,c,a)}listMemberships(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={teamId:e,queries:r[0],search:r[1],total:r[2]};const n=s.teamId,a=s.queries,o=s.search,c=s.total;if(typeof n>"u")throw new v('Missing required parameter: "teamId"');const l="/teams/{teamId}/memberships".replace("{teamId}",n),u={};typeof a<"u"&&(u.queries=a),typeof o<"u"&&(u.search=o),typeof c<"u"&&(u.total=c);const d=new URL(this.client.config.endpoint+l),h={};return this.client.call("get",d,h,u)}createMembership(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={teamId:e,roles:r[0],email:r[1],userId:r[2],phone:r[3],url:r[4],name:r[5]};const n=s.teamId,a=s.roles,o=s.email,c=s.userId,l=s.phone,u=s.url,d=s.name;if(typeof n>"u")throw new v('Missing required parameter: "teamId"');if(typeof a>"u")throw new v('Missing required parameter: "roles"');const h="/teams/{teamId}/memberships".replace("{teamId}",n),p={};typeof o<"u"&&(p.email=o),typeof c<"u"&&(p.userId=c),typeof l<"u"&&(p.phone=l),typeof a<"u"&&(p.roles=a),typeof u<"u"&&(p.url=u),typeof d<"u"&&(p.name=d);const g=new URL(this.client.config.endpoint+h),w={"content-type":"application/json"};return this.client.call("post",g,w,p)}getMembership(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={teamId:e,membershipId:r[0]};const n=s.teamId,a=s.membershipId;if(typeof n>"u")throw new v('Missing required parameter: "teamId"');if(typeof a>"u")throw new v('Missing required parameter: "membershipId"');const o="/teams/{teamId}/memberships/{membershipId}".replace("{teamId}",n).replace("{membershipId}",a),c={},l=new URL(this.client.config.endpoint+o),u={};return this.client.call("get",l,u,c)}updateMembership(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={teamId:e,membershipId:r[0],roles:r[1]};const n=s.teamId,a=s.membershipId,o=s.roles;if(typeof n>"u")throw new v('Missing required parameter: "teamId"');if(typeof a>"u")throw new v('Missing required parameter: "membershipId"');if(typeof o>"u")throw new v('Missing required parameter: "roles"');const c="/teams/{teamId}/memberships/{membershipId}".replace("{teamId}",n).replace("{membershipId}",a),l={};typeof o<"u"&&(l.roles=o);const u=new URL(this.client.config.endpoint+c),d={"content-type":"application/json"};return this.client.call("patch",u,d,l)}deleteMembership(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={teamId:e,membershipId:r[0]};const n=s.teamId,a=s.membershipId;if(typeof n>"u")throw new v('Missing required parameter: "teamId"');if(typeof a>"u")throw new v('Missing required parameter: "membershipId"');const o="/teams/{teamId}/memberships/{membershipId}".replace("{teamId}",n).replace("{membershipId}",a),c={},l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("delete",l,u,c)}updateMembershipStatus(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={teamId:e,membershipId:r[0],userId:r[1],secret:r[2]};const n=s.teamId,a=s.membershipId,o=s.userId,c=s.secret;if(typeof n>"u")throw new v('Missing required parameter: "teamId"');if(typeof a>"u")throw new v('Missing required parameter: "membershipId"');if(typeof o>"u")throw new v('Missing required parameter: "userId"');if(typeof c>"u")throw new v('Missing required parameter: "secret"');const l="/teams/{teamId}/memberships/{membershipId}/status".replace("{teamId}",n).replace("{membershipId}",a),u={};typeof o<"u"&&(u.userId=o),typeof c<"u"&&(u.secret=c);const d=new URL(this.client.config.endpoint+l),h={"content-type":"application/json"};return this.client.call("patch",d,h,u)}getPrefs(e){let r;e&&typeof e=="object"&&!Array.isArray(e)?r=e||{}:r={teamId:e};const s=r.teamId;if(typeof s>"u")throw new v('Missing required parameter: "teamId"');const n="/teams/{teamId}/prefs".replace("{teamId}",s),a={},o=new URL(this.client.config.endpoint+n),c={};return this.client.call("get",o,c,a)}updatePrefs(e,...r){let s;e&&typeof e=="object"&&!Array.isArray(e)?s=e||{}:s={teamId:e,prefs:r[0]};const n=s.teamId,a=s.prefs;if(typeof n>"u")throw new v('Missing required parameter: "teamId"');if(typeof a>"u")throw new v('Missing required parameter: "prefs"');const o="/teams/{teamId}/prefs".replace("{teamId}",n),c={};typeof a<"u"&&(c.prefs=a);const l=new URL(this.client.config.endpoint+o),u={"content-type":"application/json"};return this.client.call("put",l,u,c)}}var Uc;(function(t){t[t.NORMAL_CLOSURE=1e3]="NORMAL_CLOSURE",t[t.POLICY_VIOLATION=1008]="POLICY_VIOLATION",t[t.UNKNOWN_ERROR=-1]="UNKNOWN_ERROR"})(Uc||(Uc={}));class te{}te.read=t=>`read("${t}")`;te.write=t=>`write("${t}")`;te.create=t=>`create("${t}")`;te.update=t=>`update("${t}")`;te.delete=t=>`delete("${t}")`;class ie{static any(){return"any"}static user(e,r=""){return r===""?`user:${e}`:`user:${e}/${r}`}static users(e=""){return e===""?"users":`users/${e}`}static guests(){return"guests"}static team(e,r=""){return r===""?`team:${e}`:`team:${e}/${r}`}static member(e){return`member:${e}`}static label(e){return`label:${e}`}}var Nu,Lu;class yt{static custom(e){return e}static unique(e=7){const r=Ap(yt,Nu,"m",Lu).call(yt);let s="";for(let n=0;n<e;n++){const a=Math.floor(Math.random()*16).toString(16);s+=a}return r+s}}Nu=yt,Lu=function(){const e=new Date,r=Math.floor(e.getTime()/1e3),s=e.getMilliseconds();return r.toString(16)+s.toString(16).padStart(5,"0")};var Bc;(function(t){t.Equal="equal",t.NotEqual="notEqual",t.GreaterThan="greaterThan",t.GreaterThanEqual="greaterThanEqual",t.LessThan="lessThan",t.LessThanEqual="lessThanEqual",t.Contains="contains",t.IsNull="isNull",t.IsNotNull="isNotNull"})(Bc||(Bc={}));var xc;(function(t){t.Totp="totp"})(xc||(xc={}));var Hc;(function(t){t.Email="email",t.Phone="phone",t.Totp="totp",t.Recoverycode="recoverycode"})(Hc||(Hc={}));var Vc;(function(t){t.Amazon="amazon",t.Apple="apple",t.Auth0="auth0",t.Authentik="authentik",t.Autodesk="autodesk",t.Bitbucket="bitbucket",t.Bitly="bitly",t.Box="box",t.Dailymotion="dailymotion",t.Discord="discord",t.Disqus="disqus",t.Dropbox="dropbox",t.Etsy="etsy",t.Facebook="facebook",t.Figma="figma",t.Github="github",t.Gitlab="gitlab",t.Google="google",t.Linkedin="linkedin",t.Microsoft="microsoft",t.Notion="notion",t.Oidc="oidc",t.Okta="okta",t.Paypal="paypal",t.PaypalSandbox="paypalSandbox",t.Podio="podio",t.Salesforce="salesforce",t.Slack="slack",t.Spotify="spotify",t.Stripe="stripe",t.Tradeshift="tradeshift",t.TradeshiftBox="tradeshiftBox",t.Twitch="twitch",t.Wordpress="wordpress",t.Yahoo="yahoo",t.Yammer="yammer",t.Yandex="yandex",t.Zoho="zoho",t.Zoom="zoom",t.Mock="mock"})(Vc||(Vc={}));var Wc;(function(t){t.AvantBrowser="aa",t.AndroidWebViewBeta="an",t.GoogleChrome="ch",t.GoogleChromeIOS="ci",t.GoogleChromeMobile="cm",t.Chromium="cr",t.MozillaFirefox="ff",t.Safari="sf",t.MobileSafari="mf",t.MicrosoftEdge="ps",t.MicrosoftEdgeIOS="oi",t.OperaMini="om",t.Opera="op",t.OperaNext="on"})(Wc||(Wc={}));var Gc;(function(t){t.AmericanExpress="amex",t.Argencard="argencard",t.Cabal="cabal",t.Cencosud="cencosud",t.DinersClub="diners",t.Discover="discover",t.Elo="elo",t.Hipercard="hipercard",t.JCB="jcb",t.Mastercard="mastercard",t.Naranja="naranja",t.TarjetaShopping="targeta-shopping",t.UnionPay="unionpay",t.Visa="visa",t.MIR="mir",t.Maestro="maestro",t.Rupay="rupay"})(Gc||(Gc={}));var Qc;(function(t){t.Afghanistan="af",t.Angola="ao",t.Albania="al",t.Andorra="ad",t.UnitedArabEmirates="ae",t.Argentina="ar",t.Armenia="am",t.AntiguaAndBarbuda="ag",t.Australia="au",t.Austria="at",t.Azerbaijan="az",t.Burundi="bi",t.Belgium="be",t.Benin="bj",t.BurkinaFaso="bf",t.Bangladesh="bd",t.Bulgaria="bg",t.Bahrain="bh",t.Bahamas="bs",t.BosniaAndHerzegovina="ba",t.Belarus="by",t.Belize="bz",t.Bolivia="bo",t.Brazil="br",t.Barbados="bb",t.BruneiDarussalam="bn",t.Bhutan="bt",t.Botswana="bw",t.CentralAfricanRepublic="cf",t.Canada="ca",t.Switzerland="ch",t.Chile="cl",t.China="cn",t.CoteDIvoire="ci",t.Cameroon="cm",t.DemocraticRepublicOfTheCongo="cd",t.RepublicOfTheCongo="cg",t.Colombia="co",t.Comoros="km",t.CapeVerde="cv",t.CostaRica="cr",t.Cuba="cu",t.Cyprus="cy",t.CzechRepublic="cz",t.Germany="de",t.Djibouti="dj",t.Dominica="dm",t.Denmark="dk",t.DominicanRepublic="do",t.Algeria="dz",t.Ecuador="ec",t.Egypt="eg",t.Eritrea="er",t.Spain="es",t.Estonia="ee",t.Ethiopia="et",t.Finland="fi",t.Fiji="fj",t.France="fr",t.MicronesiaFederatedStatesOf="fm",t.Gabon="ga",t.UnitedKingdom="gb",t.Georgia="ge",t.Ghana="gh",t.Guinea="gn",t.Gambia="gm",t.GuineaBissau="gw",t.EquatorialGuinea="gq",t.Greece="gr",t.Grenada="gd",t.Guatemala="gt",t.Guyana="gy",t.Honduras="hn",t.Croatia="hr",t.Haiti="ht",t.Hungary="hu",t.Indonesia="id",t.India="in",t.Ireland="ie",t.IranIslamicRepublicOf="ir",t.Iraq="iq",t.Iceland="is",t.Israel="il",t.Italy="it",t.Jamaica="jm",t.Jordan="jo",t.Japan="jp",t.Kazakhstan="kz",t.Kenya="ke",t.Kyrgyzstan="kg",t.Cambodia="kh",t.Kiribati="ki",t.SaintKittsAndNevis="kn",t.SouthKorea="kr",t.Kuwait="kw",t.LaoPeopleSDemocraticRepublic="la",t.Lebanon="lb",t.Liberia="lr",t.Libya="ly",t.SaintLucia="lc",t.Liechtenstein="li",t.SriLanka="lk",t.Lesotho="ls",t.Lithuania="lt",t.Luxembourg="lu",t.Latvia="lv",t.Morocco="ma",t.Monaco="mc",t.Moldova="md",t.Madagascar="mg",t.Maldives="mv",t.Mexico="mx",t.MarshallIslands="mh",t.NorthMacedonia="mk",t.Mali="ml",t.Malta="mt",t.Myanmar="mm",t.Montenegro="me",t.Mongolia="mn",t.Mozambique="mz",t.Mauritania="mr",t.Mauritius="mu",t.Malawi="mw",t.Malaysia="my",t.Namibia="na",t.Niger="ne",t.Nigeria="ng",t.Nicaragua="ni",t.Netherlands="nl",t.Norway="no",t.Nepal="np",t.Nauru="nr",t.NewZealand="nz",t.Oman="om",t.Pakistan="pk",t.Panama="pa",t.Peru="pe",t.Philippines="ph",t.Palau="pw",t.PapuaNewGuinea="pg",t.Poland="pl",t.FrenchPolynesia="pf",t.NorthKorea="kp",t.Portugal="pt",t.Paraguay="py",t.Qatar="qa",t.Romania="ro",t.Russia="ru",t.Rwanda="rw",t.SaudiArabia="sa",t.Sudan="sd",t.Senegal="sn",t.Singapore="sg",t.SolomonIslands="sb",t.SierraLeone="sl",t.ElSalvador="sv",t.SanMarino="sm",t.Somalia="so",t.Serbia="rs",t.SouthSudan="ss",t.SaoTomeAndPrincipe="st",t.Suriname="sr",t.Slovakia="sk",t.Slovenia="si",t.Sweden="se",t.Eswatini="sz",t.Seychelles="sc",t.Syria="sy",t.Chad="td",t.Togo="tg",t.Thailand="th",t.Tajikistan="tj",t.Turkmenistan="tm",t.TimorLeste="tl",t.Tonga="to",t.TrinidadAndTobago="tt",t.Tunisia="tn",t.Turkey="tr",t.Tuvalu="tv",t.Tanzania="tz",t.Uganda="ug",t.Ukraine="ua",t.Uruguay="uy",t.UnitedStates="us",t.Uzbekistan="uz",t.VaticanCity="va",t.SaintVincentAndTheGrenadines="vc",t.Venezuela="ve",t.Vietnam="vn",t.Vanuatu="vu",t.Samoa="ws",t.Yemen="ye",t.SouthAfrica="za",t.Zambia="zm",t.Zimbabwe="zw"})(Qc||(Qc={}));var Jc;(function(t){t.Light="light",t.Dark="dark"})(Jc||(Jc={}));var Kc;(function(t){t.AfricaAbidjan="africa/abidjan",t.AfricaAccra="africa/accra",t.AfricaAddisAbaba="africa/addis_ababa",t.AfricaAlgiers="africa/algiers",t.AfricaAsmara="africa/asmara",t.AfricaBamako="africa/bamako",t.AfricaBangui="africa/bangui",t.AfricaBanjul="africa/banjul",t.AfricaBissau="africa/bissau",t.AfricaBlantyre="africa/blantyre",t.AfricaBrazzaville="africa/brazzaville",t.AfricaBujumbura="africa/bujumbura",t.AfricaCairo="africa/cairo",t.AfricaCasablanca="africa/casablanca",t.AfricaCeuta="africa/ceuta",t.AfricaConakry="africa/conakry",t.AfricaDakar="africa/dakar",t.AfricaDarEsSalaam="africa/dar_es_salaam",t.AfricaDjibouti="africa/djibouti",t.AfricaDouala="africa/douala",t.AfricaElAaiun="africa/el_aaiun",t.AfricaFreetown="africa/freetown",t.AfricaGaborone="africa/gaborone",t.AfricaHarare="africa/harare",t.AfricaJohannesburg="africa/johannesburg",t.AfricaJuba="africa/juba",t.AfricaKampala="africa/kampala",t.AfricaKhartoum="africa/khartoum",t.AfricaKigali="africa/kigali",t.AfricaKinshasa="africa/kinshasa",t.AfricaLagos="africa/lagos",t.AfricaLibreville="africa/libreville",t.AfricaLome="africa/lome",t.AfricaLuanda="africa/luanda",t.AfricaLubumbashi="africa/lubumbashi",t.AfricaLusaka="africa/lusaka",t.AfricaMalabo="africa/malabo",t.AfricaMaputo="africa/maputo",t.AfricaMaseru="africa/maseru",t.AfricaMbabane="africa/mbabane",t.AfricaMogadishu="africa/mogadishu",t.AfricaMonrovia="africa/monrovia",t.AfricaNairobi="africa/nairobi",t.AfricaNdjamena="africa/ndjamena",t.AfricaNiamey="africa/niamey",t.AfricaNouakchott="africa/nouakchott",t.AfricaOuagadougou="africa/ouagadougou",t.AfricaPortonovo="africa/porto-novo",t.AfricaSaoTome="africa/sao_tome",t.AfricaTripoli="africa/tripoli",t.AfricaTunis="africa/tunis",t.AfricaWindhoek="africa/windhoek",t.AmericaAdak="america/adak",t.AmericaAnchorage="america/anchorage",t.AmericaAnguilla="america/anguilla",t.AmericaAntigua="america/antigua",t.AmericaAraguaina="america/araguaina",t.AmericaArgentinaBuenosAires="america/argentina/buenos_aires",t.AmericaArgentinaCatamarca="america/argentina/catamarca",t.AmericaArgentinaCordoba="america/argentina/cordoba",t.AmericaArgentinaJujuy="america/argentina/jujuy",t.AmericaArgentinaLaRioja="america/argentina/la_rioja",t.AmericaArgentinaMendoza="america/argentina/mendoza",t.AmericaArgentinaRioGallegos="america/argentina/rio_gallegos",t.AmericaArgentinaSalta="america/argentina/salta",t.AmericaArgentinaSanJuan="america/argentina/san_juan",t.AmericaArgentinaSanLuis="america/argentina/san_luis",t.AmericaArgentinaTucuman="america/argentina/tucuman",t.AmericaArgentinaUshuaia="america/argentina/ushuaia",t.AmericaAruba="america/aruba",t.AmericaAsuncion="america/asuncion",t.AmericaAtikokan="america/atikokan",t.AmericaBahia="america/bahia",t.AmericaBahiaBanderas="america/bahia_banderas",t.AmericaBarbados="america/barbados",t.AmericaBelem="america/belem",t.AmericaBelize="america/belize",t.AmericaBlancsablon="america/blanc-sablon",t.AmericaBoaVista="america/boa_vista",t.AmericaBogota="america/bogota",t.AmericaBoise="america/boise",t.AmericaCambridgeBay="america/cambridge_bay",t.AmericaCampoGrande="america/campo_grande",t.AmericaCancun="america/cancun",t.AmericaCaracas="america/caracas",t.AmericaCayenne="america/cayenne",t.AmericaCayman="america/cayman",t.AmericaChicago="america/chicago",t.AmericaChihuahua="america/chihuahua",t.AmericaCiudadJuarez="america/ciudad_juarez",t.AmericaCostaRica="america/costa_rica",t.AmericaCoyhaique="america/coyhaique",t.AmericaCreston="america/creston",t.AmericaCuiaba="america/cuiaba",t.AmericaCuracao="america/curacao",t.AmericaDanmarkshavn="america/danmarkshavn",t.AmericaDawson="america/dawson",t.AmericaDawsonCreek="america/dawson_creek",t.AmericaDenver="america/denver",t.AmericaDetroit="america/detroit",t.AmericaDominica="america/dominica",t.AmericaEdmonton="america/edmonton",t.AmericaEirunepe="america/eirunepe",t.AmericaElSalvador="america/el_salvador",t.AmericaFortNelson="america/fort_nelson",t.AmericaFortaleza="america/fortaleza",t.AmericaGlaceBay="america/glace_bay",t.AmericaGooseBay="america/goose_bay",t.AmericaGrandTurk="america/grand_turk",t.AmericaGrenada="america/grenada",t.AmericaGuadeloupe="america/guadeloupe",t.AmericaGuatemala="america/guatemala",t.AmericaGuayaquil="america/guayaquil",t.AmericaGuyana="america/guyana",t.AmericaHalifax="america/halifax",t.AmericaHavana="america/havana",t.AmericaHermosillo="america/hermosillo",t.AmericaIndianaIndianapolis="america/indiana/indianapolis",t.AmericaIndianaKnox="america/indiana/knox",t.AmericaIndianaMarengo="america/indiana/marengo",t.AmericaIndianaPetersburg="america/indiana/petersburg",t.AmericaIndianaTellCity="america/indiana/tell_city",t.AmericaIndianaVevay="america/indiana/vevay",t.AmericaIndianaVincennes="america/indiana/vincennes",t.AmericaIndianaWinamac="america/indiana/winamac",t.AmericaInuvik="america/inuvik",t.AmericaIqaluit="america/iqaluit",t.AmericaJamaica="america/jamaica",t.AmericaJuneau="america/juneau",t.AmericaKentuckyLouisville="america/kentucky/louisville",t.AmericaKentuckyMonticello="america/kentucky/monticello",t.AmericaKralendijk="america/kralendijk",t.AmericaLaPaz="america/la_paz",t.AmericaLima="america/lima",t.AmericaLosAngeles="america/los_angeles",t.AmericaLowerPrinces="america/lower_princes",t.AmericaMaceio="america/maceio",t.AmericaManagua="america/managua",t.AmericaManaus="america/manaus",t.AmericaMarigot="america/marigot",t.AmericaMartinique="america/martinique",t.AmericaMatamoros="america/matamoros",t.AmericaMazatlan="america/mazatlan",t.AmericaMenominee="america/menominee",t.AmericaMerida="america/merida",t.AmericaMetlakatla="america/metlakatla",t.AmericaMexicoCity="america/mexico_city",t.AmericaMiquelon="america/miquelon",t.AmericaMoncton="america/moncton",t.AmericaMonterrey="america/monterrey",t.AmericaMontevideo="america/montevideo",t.AmericaMontserrat="america/montserrat",t.AmericaNassau="america/nassau",t.AmericaNewYork="america/new_york",t.AmericaNome="america/nome",t.AmericaNoronha="america/noronha",t.AmericaNorthDakotaBeulah="america/north_dakota/beulah",t.AmericaNorthDakotaCenter="america/north_dakota/center",t.AmericaNorthDakotaNewSalem="america/north_dakota/new_salem",t.AmericaNuuk="america/nuuk",t.AmericaOjinaga="america/ojinaga",t.AmericaPanama="america/panama",t.AmericaParamaribo="america/paramaribo",t.AmericaPhoenix="america/phoenix",t.AmericaPortauprince="america/port-au-prince",t.AmericaPortOfSpain="america/port_of_spain",t.AmericaPortoVelho="america/porto_velho",t.AmericaPuertoRico="america/puerto_rico",t.AmericaPuntaArenas="america/punta_arenas",t.AmericaRankinInlet="america/rankin_inlet",t.AmericaRecife="america/recife",t.AmericaRegina="america/regina",t.AmericaResolute="america/resolute",t.AmericaRioBranco="america/rio_branco",t.AmericaSantarem="america/santarem",t.AmericaSantiago="america/santiago",t.AmericaSantoDomingo="america/santo_domingo",t.AmericaSaoPaulo="america/sao_paulo",t.AmericaScoresbysund="america/scoresbysund",t.AmericaSitka="america/sitka",t.AmericaStBarthelemy="america/st_barthelemy",t.AmericaStJohns="america/st_johns",t.AmericaStKitts="america/st_kitts",t.AmericaStLucia="america/st_lucia",t.AmericaStThomas="america/st_thomas",t.AmericaStVincent="america/st_vincent",t.AmericaSwiftCurrent="america/swift_current",t.AmericaTegucigalpa="america/tegucigalpa",t.AmericaThule="america/thule",t.AmericaTijuana="america/tijuana",t.AmericaToronto="america/toronto",t.AmericaTortola="america/tortola",t.AmericaVancouver="america/vancouver",t.AmericaWhitehorse="america/whitehorse",t.AmericaWinnipeg="america/winnipeg",t.AmericaYakutat="america/yakutat",t.AntarcticaCasey="antarctica/casey",t.AntarcticaDavis="antarctica/davis",t.AntarcticaDumontdurville="antarctica/dumontdurville",t.AntarcticaMacquarie="antarctica/macquarie",t.AntarcticaMawson="antarctica/mawson",t.AntarcticaMcmurdo="antarctica/mcmurdo",t.AntarcticaPalmer="antarctica/palmer",t.AntarcticaRothera="antarctica/rothera",t.AntarcticaSyowa="antarctica/syowa",t.AntarcticaTroll="antarctica/troll",t.AntarcticaVostok="antarctica/vostok",t.ArcticLongyearbyen="arctic/longyearbyen",t.AsiaAden="asia/aden",t.AsiaAlmaty="asia/almaty",t.AsiaAmman="asia/amman",t.AsiaAnadyr="asia/anadyr",t.AsiaAqtau="asia/aqtau",t.AsiaAqtobe="asia/aqtobe",t.AsiaAshgabat="asia/ashgabat",t.AsiaAtyrau="asia/atyrau",t.AsiaBaghdad="asia/baghdad",t.AsiaBahrain="asia/bahrain",t.AsiaBaku="asia/baku",t.AsiaBangkok="asia/bangkok",t.AsiaBarnaul="asia/barnaul",t.AsiaBeirut="asia/beirut",t.AsiaBishkek="asia/bishkek",t.AsiaBrunei="asia/brunei",t.AsiaChita="asia/chita",t.AsiaColombo="asia/colombo",t.AsiaDamascus="asia/damascus",t.AsiaDhaka="asia/dhaka",t.AsiaDili="asia/dili",t.AsiaDubai="asia/dubai",t.AsiaDushanbe="asia/dushanbe",t.AsiaFamagusta="asia/famagusta",t.AsiaGaza="asia/gaza",t.AsiaHebron="asia/hebron",t.AsiaHoChiMinh="asia/ho_chi_minh",t.AsiaHongKong="asia/hong_kong",t.AsiaHovd="asia/hovd",t.AsiaIrkutsk="asia/irkutsk",t.AsiaJakarta="asia/jakarta",t.AsiaJayapura="asia/jayapura",t.AsiaJerusalem="asia/jerusalem",t.AsiaKabul="asia/kabul",t.AsiaKamchatka="asia/kamchatka",t.AsiaKarachi="asia/karachi",t.AsiaKathmandu="asia/kathmandu",t.AsiaKhandyga="asia/khandyga",t.AsiaKolkata="asia/kolkata",t.AsiaKrasnoyarsk="asia/krasnoyarsk",t.AsiaKualaLumpur="asia/kuala_lumpur",t.AsiaKuching="asia/kuching",t.AsiaKuwait="asia/kuwait",t.AsiaMacau="asia/macau",t.AsiaMagadan="asia/magadan",t.AsiaMakassar="asia/makassar",t.AsiaManila="asia/manila",t.AsiaMuscat="asia/muscat",t.AsiaNicosia="asia/nicosia",t.AsiaNovokuznetsk="asia/novokuznetsk",t.AsiaNovosibirsk="asia/novosibirsk",t.AsiaOmsk="asia/omsk",t.AsiaOral="asia/oral",t.AsiaPhnomPenh="asia/phnom_penh",t.AsiaPontianak="asia/pontianak",t.AsiaPyongyang="asia/pyongyang",t.AsiaQatar="asia/qatar",t.AsiaQostanay="asia/qostanay",t.AsiaQyzylorda="asia/qyzylorda",t.AsiaRiyadh="asia/riyadh",t.AsiaSakhalin="asia/sakhalin",t.AsiaSamarkand="asia/samarkand",t.AsiaSeoul="asia/seoul",t.AsiaShanghai="asia/shanghai",t.AsiaSingapore="asia/singapore",t.AsiaSrednekolymsk="asia/srednekolymsk",t.AsiaTaipei="asia/taipei",t.AsiaTashkent="asia/tashkent",t.AsiaTbilisi="asia/tbilisi",t.AsiaTehran="asia/tehran",t.AsiaThimphu="asia/thimphu",t.AsiaTokyo="asia/tokyo",t.AsiaTomsk="asia/tomsk",t.AsiaUlaanbaatar="asia/ulaanbaatar",t.AsiaUrumqi="asia/urumqi",t.AsiaUstnera="asia/ust-nera",t.AsiaVientiane="asia/vientiane",t.AsiaVladivostok="asia/vladivostok",t.AsiaYakutsk="asia/yakutsk",t.AsiaYangon="asia/yangon",t.AsiaYekaterinburg="asia/yekaterinburg",t.AsiaYerevan="asia/yerevan",t.AtlanticAzores="atlantic/azores",t.AtlanticBermuda="atlantic/bermuda",t.AtlanticCanary="atlantic/canary",t.AtlanticCapeVerde="atlantic/cape_verde",t.AtlanticFaroe="atlantic/faroe",t.AtlanticMadeira="atlantic/madeira",t.AtlanticReykjavik="atlantic/reykjavik",t.AtlanticSouthGeorgia="atlantic/south_georgia",t.AtlanticStHelena="atlantic/st_helena",t.AtlanticStanley="atlantic/stanley",t.AustraliaAdelaide="australia/adelaide",t.AustraliaBrisbane="australia/brisbane",t.AustraliaBrokenHill="australia/broken_hill",t.AustraliaDarwin="australia/darwin",t.AustraliaEucla="australia/eucla",t.AustraliaHobart="australia/hobart",t.AustraliaLindeman="australia/lindeman",t.AustraliaLordHowe="australia/lord_howe",t.AustraliaMelbourne="australia/melbourne",t.AustraliaPerth="australia/perth",t.AustraliaSydney="australia/sydney",t.EuropeAmsterdam="europe/amsterdam",t.EuropeAndorra="europe/andorra",t.EuropeAstrakhan="europe/astrakhan",t.EuropeAthens="europe/athens",t.EuropeBelgrade="europe/belgrade",t.EuropeBerlin="europe/berlin",t.EuropeBratislava="europe/bratislava",t.EuropeBrussels="europe/brussels",t.EuropeBucharest="europe/bucharest",t.EuropeBudapest="europe/budapest",t.EuropeBusingen="europe/busingen",t.EuropeChisinau="europe/chisinau",t.EuropeCopenhagen="europe/copenhagen",t.EuropeDublin="europe/dublin",t.EuropeGibraltar="europe/gibraltar",t.EuropeGuernsey="europe/guernsey",t.EuropeHelsinki="europe/helsinki",t.EuropeIsleOfMan="europe/isle_of_man",t.EuropeIstanbul="europe/istanbul",t.EuropeJersey="europe/jersey",t.EuropeKaliningrad="europe/kaliningrad",t.EuropeKirov="europe/kirov",t.EuropeKyiv="europe/kyiv",t.EuropeLisbon="europe/lisbon",t.EuropeLjubljana="europe/ljubljana",t.EuropeLondon="europe/london",t.EuropeLuxembourg="europe/luxembourg",t.EuropeMadrid="europe/madrid",t.EuropeMalta="europe/malta",t.EuropeMariehamn="europe/mariehamn",t.EuropeMinsk="europe/minsk",t.EuropeMonaco="europe/monaco",t.EuropeMoscow="europe/moscow",t.EuropeOslo="europe/oslo",t.EuropeParis="europe/paris",t.EuropePodgorica="europe/podgorica",t.EuropePrague="europe/prague",t.EuropeRiga="europe/riga",t.EuropeRome="europe/rome",t.EuropeSamara="europe/samara",t.EuropeSanMarino="europe/san_marino",t.EuropeSarajevo="europe/sarajevo",t.EuropeSaratov="europe/saratov",t.EuropeSimferopol="europe/simferopol",t.EuropeSkopje="europe/skopje",t.EuropeSofia="europe/sofia",t.EuropeStockholm="europe/stockholm",t.EuropeTallinn="europe/tallinn",t.EuropeTirane="europe/tirane",t.EuropeUlyanovsk="europe/ulyanovsk",t.EuropeVaduz="europe/vaduz",t.EuropeVatican="europe/vatican",t.EuropeVienna="europe/vienna",t.EuropeVilnius="europe/vilnius",t.EuropeVolgograd="europe/volgograd",t.EuropeWarsaw="europe/warsaw",t.EuropeZagreb="europe/zagreb",t.EuropeZurich="europe/zurich",t.IndianAntananarivo="indian/antananarivo",t.IndianChagos="indian/chagos",t.IndianChristmas="indian/christmas",t.IndianCocos="indian/cocos",t.IndianComoro="indian/comoro",t.IndianKerguelen="indian/kerguelen",t.IndianMahe="indian/mahe",t.IndianMaldives="indian/maldives",t.IndianMauritius="indian/mauritius",t.IndianMayotte="indian/mayotte",t.IndianReunion="indian/reunion",t.PacificApia="pacific/apia",t.PacificAuckland="pacific/auckland",t.PacificBougainville="pacific/bougainville",t.PacificChatham="pacific/chatham",t.PacificChuuk="pacific/chuuk",t.PacificEaster="pacific/easter",t.PacificEfate="pacific/efate",t.PacificFakaofo="pacific/fakaofo",t.PacificFiji="pacific/fiji",t.PacificFunafuti="pacific/funafuti",t.PacificGalapagos="pacific/galapagos",t.PacificGambier="pacific/gambier",t.PacificGuadalcanal="pacific/guadalcanal",t.PacificGuam="pacific/guam",t.PacificHonolulu="pacific/honolulu",t.PacificKanton="pacific/kanton",t.PacificKiritimati="pacific/kiritimati",t.PacificKosrae="pacific/kosrae",t.PacificKwajalein="pacific/kwajalein",t.PacificMajuro="pacific/majuro",t.PacificMarquesas="pacific/marquesas",t.PacificMidway="pacific/midway",t.PacificNauru="pacific/nauru",t.PacificNiue="pacific/niue",t.PacificNorfolk="pacific/norfolk",t.PacificNoumea="pacific/noumea",t.PacificPagoPago="pacific/pago_pago",t.PacificPalau="pacific/palau",t.PacificPitcairn="pacific/pitcairn",t.PacificPohnpei="pacific/pohnpei",t.PacificPortMoresby="pacific/port_moresby",t.PacificRarotonga="pacific/rarotonga",t.PacificSaipan="pacific/saipan",t.PacificTahiti="pacific/tahiti",t.PacificTarawa="pacific/tarawa",t.PacificTongatapu="pacific/tongatapu",t.PacificWake="pacific/wake",t.PacificWallis="pacific/wallis",t.Utc="utc"})(Kc||(Kc={}));var Yc;(function(t){t.Jpg="jpg",t.Jpeg="jpeg",t.Png="png",t.Webp="webp",t.Heic="heic",t.Avif="avif",t.Gif="gif"})(Yc||(Yc={}));var _n;(function(t){t.GET="GET",t.POST="POST",t.PUT="PUT",t.PATCH="PATCH",t.DELETE="DELETE",t.OPTIONS="OPTIONS",t.HEAD="HEAD"})(_n||(_n={}));var Xc;(function(t){t.Center="center",t.Topleft="top-left",t.Top="top",t.Topright="top-right",t.Left="left",t.Right="right",t.Bottomleft="bottom-left",t.Bottom="bottom",t.Bottomright="bottom-right"})(Xc||(Xc={}));var Zc;(function(t){t.Jpg="jpg",t.Jpeg="jpeg",t.Png="png",t.Webp="webp",t.Heic="heic",t.Avif="avif",t.Gif="gif"})(Zc||(Zc={}));var zc;(function(t){t.Http="http",t.Schedule="schedule",t.Event="event"})(zc||(zc={}));var Fc;(function(t){t.Waiting="waiting",t.Processing="processing",t.Completed="completed",t.Failed="failed",t.Scheduled="scheduled"})(Fc||(Fc={}));const at={endpoint:"https://aw.oupla.net/v1",projectId:"696b7acb0037bde79e3f",databaseId:"689d15b10003a5a13636",functions:{batchUpdate:"68f00487000c624533a3",usersTeamsManager:"692cb2cd000cbb24549c",enkaData:"68f00487000c624533a3",invitation:"6984cf4100311dcd7dd2"},collections:{events:"main",ingredients:"ingredients",main:"main",purchases:"purchases",products:"products",kteams:"kteams",locks:"locks",user_notifications:"user_notifications",materiel_loan:"materiel_loan",teamdocs:"teamdocs"}};let Or=null;async function D(){if(Or)return Or;console.log("[appwrite] Initialisation des instances Appwrite...");const t=new zt().setEndpoint(at.endpoint).setProject(at.projectId),e=new _p(t),r=new Rp(t),s=new Dp(t),n=new Pp(t),a=new Mp(t);return Or={client:t,account:e,databases:r,tables:s,functions:n,teams:a,config:at},console.log("[appwrite] Instances initialisÃ©es avec succÃ¨s"),Or}function ju(){console.log("[appwrite] Cache rÃ©initialisÃ©"),Or=null}function bs(){return{APPWRITE_ENDPOINT:at.endpoint,APPWRITE_PROJECT_ID:at.projectId,APPWRITE_DATABASE_ID:at.databaseId,APPWRITE_FUNCTION_ID:at.functions.batchUpdate,ACCESS_REQUEST_FUNCTION_ID:at.functions.accessRequest,MANAGE_RECIPE_FUNCTION_ID:at.functions.enkaData,APPWRITE_CONFIG:at}}async function $p(t,e){Or||(console.log("[appwrite] Subscribe appelÃ© avant initialisation, initialisation forcÃ©e..."),await D());const r=Array.isArray(t)?t:[t];return console.log("[appwrite] Subscribe aux channels:",r),Or.client.subscribe(t,n=>{n.event==="client.connected"&&console.log("[appwrite] â WebSocket connectÃ© avec succÃ¨s"),e(n)})}function kp(){return Or!==null}function dt(){return at.databaseId}function vr(t){return at.collections[t]}function qu(t){return at.functions[t]}const By=Object.freeze(Object.defineProperty({__proto__:null,clearAppwriteCache:ju,getAppwriteConfig:bs,getAppwriteInstances:D,getCollectionId:vr,getDatabaseId:dt,getFunctionId:qu,isInitialized:kp,subscribe:$p},Symbol.toStringTag,{value:"Module"}));let Cp=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,r)=>(r&=63,r<36?e+=r.toString(36):r<62?e+=(r-26).toString(36).toUpperCase():r>62?e+="-":e+="_",e),"");function Tp(t,e){const r=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),s=e?e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""):"";let n;if(s){const a=r.slice(0,16),o=s.slice(0,5);n=`${a}-${o}`}else n=r.slice(0,22);return`${n}_${Cp(12).toLowerCase()}`}const Np=new Pu(()=>window.scrollY,t=>Fs(window,"scroll",t)),Lp={loading:0,success:2e3,info:3e3,warning:5e3,error:5e3},jp=2;var fe,ys,Ou,ho;class qp{constructor(){y(this,ys);y(this,fe,P(ge([])));T(this,"MAX_TOASTS",3)}get toasts(){return[...f(i(this,fe))].sort((e,r)=>r.timestamp-e.timestamp)}create(e){const r=e.id||crypto.randomUUID(),s={id:r,state:e.state,message:e.message,timestamp:Date.now(),source:e.source||"user",position:e.position,timeoutId:void 0,autoCloseDelay:e.autoCloseDelay,details:e.details,actions:e.actions||[]};return b(this,ys,Ou).call(this,s),r}update(e,r){const s=f(i(this,fe)).findIndex(a=>a.id===e);if(s===-1)return;const n=f(i(this,fe))[s];n.timeoutId&&clearTimeout(n.timeoutId),n.loadingTimeoutId&&clearTimeout(n.loadingTimeoutId),f(i(this,fe))[s]={...n,state:r.state||n.state,message:r.message||n.message,source:r.source||n.source,position:r.position||n.position,actions:r.actions||n.actions,autoCloseDelay:r.autoCloseDelay!==void 0?r.autoCloseDelay:n.autoCloseDelay,loadingTimeoutId:void 0},b(this,ys,ho).call(this,f(i(this,fe))[s])}async track(e,r){const s=this.create({id:r.id,state:"loading",message:r.loading,source:"user",position:r.position});try{const n=await e;return this.update(s,{state:"success",message:r.success||"OpÃ©ration rÃ©ussie",autoCloseDelay:r.successDelay}),n}catch(n){throw this.update(s,{state:"error",message:r.error||"Erreur lors de l'opÃ©ration",autoCloseDelay:r.errorDelay}),n}}dismiss(e){const r=f(i(this,fe)).findIndex(n=>n.id===e);if(r===-1)return;const s=f(i(this,fe))[r];s.timeoutId&&clearTimeout(s.timeoutId),s.loadingTimeoutId&&clearTimeout(s.loadingTimeoutId),f(i(this,fe)).splice(r,1)}dismissAll(){f(i(this,fe)).forEach(e=>{e.timeoutId&&clearTimeout(e.timeoutId),e.loadingTimeoutId&&clearTimeout(e.loadingTimeoutId)}),m(i(this,fe),[],!0)}success(e,r){return this.create({state:"success",message:e,details:r?.details,autoCloseDelay:r?.autoCloseDelay,position:r?.position})}error(e,r){return this.create({state:"error",message:e,details:r?.details,autoCloseDelay:r?.autoCloseDelay,position:r?.position})}warning(e,r){return this.create({state:"warning",message:e,source:r?.source||"system",details:r?.details,actions:r?.actions,autoCloseDelay:r?.autoCloseDelay,position:r?.position})}info(e,r){return this.create({state:"info",message:e,source:r?.source||"system",details:r?.details,autoCloseDelay:r?.autoCloseDelay,position:r?.position})}loading(e,r){const n=r?.autoCloseDelay??3e4,a=this.create({state:"loading",message:e,details:r?.details,autoCloseDelay:n,position:r?.position}),o=setTimeout(()=>{this.update(a,{state:"warning",message:"Ãchec, temps expirÃ©",autoCloseDelay:2e3})},n-2e3),c=f(i(this,fe)).findIndex(l=>l.id===a);return c!==-1&&(f(i(this,fe))[c].loadingTimeoutId=o),a}}fe=new WeakMap,ys=new WeakSet,Ou=function(e){const r=f(i(this,fe)).findIndex(s=>s.source===e.source);if(r>=0){const s=f(i(this,fe))[r];s.timeoutId&&clearTimeout(s.timeoutId),f(i(this,fe))[r]=e}else if(f(i(this,fe)).length<this.MAX_TOASTS)f(i(this,fe)).push(e);else{const s=f(i(this,fe))[0];s.timeoutId&&clearTimeout(s.timeoutId),f(i(this,fe)).shift(),f(i(this,fe)).push(e)}b(this,ys,ho).call(this,e)},ho=function(e){e.timeoutId&&clearTimeout(e.timeoutId);let r;if(e.autoCloseDelay!==void 0)r=e.autoCloseDelay===0?void 0:e.autoCloseDelay;else{const s=Lp[e.state];e.source==="realtime-other"&&s>0?r=s*jp:r=s===0?void 0:s}r!==void 0&&(e.timeoutId=setTimeout(()=>{this.dismiss(e.id)},r))};const Ke=new qp;async function Op(){const{teams:t}=await D();return await t.list()}async function Up(t){const{teams:e}=await D();return await e.get({teamId:t})}async function Bp(t){const{teams:e}=await D();return await e.create({teamId:yt.unique(),name:t})}async function xp(t,e){const{teams:r}=await D();return await r.updateName({teamId:t,name:e})}async function Hp(t){const{teams:e}=await D();await e.delete({teamId:t})}async function Vp(t){const{teams:e}=await D();return await e.listMemberships({teamId:t})}async function Wp(t,e){const{teams:r}=await D();await r.deleteMembership({teamId:t,membershipId:e})}async function Gp(t,e,r){const{functions:s}=await D(),n=qu("usersTeamsManager"),a={action:"native-invite",teamId:t,emails:e,message:r},o=await s.createExecution({functionId:n,body:JSON.stringify(a)});if(o.status!=="completed")throw new Error(`Erreur lors de l'invitation : ${o.errors}`);return JSON.parse(o.responseBody)}async function el(t,e){const{teams:r}=await D();return await r.updatePrefs({teamId:t,prefs:e})}async function Qp(t,e,r){const{teams:s}=await D();return await s.updateMembership({teamId:t,membershipId:e,roles:r})}var Lt,os,jt,Ei,Uu;class Jp{constructor(){y(this,Ei);y(this,Lt,[]);y(this,os,null);y(this,jt,!1)}register(e,r){i(this,jt)&&console.warn("[RealtimeManager] Enregistrement aprÃ¨s initialisation. Utilisez registerDynamic() pour les inscriptions dynamiques."),i(this,Lt).push({channels:e,callback:r}),console.log("[RealtimeManager] Channels enregistrÃ©s:",e)}registerDynamic(e,r){return i(this,Lt).push({channels:e,callback:r}),console.log("[RealtimeManager] Channels dynamiques enregistrÃ©s:",e),i(this,jt)&&b(this,Ei,Uu).call(this,e,r),()=>{const s=i(this,Lt).findIndex(n=>n.channels===e&&n.callback===r);s!==-1&&(i(this,Lt).splice(s,1),console.log("[RealtimeManager] Channels dynamiques dÃ©senregistrÃ©s:",e))}}async initialize(){if(i(this,jt))return;const e=[...new Set(i(this,Lt).flatMap(r=>r.channels))];if(e.length===0){console.log("[RealtimeManager] Aucun channel Ã  souscrire."),I(this,jt,!0);return}try{console.log(`[RealtimeManager] Initialisation de la connexion unique avec ${e.length} channels...`);const{client:r}=await D();I(this,os,r.subscribe(e,s=>{for(const n of i(this,Lt))s.channels.some(o=>n.channels.includes(o))&&n.callback(s)})),I(this,jt,!0),console.log("[RealtimeManager] â Connexion Realtime Ã©tablie.")}catch(r){throw console.error("[RealtimeManager] Erreur lors de l'initialisation:",r),r}}destroy(){i(this,os)&&(i(this,os).call(this),I(this,os,null)),I(this,Lt,[]),I(this,jt,!1),console.log("[RealtimeManager] Connexion Realtime fermÃ©e.")}get isInitialized(){return i(this,jt)}}Lt=new WeakMap,os=new WeakMap,jt=new WeakMap,Ei=new WeakSet,Uu=async function(e,r){try{console.log(`[RealtimeManager] Ajout de ${e.length} channels Ã  la connexion existante...`);const{client:s}=await D();s.subscribe(e,n=>{r(n)}),console.log("[RealtimeManager] â Channels dynamiques ajoutÃ©s:",e)}catch(s){console.error("[RealtimeManager] Erreur lors de l'ajout de channels dynamiques:",s)}};const be=new Jp;var He,Sr,cs,nr,Ir,Ln,Hr,Ja,Bu;class Kp{constructor(){y(this,Hr);y(this,He,new gt);y(this,Sr,P(!1));y(this,cs,P(null));y(this,nr,P(!1));y(this,Ir,!1);y(this,Ln,z(()=>Array.from(i(this,He).values())))}get loading(){return f(i(this,Sr))}get error(){return f(i(this,cs))}get isInitialized(){return f(i(this,nr))}get count(){return i(this,He).size}get teams(){return f(i(this,Ln))}isUserInAnyTeam(e){return Array.from(i(this,He).values()).some(r=>r.members?.some(s=>s.id===e))}get myTeams(){return k.userId?f(i(this,Ln)):[]}async loadCache(){if(!f(i(this,nr))){if(!k.userId){m(i(this,nr),!0);return}m(i(this,nr),!0),console.log("[NativeTeamsStore] Cache chargÃ© : 0 Ã©quipes (pas de cache)")}}async syncFromRemote(){m(i(this,Sr),!0),m(i(this,cs),null);try{if(!k.userId)return;await b(this,Hr,Ja).call(this),console.log(`[NativeTeamsStore] Sync terminÃ© : ${i(this,He).size} Ã©quipes`)}catch(e){throw m(i(this,cs),e instanceof Error?e.message:"Erreur de synchronisation",!0),console.error("[NativeTeamsStore] SyncFromRemote error:",e),e}finally{m(i(this,Sr),!1)}}async setupRealtime(){if(k.isAuthenticated){if(i(this,Ir)&&be.isInitialized){console.log("[NativeTeamsStore] Realtime dÃ©jÃ  configurÃ©");return}i(this,Ir)&&!be.isInitialized&&(console.log("[NativeTeamsStore] RealtimeManager dÃ©truit, rÃ©initialisation..."),I(this,Ir,!1));try{await b(this,Hr,Bu).call(this),I(this,Ir,!0),console.log("[NativeTeamsStore] Realtime configurÃ©")}catch(e){throw m(i(this,cs),e instanceof Error?e.message:"Erreur de configuration realtime",!0),console.error("[NativeTeamsStore] SetupRealtime error:",e),e}}}async initialize(){await this.loadCache(),await this.syncFromRemote(),await this.setupRealtime()}async hardReset(){console.log("[NativeTeamsStore] Hard reset..."),i(this,He).clear(),m(i(this,nr),!1),await this.initialize(),console.log("[NativeTeamsStore] Hard reset terminÃ©")}getTeamById(e){return i(this,He).get(e)}getTeamMemberNames(e){const r=i(this,He).get(e);return!r||!r.members?[]:r.members.map(s=>s.name?s.name:s.userEmail?s.userEmail.split("@")[0]:"Inconnu").filter(Boolean)}async fetchTeam(e){try{const r=await Up(e),s=await Vp(e),n={$id:r.$id,name:r.name,total:r.total,$createdAt:r.$createdAt,$updatedAt:r.$updatedAt,prefs:r.prefs,members:s.memberships.map(a=>({$id:a.$id,id:a.userId,name:a.userName,userEmail:a.userEmail,roles:a.roles,joinedAt:a.joined,confirmed:a.confirm}))};return i(this,He).set(e,n),n}catch(r){return console.error(`[NativeTeamsStore] Error fetching team ${e}:`,r),null}}async createTeam(e,r){const s=await Bp(e);r&&Object.keys(r).length>0&&await el(s.$id,r);const n=await this.fetchTeam(s.$id);if(!n)throw new Error("Erreur aprÃ¨s crÃ©ation d'Ã©quipe");return n}async updateTeam(e,r,s){r&&await xp(e,r),s&&Object.keys(s).length>0&&await el(e,s),await this.fetchTeam(e)}async deleteTeam(e){await Hp(e),i(this,He).delete(e)}async inviteTeamMember(e,r,s){await Gp(e,r,s),await this.fetchTeam(e)}async removeMember(e,r){await Wp(e,r),await this.fetchTeam(e)}async updateMemberRole(e,r,s){await Qp(e,r,[s]),await this.fetchTeam(e)}async reload(){m(i(this,Sr),!0);try{i(this,He).clear(),await b(this,Hr,Ja).call(this)}finally{m(i(this,Sr),!1)}}destroy(){i(this,He).clear(),m(i(this,nr),!1),I(this,Ir,!1)}}He=new WeakMap,Sr=new WeakMap,cs=new WeakMap,nr=new WeakMap,Ir=new WeakMap,Ln=new WeakMap,Hr=new WeakSet,Ja=async function(){const e=await Op();for(const r of e.teams)await this.fetchTeam(r.$id)},Bu=async function(){be.register(["teams","memberships"],async e=>{console.log("[NativeTeamsStore] â¡ï¸ Realtime RECEIVED:",e.events),await b(this,Hr,Ja).call(this)})};const vt=new Kp;function xy(t){return{materiel:[...t.materiel],categories:[...t.categories],regimes:[...t.regimes]}}function di(t){if(t==null||typeof t!="object")return t;if(Array.isArray(t))return t.map(r=>di(r));const e={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=di(t[r]));return e}const xu="demo-rassemblement-festif";function ae(t){return t===xu}const Yp={name:"Rassemblement festif",description:"Exemple d'Ã©vÃ©nement sur plusieurs jours, avec plein de recettes...",durationDays:5,meals:[{recipes:[{recipeUuid:"taboule-libanais_izh9n9l14w66",plates:300,typeR:"entree",hasOwnPlatesNb:!1},{recipeUuid:"mafe-vegetarien-et-riz_ij8i8degl1r6",plates:300,typeR:"plat",hasOwnPlatesNb:!1},{recipeUuid:"houmous-pois-chiche_dw7yaqdlvjg9",plates:50,typeR:"entree",hasOwnPlatesNb:!1},{recipeUuid:"banoffee-vegan-et-sans_2h83u0xlel3u",plates:300,typeR:"dessert",hasOwnPlatesNb:!1}],guests:300,dayOffset:0,time:"12:00"},{recipes:[{recipeUuid:"salade-thai-aux-nouill_qv7cxgmhdwiy",plates:250,typeR:"entree",hasOwnPlatesNb:!0},{recipeUuid:"falafel_n9qzdiwbz4dp",plates:250,typeR:"plat",hasOwnPlatesNb:!0},{recipeUuid:"tourte-betterave-lenti_c54ri2ggbvt2",plates:30,typeR:"entree",hasOwnPlatesNb:!0},{recipeUuid:"cheesecake-vegan-citro_lmvlf0ryne1v",plates:250,typeR:"dessert",hasOwnPlatesNb:!0}],guests:250,dayOffset:0,time:"19:30"},{recipes:[{recipeUuid:"houmous-de-betterave-a_7c1hbo8nci50",plates:280,typeR:"entree",hasOwnPlatesNb:!1},{recipeUuid:"risotto-sarrasin-torre_0ay8dp7smyrw",plates:280,typeR:"plat",hasOwnPlatesNb:!1},{recipeUuid:"blanquette-de-soja-tex_1oq9igtwzpr2",plates:40,typeR:"plat",hasOwnPlatesNb:!0},{recipeUuid:"panna-cotta-vegan-vani_kytwplnialyp",plates:280,typeR:"dessert",hasOwnPlatesNb:!1}],guests:280,dayOffset:1,time:"12:00"},{recipes:[{recipeUuid:"taboule-libanais-quino_0zgww2rc17i3",plates:300,typeR:"entree",hasOwnPlatesNb:!1},{recipeUuid:"curry-veg_xnkksxn0t76q",plates:300,typeR:"plat",hasOwnPlatesNb:!1},{recipeUuid:"escalope-de-seitan_ly3x5wxnq3ve",plates:40,typeR:"plat",hasOwnPlatesNb:!0},{recipeUuid:"abricots-poches-vervei_izz7yef86m3j",plates:300,typeR:"dessert",hasOwnPlatesNb:!1}],guests:300,dayOffset:1,time:"19:30"},{recipes:[{recipeUuid:"taboule-libanais_izh9n9l14w66",plates:200,typeR:"entree",hasOwnPlatesNb:!0},{recipeUuid:"loubia_5m8okqsbqk66",plates:200,typeR:"plat",hasOwnPlatesNb:!0},{recipeUuid:"pastilla-vegan-a-laube_do1dg0nokwpd",plates:25,typeR:"plat",hasOwnPlatesNb:!0},{recipeUuid:"lassi-vegan-a-la-mangu_szk3bdykgyra",plates:200,typeR:"dessert",hasOwnPlatesNb:!0}],guests:200,dayOffset:2,time:"12:00"},{recipes:[{recipeUuid:"tartinade-de-pois-cass_tgpoyg0cm317",plates:280,typeR:"autre",hasOwnPlatesNb:!1},{recipeUuid:"champignons-frits-et-s_j71g5m5afdob",plates:280,typeR:"plat",hasOwnPlatesNb:!1},{recipeUuid:"steak-vegetarien-champ_g288g77vujzb",plates:45,typeR:"plat",hasOwnPlatesNb:!0},{recipeUuid:"tarte-au-citron-vegane_mw6a5i2da5hf",plates:280,typeR:"dessert",hasOwnPlatesNb:!1}],guests:280,dayOffset:2,time:"19:30"},{recipes:[{recipeUuid:"soupe-froide-de-courge_nm0vvoqx6bbh",plates:300,typeR:"entree",hasOwnPlatesNb:!1},{recipeUuid:"couscous-dautomne-vege_tntsav2ghe2f",plates:300,typeR:"plat",hasOwnPlatesNb:!1},{recipeUuid:"jambalaya-vegan_jai01fvdixw5",plates:30,typeR:"plat",hasOwnPlatesNb:!0},{recipeUuid:"creme-de-riz-libanaise_k00sjxzgi6ql",plates:300,typeR:"dessert",hasOwnPlatesNb:!1}],guests:300,dayOffset:3,time:"12:00"},{recipes:[{recipeUuid:"gaspacho_cf5hqia64o1j",plates:250,typeR:"entree",hasOwnPlatesNb:!0},{recipeUuid:"pastilla-vegan-a-laube_fzejp2oz5xj2",plates:250,typeR:"plat",hasOwnPlatesNb:!0},{recipeUuid:"bahn-mi-a-la-proteine-_go4i0y6buluy",plates:40,typeR:"plat",hasOwnPlatesNb:!0},{recipeUuid:"fondant-au-chocolat-ve_0vedt76modbc",plates:250,typeR:"dessert",hasOwnPlatesNb:!0}],guests:250,dayOffset:3,time:"19:30"},{recipes:[{recipeUuid:"tartinade-de-haricot-r_w8ympby8n43o",plates:300,typeR:"autre",hasOwnPlatesNb:!1},{recipeUuid:"risotto-torrefie-de-sa_slsqvoqaqra7",plates:300,typeR:"plat",hasOwnPlatesNb:!1},{recipeUuid:"proteines-de-soja-mari_ggo9802gtbxq",plates:50,typeR:"plat",hasOwnPlatesNb:!0},{recipeUuid:"salami-au-chocolat-veg_gp22v4hamxcv",plates:300,typeR:"dessert",hasOwnPlatesNb:!1}],guests:300,dayOffset:4,time:"12:00"},{recipes:[{recipeUuid:"salade-thai-aux-nouill_qv7cxgmhdwiy",plates:300,typeR:"entree",hasOwnPlatesNb:!1},{recipeUuid:"mafe-vegetarien-et-riz_ij8i8degl1r6",plates:300,typeR:"plat",hasOwnPlatesNb:!1},{recipeUuid:"aubergines-grillees-ca_3y287nb3wv9b",plates:40,typeR:"plat",hasOwnPlatesNb:!0},{recipeUuid:"creme-vegan-au-sureau_lds9ghlhjlwn",plates:300,typeR:"dessert",hasOwnPlatesNb:!1}],guests:300,dayOffset:4,time:"20:00"}]};async function Kt(t,e={}){const{maxAttempts:r=3,timeout:s=1e4,context:n="Operation",successMessage:a,errorMessage:o,retryDelay:c=1e3,silent:l=!1}=e;let u=null;for(let d=1;d<=r;d++)try{console.log(`[${n}] Tentative ${d}/${r}`);const h=await Promise.race([t(),Xp(s)]);return d>1&&console.log(`[${n}] â SuccÃ¨s aprÃ¨s ${d} tentatives`),a&&!l&&Ke.success(a),h}catch(h){if(u=h instanceof Error?h:new Error(String(h)),console.error(`[${n}] â Tentative ${d}/${r} Ã©chouÃ©e:`,u.message),d===r)throw console.error(`[${n}] â Ãchec aprÃ¨s ${r} tentatives`),o&&!l&&Ke.error(o),u;const p=c*d;console.log(`[${n}] Nouvelle tentative dans ${p}ms...`),await Zp(p)}throw u||new Error(`${n}: Ãchec inconnu`)}function Xp(t){return new Promise((e,r)=>{setTimeout(()=>{r(new Error(`Timeout aprÃ¨s ${t}ms`))},t)})}function Zp(t){return new Promise(e=>setTimeout(e,t))}function Pa(t,e={}){const{fallback:r=null,context:s="JSON.parse"}=e;try{return JSON.parse(t)}catch(n){return console.error(`[${s}] â JSON invalide:`,n instanceof Error?n.message:n),r}}function Uo(t,e={}){const{context:r="JSON.parseArray",itemFallback:s}=e;return!t||!Array.isArray(t)?(console.warn(`[${r}] Tableau vide ou invalide`),[]):t.map((n,a)=>{const o=Pa(n,{context:`${r}[${a}]`,fallback:void 0});return o===void 0&&s?s(n,a):o}).filter(n=>n!==null)}const{APPWRITE_CONFIG:Gr}=bs(),an="main";async function tl(t,e=null){return Kt(async()=>{const{tables:r}=await D(),s=[S.orderDesc("dateStart")];return e&&s.push(S.greaterThanEqual("dateEnd",e)),{events:(await r.listRows({databaseId:Gr.databaseId,tableId:an,queries:s})).rows}},{context:"AppwriteEvents.listEvents",timeout:2e4,errorMessage:"Erreur lors du chargement des Ã©vÃ©nements"})}async function zp(t){try{return await Kt(async()=>{const{tables:e}=await D();return await e.getRow({databaseId:Gr.databaseId,tableId:an,rowId:t})},{context:"AppwriteEvents.getEvent",timeout:1e4,errorMessage:"Erreur lors du chargement de l'Ã©vÃ©nement"})}catch(e){if(e.code===404)return null;throw e}}async function Fp(t,e){return Kt(async()=>{const{tables:r}=await D(),s=yt.unique(),n=await r.createRow({databaseId:Gr.databaseId,tableId:an,rowId:s,data:{name:t.name,dateStart:t.dateStart,dateEnd:t.dateEnd,allDates:t.allDates,meals:t.meals?t.meals.map(o=>JSON.stringify(o)):[],createdBy:e,teams:t.teams??[],contributors:t.contributors?t.contributors.map(o=>JSON.stringify(o)):[],todos:t.todos?t.todos.map(o=>JSON.stringify(o)):[]}});console.log(`[appwrite-events] Event created: ${s}`);const{functions:a}=await D();return await a.createExecution({functionId:Gr.functions.usersTeamsManager,body:JSON.stringify({action:"add-label-to-user",mainId:s,userId:e}),async:!1}),console.log(`[appwrite-events] Label ${s} attribuÃ© au crÃ©ateur ${e}`),n},{context:"AppwriteEvents.createEvent",timeout:15e3,successMessage:"ÃvÃ©nement crÃ©Ã© avec succÃ¨s",errorMessage:"Erreur lors de la crÃ©ation de l'Ã©vÃ©nement"})}async function em(t,e,r=[],s=!0){return Kt(async()=>{const{functions:n}=await D(),a={name:t.name,description:t.description||"",dateStart:t.dateStart,dateEnd:t.dateEnd,allDates:t.allDates,meals:t.meals?t.meals.map(u=>JSON.stringify(u)):[],createdBy:e,teams:t.teams||[],teamsId:t.teamsId||[],contributors:t.contributors?t.contributors.map(u=>JSON.stringify(u)):[],todos:t.todos?t.todos.map(u=>JSON.stringify(u)):[],status:t.status||"proposition"};console.log(`[appwrite-events] CrÃ©ation Ã©vÃ©nement avec ${r.length} team(s)`);const o=await n.createExecution({functionId:Gr.functions.usersTeamsManager,body:JSON.stringify({action:"create-event-with-teams",eventData:a,creatorId:e,teamIds:r,sendEmailToExistingMembers:s}),async:!1}),c=JSON.parse(o.responseBody);if(!c.success)throw new Error(c.error||"Erreur lors de la crÃ©ation");return console.log(`[appwrite-events] ÃvÃ©nement crÃ©Ã© avec teams: ${c.eventId}`),c.event},{context:"AppwriteEvents.createEventWithTeams",timeout:3e4,successMessage:"ÃvÃ©nement crÃ©Ã© avec succÃ¨s",errorMessage:"Erreur lors de la crÃ©ation de l'Ã©vÃ©nement"})}async function rl(t,e){return Kt(async()=>{const{tables:r}=await D(),s={...e};e.meals&&(s.meals=e.meals.map(a=>JSON.stringify(a))),e.contributors&&(s.contributors=Array.isArray(e.contributors)?e.contributors.map(a=>JSON.stringify(a)):[]),e.todos&&(s.todos=e.todos.map(a=>JSON.stringify(a))),e.allDates&&(s.allDates=e.allDates);const n=await r.updateRow({databaseId:Gr.databaseId,tableId:an,rowId:t,data:s});return console.log(`[appwrite-events] Event updated: ${t}`),n},{context:"AppwriteEvents.updateEvent",timeout:1e4,successMessage:"ÃvÃ©nement mis Ã  jour",errorMessage:"Erreur lors de la mise Ã  jour"})}async function tm(t){return Kt(async()=>{const{tables:e,functions:r}=await D();await e.deleteRow({databaseId:Gr.databaseId,tableId:an,rowId:t}),console.log(`[appwrite-events] Event deleted: ${t}`),await r.createExecution({functionId:Gr.functions.usersTeamsManager,body:JSON.stringify({action:"delete-event-label",mainId:t}),async:!0}),console.log(`[appwrite-events] Label deletion initiated for event: ${t}`)},{context:"AppwriteEvents.deleteEvent",timeout:1e4,successMessage:"ÃvÃ©nement supprimÃ©",errorMessage:"Erreur lors de la suppression"})}function rm(t){return Uo(t,{context:"parseEventMeals",itemFallback:(e,r)=>(console.warn(`[parseEventMeals] Meal ${r} invalide, utilisation d'un fallback`,e),{id:`unknown-${r}`,name:"Repas inconnu",date:new Date().toISOString(),guests:1,recipes:[]})})}function sm(t){return Uo(t,{context:"parseEventContributors",itemFallback:(e,r)=>(console.warn(`[parseEventContributors] Contributor ${r} invalide, utilisation d'un fallback`,e),{id:typeof e=="string"?e:`unknown-${r}`,status:"accepted",invitedAt:new Date().toISOString()})})}function nm(t){return Uo(t,{context:"parseEventTodos",itemFallback:(e,r)=>(console.warn(`[parseEventTodos] Todo ${r} invalide, utilisation d'un fallback`,e),{id:`unknown-${r}`,taskName:"TÃ¢che invalide",taskDescription:null,dueDate:null,priority:null,status:null,taskOn:null,requiredPeopleNb:1,assignedTo:null})})}class am{constructor(){T(this,"dbName","events-cache");T(this,"db",null);T(this,"version",2);T(this,"EVENTS_STORE","events");T(this,"METADATA_STORE","metadata");T(this,"POSTER_CONFIGS_STORE","poster-configs");T(this,"LAST_SYNC_KEY","lastSync")}async open(){if(this.db)return;const e=()=>new Promise((o,c)=>{const l=indexedDB.open(this.dbName,this.version);l.onerror=()=>c(l.error),l.onsuccess=()=>o(l.result),l.onupgradeneeded=u=>{const d=u.target.result;d.objectStoreNames.contains(this.EVENTS_STORE)||(d.createObjectStore(this.EVENTS_STORE,{keyPath:"$id"}),console.log("[EventsIDBCache] Object store 'events' crÃ©Ã©")),d.objectStoreNames.contains(this.METADATA_STORE)||(d.createObjectStore(this.METADATA_STORE,{keyPath:"key"}),console.log("[EventsIDBCache] Object store 'metadata' crÃ©Ã©")),d.objectStoreNames.contains(this.POSTER_CONFIGS_STORE)||(d.createObjectStore(this.POSTER_CONFIGS_STORE,{keyPath:"eventId"}),console.log("[EventsIDBCache] Object store 'poster-configs' crÃ©Ã©"))}});let r=await e();const s=r.objectStoreNames.contains(this.EVENTS_STORE),n=r.objectStoreNames.contains(this.METADATA_STORE),a=r.objectStoreNames.contains(this.POSTER_CONFIGS_STORE);(!s||!n||!a)&&(console.warn(`[EventsIDBCache] Base incomplÃ¨te dÃ©tectÃ©e (events=${s}, metadata=${n}, posters=${a}), suppression et recrÃ©ation...`),r.close(),await new Promise((o,c)=>{const l=indexedDB.deleteDatabase(this.dbName);l.onsuccess=()=>o(),l.onerror=()=>c(l.error),l.onblocked=()=>{console.warn("[EventsIDBCache] Suppression bloquÃ©e, rÃ©essai...")}}),r=await e()),this.db=r,console.log(`[EventsIDBCache] Base ouverte: ${this.dbName}`)}async loadEvents(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,r)=>{const a=this.db.transaction(this.EVENTS_STORE,"readonly").objectStore(this.EVENTS_STORE).getAll();a.onsuccess=()=>{const o=new Map;a.result.forEach(c=>{o.set(c.$id,c)}),console.log(`[EventsIDBCache] ${o.size} Ã©vÃ©nements chargÃ©s`),e(o)},a.onerror=()=>r(a.error)})}async saveEvents(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction(this.EVENTS_STORE,"readwrite"),a=n.objectStore(this.EVENTS_STORE);a.clear(),e.forEach(o=>{a.put(o)}),n.oncomplete=()=>{console.log(`[EventsIDBCache] ${e.size} Ã©vÃ©nements sauvegardÃ©s`),r()},n.onerror=()=>s(n.error)})}async saveEvent(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.EVENTS_STORE,"readwrite").objectStore(this.EVENTS_STORE).put(e);o.onsuccess=()=>{console.log(`[EventsIDBCache] ÃvÃ©nement ${e.$id} sauvegardÃ©`),r()},o.onerror=()=>s(o.error)})}async deleteEvent(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.EVENTS_STORE,"readwrite").objectStore(this.EVENTS_STORE).delete(e);o.onsuccess=()=>{console.log(`[EventsIDBCache] ÃvÃ©nement ${e} supprimÃ©`),r()},o.onerror=()=>s(o.error)})}async loadPosterConfig(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const a=this.db.transaction(this.POSTER_CONFIGS_STORE,"readwrite").objectStore(this.POSTER_CONFIGS_STORE),o=a.get(e);o.onsuccess=()=>{const c=o.result;if(!c){r(null);return}if(c.config&&!c.current){console.log(`[EventsIDBCache] Migration config affiche V1 -> V2 pour ${e}`);const l={current:c.config,versions:[]};a.put({eventId:e,...l,updatedAt:new Date().toISOString()}),r(l)}else c.current?r({current:c.current,versions:c.versions}):r(null)},o.onerror=()=>s(o.error)})}async savePosterConfig(e,r){if(!this.db)throw new Error("DB non ouverte");return new Promise((s,n)=>{const c=this.db.transaction(this.POSTER_CONFIGS_STORE,"readwrite").objectStore(this.POSTER_CONFIGS_STORE).put({eventId:e,...r,updatedAt:new Date().toISOString()});c.onsuccess=()=>{console.log(`[EventsIDBCache] Config affiche (container) pour ${e} sauvegardÃ©e`),s()},c.onerror=()=>n(c.error)})}async loadMetadata(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,r)=>{const a=this.db.transaction(this.METADATA_STORE,"readonly").objectStore(this.METADATA_STORE).getAll();a.onsuccess=()=>{const o=a.result,c={lastSync:null};o.forEach(l=>{l.key===this.LAST_SYNC_KEY&&(c.lastSync=l.value)}),console.log(`[EventsIDBCache] Metadata chargÃ©es: lastSync=${c.lastSync}`),e(c)},a.onerror=()=>r(a.error)})}async saveMetadata(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction(this.METADATA_STORE,"readwrite");n.objectStore(this.METADATA_STORE).put({key:this.LAST_SYNC_KEY,value:e.lastSync}),n.oncomplete=()=>{console.log("[EventsIDBCache] Metadata sauvegardÃ©es"),r()},n.onerror=()=>s(n.error)})}async clear(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,r)=>{const s=this.db.transaction([this.EVENTS_STORE,this.METADATA_STORE,this.POSTER_CONFIGS_STORE],"readwrite");s.objectStore(this.EVENTS_STORE).clear(),s.objectStore(this.METADATA_STORE).clear(),s.objectStore(this.POSTER_CONFIGS_STORE).clear(),s.oncomplete=()=>{console.log("[EventsIDBCache] Cache vidÃ©"),e()},s.onerror=()=>r(s.error)})}close(){this.db&&(this.db.close(),this.db=null,console.log("[EventsIDBCache] Connexion fermÃ©e"))}}async function sl(){const t=new am;return await t.open(),t}const qa=[Yp];function im(t=0){const e=new Date,r=new Date(e);r.setDate(e.getDate()+7+t);const n=(5-r.getDay()+7)%7;return r.setDate(r.getDate()+n),r.setHours(0,0,0,0),r}function nl(t,e){const r=new Date(t);return r.setDate(r.getDate()+e),r}function om(t){const e=new Set;return t.forEach(r=>{const s=r.date.split("T")[0];e.add(s)}),Array.from(e).sort()}async function cm(t,e){const[r,s]=e.time.split(":"),n=new Date(t);n.setHours(parseInt(r),parseInt(s),0,0);const o=(await Promise.all(e.recipes.map(async c=>{if(!await mi.getRecipeByUuid(c.recipeUuid))return console.error(`[DemoEvents] Recipe not found: ${c.recipeUuid}. Skipping.`),null;const u=c.hasOwnPlatesNb??!1,d={recipeUuid:c.recipeUuid,plates:c.plates,typeR:c.typeR};return u&&(d.hasOwnPlatesNb=u),d}))).filter(c=>c!==null);if(o.length===0)throw new Error(`No valid recipes found for meal at day ${e.dayOffset}, ${e.time}`);return{id:crypto.randomUUID(),date:n.toISOString(),guests:e.guests,recipes:o}}async function lm(t,e=0){console.log(`[DemoEvents] Generating event: ${t.name}`);const r=im(e),s=nl(r,t.durationDays-1);s.setHours(23,59,59,999),console.log(`[DemoEvents] Event dates: ${r.toISOString()} â ${s.toISOString()}`);const n=[];for(const u of t.meals){const d=nl(r,u.dayOffset);try{const h=await cm(d,u);n.push(h)}catch(h){console.error("[DemoEvents] Error generating meal:",h)}}n.sort((u,d)=>new Date(u.date).getTime()-new Date(d.date).getTime()),console.log(`[DemoEvents] Generated ${n.length} meals`);const a=om(n);console.log(`[DemoEvents] Event covers ${a.length} days: ${a.join(", ")}`);const o=xu,c={id:"guest",name:"Visiteur",email:"guest@demo.local",status:"accepted",invitedAt:new Date().toISOString(),respondedAt:new Date().toISOString()},l={$id:o,$createdAt:new Date().toISOString(),$updatedAt:new Date().toISOString(),$permissions:[],name:t.name,description:t.description,status:"proposition",dateStart:r.toISOString(),dateEnd:s.toISOString(),allDates:a,meals:n,contributors:[c],todos:[],teams:[],teamsId:[],createdBy:"demo-system",isActive:!0,originalDataHash:null,error:null,minContrib:1,$sequence:0,$tableId:"",$databaseId:""};return console.log(`[DemoEvents] Event generated: ${o}`),dm(l),l}async function um(){console.log(`[DemoEvents] Generating ${qa.length} demo events`);const t=[],e=30;for(let r=0;r<qa.length;r++){const s=qa[r],n=r*e;try{const a=await lm(s,n);t.push(a)}catch(a){console.error(`[DemoEvents] Error generating event "${s.name}":`,a)}}return console.log(`[DemoEvents] Generated ${t.length}/${qa.length} events successfully`),t}function dm(t){console.log(`[DemoEvents] Validating event: ${t.$id}`);const e=[];t.status!=="proposition"&&e.push(`Event status should be "proposition", got: ${t.status}`);const r=new Set(t.meals.map(o=>o.date.split("T")[0])),s=new Set(t.allDates||[]),n=Array.from(r).filter(o=>!s.has(o));n.length>0&&e.push(`Dates missing in allDates: ${n.join(", ")}`);const a=Array.from(s).filter(o=>!r.has(o));if(a.length>0&&e.push(`Extra dates in allDates (no meals): ${a.join(", ")}`),!t.dateStart||!t.dateEnd)e.push("Event dateStart and dateEnd must be defined");else{const o=new Date(t.dateStart).getTime(),c=new Date(t.dateEnd).getTime();for(const l of t.meals){const u=new Date(l.date).getTime();(u<o||u>c)&&e.push(`Meal "${l.id}" date (${l.date}) is outside event range (${t.dateStart} â ${t.dateEnd})`)}}for(const o of t.meals)(!o.recipes||o.recipes.length===0)&&e.push(`Meal "${o.id}" has no recipes`);if(e.length>0)throw new Error(`Demo event validation failed:
  - ${e.join(`
  - `)}`);console.log(`[DemoEvents] â Validation passed for event: ${t.$id}`)}var R,Re,Ve,qt,Z,We,Us,Bs,Si,jn,Ar,_r,$,Ka,wr,Ce,Ya,Hu,Vu,Wu,Gu,Qu,Ju,Ku,Yu,Xu,Zu,zu,Fu,ed;class fm{constructor(){y(this,$);y(this,R,new gt);y(this,Re,P(!1));y(this,Ve,P(null));y(this,qt,P(!1));y(this,Z,null);y(this,We,null);y(this,Us,[]);y(this,Bs,null);y(this,Si,z(()=>{const e=new Date;return e.setHours(0,0,0,0),Array.from(i(this,R).values()).filter(r=>!r.dateStart||!r.dateEnd?!1:new Date(r.dateEnd)>=e).sort((r,s)=>{const n=new Date(r.dateStart),a=new Date(s.dateStart);return n.getTime()-a.getTime()})}));y(this,jn,z(()=>{const e=new Date;return Array.from(i(this,R).values()).filter(r=>!r.dateStart||!r.dateEnd?!1:new Date(r.dateEnd)<e).sort((r,s)=>{const n=new Date(r.dateStart);return new Date(s.dateStart).getTime()-n.getTime()})}));y(this,Ar,null);y(this,_r,!1)}get loading(){return f(i(this,Re))}get error(){return f(i(this,Ve))}get isInitialized(){return f(i(this,qt))}get events(){return Array.from(i(this,R).values())}get count(){return i(this,R).size}get currentEvents(){return f(i(this,Si))}get pastEvents(){return f(i(this,jn))}get pastEventsCount(){return f(i(this,jn)).length}async loadCache(){if(f(i(this,qt))){console.log("[EventsStore] Cache dÃ©jÃ  chargÃ©");return}console.log("[EventsStore] Chargement du cache..."),m(i(this,Re),!0),m(i(this,Ve),null);try{if(!k.isAuthenticated)throw new Error("Utilisateur non connectÃ©");I(this,We,k.userId),I(this,Us,k.userTeams),I(this,Z,await sl());const e=await i(this,Z).loadEvents();if(e.size>0){console.log(`[EventsStore] ${e.size} Ã©vÃ©nements chargÃ©s depuis le cache`),i(this,R).clear();for(const[r,s]of e)i(this,R).set(r,s)}m(i(this,qt),!0),console.log(`[EventsStore] Cache chargÃ©: ${i(this,R).size} Ã©vÃ©nements`)}catch(e){const r=e instanceof Error?e.message:"Erreur lors du chargement du cache";throw m(i(this,Ve),r,!0),console.error("[EventsStore]",r,e),e}finally{m(i(this,Re),!1)}}async syncFromRemote(){if(!i(this,Z)){console.warn("[EventsStore] Impossible de sync : cache non initialisÃ©");return}if(ae(i(this,Bs))){console.log("[EventsStore] Mode dÃ©mo: skip syncFromRemote");return}console.log("[EventsStore] Synchronisation depuis Appwrite..."),m(i(this,Re),!0);try{await b(this,$,Ka).call(this),await b(this,$,Ya).call(this),await i(this,Z).saveMetadata({lastSync:new Date().toISOString()}),console.log(`[EventsStore] Synchronisation terminÃ©e: ${i(this,R).size} Ã©vÃ©nements`)}catch(e){const r=e instanceof Error?e.message:"Erreur lors de la synchronisation";throw m(i(this,Ve),r,!0),console.error("[EventsStore]",r,e),e}finally{m(i(this,Re),!1)}}async setupRealtime(){if(!i(this,Z)){console.warn("[EventsStore] Impossible de setup realtime : cache non initialisÃ©");return}if(i(this,_r)&&be.isInitialized){console.log("[EventsStore] Realtime dÃ©jÃ  configurÃ©");return}i(this,_r)&&!be.isInitialized&&(console.log("[EventsStore] RealtimeManager dÃ©truit, rÃ©initialisation..."),I(this,_r,!1)),console.log("[EventsStore] Configuration du realtime..."),await b(this,$,ed).call(this),I(this,_r,!0)}async initialize(){if(f(i(this,qt))){console.log("[EventsStore] DÃ©jÃ  initialisÃ©");return}return i(this,Ar)?(console.log("[EventsStore] Initialisation dÃ©jÃ  en cours, attente..."),i(this,Ar)):(console.log("[EventsStore] Initialisation complÃ¨te..."),m(i(this,Re),!0),m(i(this,Ve),null),I(this,Ar,(async()=>{try{await this.loadCache(),await this.syncFromRemote(),await this.setupRealtime(),console.log(`[EventsStore] Initialisation complÃ©tÃ©e: ${i(this,R).size} Ã©vÃ©nements`)}catch(e){const r=e instanceof Error?e.message:"Erreur lors de l'initialisation";throw m(i(this,Ve),r,!0),console.error("[EventsStore]",r,e),e}finally{m(i(this,Re),!1),I(this,Ar,null)}})()),i(this,Ar))}async initializeForPublic(){if(f(i(this,qt))){console.log("[EventsStore] DÃ©jÃ  initialisÃ©");return}console.log("[EventsStore] Initialisation mode public..."),m(i(this,Re),!0),m(i(this,Ve),null);try{I(this,Z,await sl()),await this.loadDemoEvents(),m(i(this,qt),!0),I(this,We,"guest"),I(this,Us,[]),console.log("[EventsStore] Mode public initialisÃ© : events dÃ©mo chargÃ©s")}catch(e){throw console.error("[EventsStore] Erreur init mode public:",e),e}finally{m(i(this,Re),!1)}}async loadDemoEvents(){console.log("[EventsStore] Loading demo events...");try{const e=await um();console.log(`[EventsStore] Generated ${e.length} demo events`),e.forEach(r=>{i(this,R).set(r.$id,r)}),await b(this,$,Ya).call(this),console.log("[EventsStore] Demo events persisted to IDB"),console.log(`[EventsStore] Total events in store: ${i(this,R).size}`)}catch(e){throw console.error("[EventsStore] Error loading demo events:",e),e}}getEventById(e){return i(this,R).get(e)||null}async fetchEvent(e){try{const r=await zp(e);if(r){const s=b(this,$,wr).call(this,r);return i(this,R).set(e,s),s}return null}catch(r){return console.error(`[EventsStore] Erreur lors du fetch de ${e}:`,r),null}}getEventsByDateRange(e,r){return this.events.filter(s=>s.dateStart&&s.dateEnd&&s.dateStart>=e&&s.dateEnd<=r)}canEditEvent(e){if(!i(this,We))return!1;const r=i(this,R).get(e);return r?!!(r.createdBy===i(this,We)||r.teams?.some(s=>i(this,Us).includes(s))||r.contributors&&r.contributors.some(s=>s.id===i(this,We)&&s.status==="accepted")):!1}canUserEditEvent(e,r,s){const n=i(this,R).get(e);return n?n.status==="local"?!0:r?!!(n.createdBy===r||n.teams?.length&&s?.length&&n.teams.some(a=>s.includes(a))||n.contributors&&n.contributors.some(a=>a.id===r&&a.status==="accepted")):!1:!1}async createEvent(e){if(!k.userId)throw new Error("Utilisateur non connectÃ©");const r=await Fp(e,k.userId),s=b(this,$,wr).call(this,r);return i(this,R).set(r.$id,s),await b(this,$,Ce).call(this,s),console.log(`[EventsStore] ÃvÃ©nement crÃ©Ã©: ${r.$id}`),s}async createEventWithTeams(e,r=[],s=!0){if(!k.userId)throw new Error("Utilisateur non connectÃ©");const n=await em(e,k.userId,r,s),a=b(this,$,wr).call(this,n);return i(this,R).set(n.$id,a),await b(this,$,Ce).call(this,a),console.log(`[EventsStore] ÃvÃ©nement crÃ©Ã© avec ${r.length} team(s): ${n.$id}`),a}async updateEvent(e,r){if(ae(e))return await b(this,$,Hu).call(this,e,r);const s=await rl(e,r),n=b(this,$,wr).call(this,s);return i(this,R).set(e,n),await b(this,$,Ce).call(this,n),console.log(`[EventsStore] ÃvÃ©nement mis Ã  jour: ${e}`),n}async updateEventStatus(e,r){if(ae(e)){await b(this,$,Vu).call(this,e,r);return}try{await rl(e,{status:r});const s=i(this,R).get(e);s&&(s.status=r),console.log(`[EventsStore] Statut mis Ã  jour: ${e} -> ${r}`)}catch(s){throw console.error(`[EventsStore] Erreur mise Ã  jour statut ${e}:`,s),s}}async deleteEvent(e){await tm(e),i(this,R).delete(e),i(this,Z)&&await i(this,Z).deleteEvent(e),console.log(`[EventsStore] ÃvÃ©nement supprimÃ©: ${e}`)}getContributors(e){const r=i(this,R).get(e);return r?r.contributors:[]}getContributorStatus(e){const r=i(this,R).get(e);if(!r)return"";const s=r.contributors.filter(n=>n.id===i(this,We));return s.length>0?s[0].status:""}async removeContributor(e,r){try{const s=i(this,R).get(e);if(!s)throw new Error("ÃvÃ©nement introuvable");const{removeUserFromEvent:n}=await W(async()=>{const{removeUserFromEvent:o}=await Promise.resolve().then(()=>zi);return{removeUserFromEvent:o}},void 0);await n(e,r);const a=s.contributors.filter(o=>o.id!==r&&o.email!==r);return s.contributors.length===a.length?s:await this.updateEvent(e,{contributors:a})}catch(s){throw console.error("[EventsStore] Erreur suppression contributeur:",s),s}}async inviteParticipants(e,r){try{const s=i(this,R).get(e);if(!s)throw new Error("ÃvÃ©nement introuvable");const{teamIds:n=[],emails:a=[],userIds:o=[],sendEmailToExistingMembers:c=!0}=r;if(n.length===0&&a.length===0&&o.length===0)return console.log("[EventsStore] Aucun participant Ã  inviter"),s;const{inviteParticipantsToEvent:l}=await W(async()=>{const{inviteParticipantsToEvent:p}=await Promise.resolve().then(()=>zi);return{inviteParticipantsToEvent:p}},void 0),u=await l(e,s.name,{teamIds:n,emails:a,userIds:o,sendEmailToExistingMembers:c});console.log(`[EventsStore] Invitation result: ${u.processed} traitÃ©s`);const d=n.length>0?2e3:500;await new Promise(p=>setTimeout(p,d));const h=await this.fetchEvent(e);if(!h)throw new Error("Impossible de recharger l'Ã©vÃ©nement");return h}catch(s){throw console.error("[EventsStore] Erreur invitation participants:",s),s}}async removeTeam(e,r){try{const{removeTeamFromEvent:s}=await W(async()=>{const{removeTeamFromEvent:a}=await Promise.resolve().then(()=>zi);return{removeTeamFromEvent:a}},void 0);await s(e,r),await new Promise(a=>setTimeout(a,1e3));const n=await this.fetchEvent(e);if(!n)throw new Error("Impossible de recharger l'Ã©vÃ©nement");return console.log(`[EventsStore] Team ${r} retirÃ©e de l'Ã©vÃ©nement ${e}`),n}catch(s){throw console.error("[EventsStore] Erreur retrait team:",s),s}}async updateContributorStatus(e,r,s){if(ae(e))return await b(this,$,Fu).call(this,e,r,s);try{const n=i(this,R).get(e);if(!n)throw new Error("ÃvÃ©nement introuvable");const a=[...n.contributors],o=a.findIndex(c=>c.id===r||c.email===r);if(o===-1)throw new Error("Contributeur introuvable");return a[o]={...a[o],status:s,respondedAt:new Date().toISOString()},await this.updateEvent(e,{contributors:a})}catch(n){throw console.error("[EventsStore] Erreur maj statut:",n),n}}getMeals(e){const r=i(this,R).get(e);return r?r.meals:[]}async addMeal(e,r){if(ae(e))return await b(this,$,Wu).call(this,e,r);try{const s=i(this,R).get(e);if(!s)throw new Error("ÃvÃ©nement introuvable");const n=[...s.meals,r];return await this.updateEvent(e,{meals:n})}catch(s){throw console.error("[EventsStore] Erreur ajout meal:",s),s}}async updateMeal(e,r,s){if(ae(e))return await b(this,$,Gu).call(this,e,r,s);try{const n=i(this,R).get(e);if(!n)throw new Error("ÃvÃ©nement introuvable");const a=[...n.meals];if(r<0||r>=a.length)throw new Error("Index invalide");return a[r]=s,await this.updateEvent(e,{meals:a})}catch(n){throw console.error("[EventsStore] Erreur maj meal:",n),n}}async deleteMeal(e,r){if(ae(e))return await b(this,$,Qu).call(this,e,r);try{const s=i(this,R).get(e);if(!s)throw new Error("ÃvÃ©nement introuvable");const n=[...s.meals];if(r<0||r>=n.length)throw new Error("Index invalide");return n.splice(r,1),await this.updateEvent(e,{meals:n})}catch(s){throw console.error("[EventsStore] Erreur suppression meal:",s),s}}getTodos(e){const r=i(this,R).get(e);return r?r.todos:[]}async addTodo(e,r){if(ae(e))return await b(this,$,Ju).call(this,e,r);try{const s=i(this,R).get(e);if(!s)throw new Error("ÃvÃ©nement introuvable");const n=[...s.todos,r];return await this.updateEvent(e,{todos:n})}catch(s){throw console.error("[EventsStore] Erreur ajout todo:",s),s}}async addTodos(e,r){if(ae(e))return await b(this,$,Ku).call(this,e,r);try{const s=i(this,R).get(e);if(!s)throw new Error("ÃvÃ©nement introuvable");const n=[...s.todos,...r];return await this.updateEvent(e,{todos:n})}catch(s){throw console.error("[EventsStore] Erreur ajout todos:",s),s}}async updateTodoStatus(e,r,s){if(ae(e)){await b(this,$,Zu).call(this,e,r,s);return}try{const n=i(this,R).get(e);n&&(n.todos=n.todos.map(c=>c.id===r?{...c,status:s,updatedAt:new Date().toISOString()}:c));const{functions:a,config:o}=await D();await a.createExecution(o.functions.enkaData,JSON.stringify({action:"update_todo_status",data:{eventId:e,todoId:r,status:s}}),!1,"/",_n.POST)}catch(n){throw console.error("[EventsStore] Erreur updateTodoStatus:",n),n}}async toggleTodoAssignment(e,r){if(ae(e)){await b(this,$,zu).call(this,e,r);return}try{const s=k.userId;if(!s)throw new Error("Utilisateur non connectÃ©");const n=i(this,R).get(e);if(n){const c=n.todos.find(l=>l.id===r);if(c){let l=[];Array.isArray(c.assignedTo)?l=[...c.assignedTo]:c.assignedTo&&(l=[c.assignedTo]),l.includes(s)?l=l.filter(u=>u!==s):l.push(s),n.todos=n.todos.map(u=>u.id===r?{...u,assignedTo:l.length>0?l:null,updatedAt:new Date().toISOString()}:u)}}const{functions:a,config:o}=await D();await a.createExecution(o.functions.enkaData,JSON.stringify({action:"toggle_todo_assignment",data:{eventId:e,todoId:r}}),!1,"/",_n.POST)}catch(s){throw console.error("[EventsStore] Erreur toggleTodoAssignment:",s),s}}async updateTodo(e,r,s){if(ae(e))return await b(this,$,Yu).call(this,e,r,s);try{const n=i(this,R).get(e);if(!n)throw new Error("ÃvÃ©nement introuvable");const a=n.todos.map(o=>o.id===r?{...o,...s,updatedAt:new Date().toISOString()}:o);return await this.updateEvent(e,{todos:a})}catch(n){throw console.error("[EventsStore] Erreur maj todo:",n),n}}async deleteTodo(e,r){if(ae(e))return await b(this,$,Xu).call(this,e,r);try{const s=i(this,R).get(e);if(!s)throw new Error("ÃvÃ©nement introuvable");const n=s.todos.filter(a=>a.id!==r);return await this.updateEvent(e,{todos:n})}catch(s){throw console.error("[EventsStore] Erreur suppression todo:",s),s}}async loadAllPastEvents(){try{if(console.log("[EventsStore] Chargement de TOUS les Ã©vÃ©nements..."),!i(this,We)){console.warn("[EventsStore] userId non dÃ©fini");return}m(i(this,Re),!0);const{events:e}=await tl(i(this,We),null);e.forEach(r=>{i(this,R).set(r.$id,b(this,$,wr).call(this,r))}),console.log(`[EventsStore] ${e.length} Ã©vÃ©nements chargÃ©s (sans filtre de date, total: ${i(this,R).size})`)}catch(e){throw console.error("[EventsStore] Erreur lors du chargement:",e),e}finally{m(i(this,Re),!1)}}calculateScaleFactor(e,r){return e/r}async loadPosterConfig(e){return i(this,Z)?await i(this,Z).loadPosterConfig(e):null}async savePosterConfig(e,r){if(!i(this,Z))return;const n=await i(this,Z).loadPosterConfig(e)||{versions:[]};n.current=r,await i(this,Z).savePosterConfig(e,n)}async createPosterVersion(e,r,s){if(!i(this,Z))return;const a=await i(this,Z).loadPosterConfig(e)||{current:r,versions:[]};if(a.versions||(a.versions=[]),a.versions.length>=3)throw new Error("Limite de 3 versions atteinte");const o={id:crypto.randomUUID(),name:s,config:JSON.parse(JSON.stringify(r)),createdAt:new Date().toISOString()};return a.versions.push(o),a.current=r,await i(this,Z).savePosterConfig(e,a),o}async deletePosterVersion(e,r){if(!i(this,Z))return;const s=await i(this,Z).loadPosterConfig(e);!s||!s.versions||(s.versions=s.versions.filter(n=>n.id!==r),await i(this,Z).savePosterConfig(e,s))}async reload(){console.log("[EventsStore] Rechargement..."),m(i(this,Re),!0),m(i(this,Ve),null);try{i(this,R).clear(),await b(this,$,Ka).call(this),console.log("[EventsStore] Rechargement complÃ©tÃ©")}catch(e){const r=e instanceof Error?e.message:"Erreur lors du rechargement";throw m(i(this,Ve),r,!0),console.error("[EventsStore]",r,e),e}finally{m(i(this,Re),!1)}}async hardReset(){console.log("[EventsStore] ð HARD RESET - Vidage complet..."),m(i(this,Re),!0),m(i(this,Ve),null);try{i(this,R).clear(),i(this,Z)&&(await i(this,Z).clear(),console.log("[EventsStore] Cache IDB vidÃ©")),await b(this,$,Ka).call(this),i(this,Z)&&(await b(this,$,Ya).call(this),await i(this,Z).saveMetadata({lastSync:new Date().toISOString()}),console.log("[EventsStore] Cache IDB recrÃ©Ã©")),console.log("[EventsStore] â HARD RESET terminÃ©")}catch(e){const r=e instanceof Error?e.message:"Erreur lors du hard reset";throw m(i(this,Ve),r,!0),console.error("[EventsStore]",r,e),e}finally{m(i(this,Re),!1)}}destroy(){i(this,Z)&&(i(this,Z).close(),I(this,Z,null)),i(this,R).clear(),m(i(this,qt),!1),I(this,_r,!1),console.log("[EventsStore] Ressources nettoyÃ©es")}}R=new WeakMap,Re=new WeakMap,Ve=new WeakMap,qt=new WeakMap,Z=new WeakMap,We=new WeakMap,Us=new WeakMap,Bs=new WeakMap,Si=new WeakMap,jn=new WeakMap,Ar=new WeakMap,_r=new WeakMap,$=new WeakSet,Ka=async function(e=null){if(ae(i(this,Bs))){console.log("[EventsStore] Mode dÃ©mo: skip loadEvents from Appwrite");return}try{if(console.log("[EventsStore] Chargement des Ã©vÃ©nements..."),!i(this,We)){console.warn("[EventsStore] userId non dÃ©fini, impossible de charger les Ã©vÃ©nements");return}if(!e){const s=new Date;s.setHours(0,0,0,0);const n=new Date(s);n.setDate(n.getDate()-15),e=n.toISOString()}const{events:r}=await tl(i(this,We),e);r.forEach(s=>{i(this,R).set(s.$id,b(this,$,wr).call(this,s))}),console.log(`[EventsStore] ${r.length} Ã©vÃ©nements chargÃ©s (filtrÃ©s pour userId: ${i(this,We)}, date >= ${e})`)}catch(r){throw console.error("[EventsStore] Erreur lors du chargement:",r),r}},wr=function(e){return{...e,status:e.status,teams:e.teams||void 0,teamsId:e.teamsId||void 0,meals:rm(e.meals),contributors:sm(e.contributors),todos:nm(e.todos)}},Ce=async function(e){if(!i(this,Z))return;const r=di(e);await i(this,Z).saveEvent(r)},Ya=async function(){if(!i(this,Z))return;const e=new Map;for(const[r,s]of i(this,R))e.set(r,di(s));await i(this,Z).saveEvents(e)},Hu=async function(e,r){const s=i(this,R).get(e);if(!s)throw new Error("ÃvÃ©nement introuvable");const n={...s,...r,$updatedAt:new Date().toISOString()};return i(this,R).set(e,n),await b(this,$,Ce).call(this,n),console.log(`[EventsStore] Mode local: Event mis Ã  jour: ${e}`),n},Vu=async function(e,r){const s=i(this,R).get(e);if(!s)throw new Error("ÃvÃ©nement introuvable");s.status=r,s.$updatedAt=new Date().toISOString(),await b(this,$,Ce).call(this,s),console.log(`[EventsStore] Mode local: Status mis Ã  jour: ${e} -> ${r}`)},Wu=async function(e,r){const s=i(this,R).get(e);if(!s)throw new Error("ÃvÃ©nement introuvable");const n={...s,meals:[...s.meals,r],$updatedAt:new Date().toISOString()};return i(this,R).set(e,n),await b(this,$,Ce).call(this,n),console.log(`[EventsStore] Mode local: Meal ajoutÃ© Ã  ${e}`),n},Gu=async function(e,r,s){const n=i(this,R).get(e);if(!n)throw new Error("ÃvÃ©nement introuvable");const a=[...n.meals];if(r<0||r>=a.length)throw new Error("Index invalide");a[r]=s;const o={...n,meals:a,$updatedAt:new Date().toISOString()};return i(this,R).set(e,o),await b(this,$,Ce).call(this,o),console.log(`[EventsStore] Mode local: Meal mis Ã  jour dans ${e}`),o},Qu=async function(e,r){const s=i(this,R).get(e);if(!s)throw new Error("ÃvÃ©nement introuvable");const n=[...s.meals];if(r<0||r>=n.length)throw new Error("Index invalide");n.splice(r,1);const a={...s,meals:n,$updatedAt:new Date().toISOString()};return i(this,R).set(e,a),await b(this,$,Ce).call(this,a),console.log(`[EventsStore] Mode local: Meal supprimÃ© de ${e}`),a},Ju=async function(e,r){const s=i(this,R).get(e);if(!s)throw new Error("ÃvÃ©nement introuvable");const n={...s,todos:[...s.todos,r],$updatedAt:new Date().toISOString()};return i(this,R).set(e,n),await b(this,$,Ce).call(this,n),console.log(`[EventsStore] Mode local: Todo ajoutÃ© Ã  ${e}`),n},Ku=async function(e,r){const s=i(this,R).get(e);if(!s)throw new Error("ÃvÃ©nement introuvable");const n={...s,todos:[...s.todos,...r],$updatedAt:new Date().toISOString()};return i(this,R).set(e,n),await b(this,$,Ce).call(this,n),console.log(`[EventsStore] Mode local: ${r.length} todos ajoutÃ©s Ã  ${e}`),n},Yu=async function(e,r,s){const n=i(this,R).get(e);if(!n)throw new Error("ÃvÃ©nement introuvable");const a=n.todos.map(c=>c.id===r?{...c,...s,updatedAt:new Date().toISOString()}:c),o={...n,todos:a,$updatedAt:new Date().toISOString()};return i(this,R).set(e,o),await b(this,$,Ce).call(this,o),console.log(`[EventsStore] Mode local: Todo mis Ã  jour dans ${e}`),o},Xu=async function(e,r){const s=i(this,R).get(e);if(!s)throw new Error("ÃvÃ©nement introuvable");const n=s.todos.filter(o=>o.id!==r),a={...s,todos:n,$updatedAt:new Date().toISOString()};return i(this,R).set(e,a),await b(this,$,Ce).call(this,a),console.log(`[EventsStore] Mode local: Todo supprimÃ© de ${e}`),a},Zu=async function(e,r,s){const n=i(this,R).get(e);if(!n)throw new Error("ÃvÃ©nement introuvable");n.todos=n.todos.map(a=>a.id===r?{...a,status:s,updatedAt:new Date().toISOString()}:a),await b(this,$,Ce).call(this,n),console.log(`[EventsStore] Mode local: Todo status mis Ã  jour: ${r} -> ${s}`)},zu=async function(e,r){const s=k.userId||"guest",n=i(this,R).get(e);if(!n)throw new Error("ÃvÃ©nement introuvable");const a=n.todos.find(c=>c.id===r);if(!a)throw new Error("Todo introuvable");let o=[];Array.isArray(a.assignedTo)?o=[...a.assignedTo]:a.assignedTo&&(o=[a.assignedTo]),o.includes(s)?o=o.filter(c=>c!==s):o.push(s),n.todos=n.todos.map(c=>c.id===r?{...c,assignedTo:o.length>0?o:null,updatedAt:new Date().toISOString()}:c),await b(this,$,Ce).call(this,n),console.log(`[EventsStore] Mode local: Todo assignment toggled: ${r} par ${s}`)},Fu=async function(e,r,s){const n=i(this,R).get(e);if(!n)throw new Error("ÃvÃ©nement introuvable");const a=[...n.contributors],o=a.findIndex(l=>l.id===r||l.email===r);if(o===-1)throw new Error("Contributeur introuvable");a[o]={...a[o],status:s,respondedAt:new Date().toISOString()};const c={...n,contributors:a,$updatedAt:new Date().toISOString()};return i(this,R).set(e,c),await b(this,$,Ce).call(this,c),console.log(`[EventsStore] Mode local: Contributor status mis Ã  jour: ${r} -> ${s}`),c},ed=async function(){if(ae(i(this,Bs))){console.log("[EventsStore] Mode dÃ©mo: skip realtime setup");return}try{console.log("[EventsStore] Activation du Realtime...");const e=dt();be.register([`databases.${e}.collections.${an}.documents`],async r=>{const s=r.events.some(a=>a.includes(".create"))?"create":r.events.some(a=>a.includes(".delete"))?"delete":"update",n=r.payload;if(console.log(`[EventsStore] â¡ï¸ Realtime RECEIVED: ${s} pour ${n.$id}`,{name:n.name,updatedAt:n.$updatedAt}),s==="create"||s==="update"){const a=b(this,$,wr).call(this,n);i(this,R).set(n.$id,a),await b(this,$,Ce).call(this,a)}else s==="delete"&&(i(this,R).delete(n.$id),i(this,Z)&&await i(this,Z).deleteEvent(n.$id))}),console.log("[EventsStore] Realtime enregistrÃ© auprÃ¨s du manager")}catch(e){console.error("[EventsStore] Erreur lors de la configuration du realtime:",e)}};const Ze=new fm,Da=bs(),Ma="materiel";async function al(t){try{const{tables:e}=await D();return(await e.listRows({databaseId:Da.APPWRITE_CONFIG.databaseId,tableId:Ma,queries:t||[]})).rows}catch(e){throw console.error("[appwrite-materiel] Error listing materiels:",e),e}}async function hm(t,e){try{const{tables:r}=await D(),s=yt.unique();let n;try{n=typeof t.owner=="string"?JSON.parse(t.owner):t.owner}catch(c){throw console.error("[appwrite-materiel] Error parsing owner:",t.owner,c),new Error("Invalid owner format")}const a=[te.read(ie.user(e)),te.update(ie.user(e))];n.teamId?a.push(te.read(ie.team(n.teamId)),te.update(ie.team(n.teamId))):n.userId&&a.push(te.read(ie.user(n.userId)),te.update(ie.user(n.userId)));const o=await r.createRow({databaseId:Da.APPWRITE_CONFIG.databaseId,tableId:Ma,rowId:s,data:{name:t.name,description:t.description||null,type:t.type||null,quantity:t.quantity,status:t.status||"ok",location:t.location||null,shareableWith:t.shareableWith||null,owner:t.owner},permissions:a});return console.log(`[appwrite-materiel] Materiel created: ${s}`),o}catch(r){throw console.error("[appwrite-materiel] Error creating materiel:",r),r}}async function Oa(t,e){try{const{tables:r}=await D(),s=await r.updateRow({databaseId:Da.APPWRITE_CONFIG.databaseId,tableId:Ma,rowId:t,data:e});return console.log(`[appwrite-materiel] Materiel updated: ${t}`),s}catch(r){throw console.error(`[appwrite-materiel] Error updating materiel ${t}:`,r),r}}async function pm(t){try{const{tables:e}=await D();await e.deleteRow({databaseId:Da.APPWRITE_CONFIG.databaseId,tableId:Ma,rowId:t}),console.log(`[appwrite-materiel] Materiel deleted: ${t}`)}catch(e){throw console.error(`[appwrite-materiel] Error deleting materiel ${t}:`,e),e}}function mm(){return[`databases.${Da.APPWRITE_CONFIG.databaseId}.collections.${Ma}.documents`]}const $a=bs(),ka="materiel_loan";async function il(t){try{const{tables:e}=await D();return(await e.listRows({databaseId:$a.APPWRITE_CONFIG.databaseId,tableId:ka,queries:t||[]})).rows}catch(e){throw console.error("[appwrite-materiel-loan] Error listing loans:",e),e}}async function gm(t,e){try{const{tables:r}=await D(),s=yt.unique(),n=[te.read(ie.user(e)),te.update(ie.user(e)),te.read(ie.team(t.ownerId)),te.update(ie.team(t.ownerId))],a=await r.createRow({databaseId:$a.APPWRITE_CONFIG.databaseId,tableId:ka,rowId:s,data:{startDate:t.startDate,endDate:t.endDate,responsibleId:t.responsibleId,responsibleName:t.responsibleName,ownerId:t.ownerId,ownerName:t.ownerName,materiels:t.materiels.map(o=>JSON.stringify(o)),notes:t.notes||null,status:t.status||"asked",completedAt:null,returnedAt:null,returnNotes:null},permissions:n});return console.log(`[appwrite-materiel-loan] Loan created: ${s}`),a}catch(r){throw console.error("[appwrite-materiel-loan] Error creating loan:",r),r}}async function ym(t,e){try{const{tables:r}=await D(),s={};e.startDate!==void 0&&(s.startDate=e.startDate),e.endDate!==void 0&&(s.endDate=e.endDate),e.materiels!==void 0&&(s.materiels=e.materiels.map(a=>JSON.stringify(a))),e.status!==void 0&&(s.status=e.status),e.notes!==void 0&&(s.notes=e.notes),e.returnedAt!==void 0&&(s.returnedAt=e.returnedAt),e.returnNotes!==void 0&&(s.returnNotes=e.returnNotes);const n=await r.updateRow({databaseId:$a.APPWRITE_CONFIG.databaseId,tableId:ka,rowId:t,data:s});return console.log(`[appwrite-materiel-loan] Loan updated: ${t}`),n}catch(r){throw console.error(`[appwrite-materiel-loan] Error updating loan ${t}:`,r),r}}async function wm(t){try{const{tables:e}=await D();await e.deleteRow({databaseId:$a.APPWRITE_CONFIG.databaseId,tableId:ka,rowId:t}),console.log(`[appwrite-materiel-loan] Loan deleted: ${t}`)}catch(e){throw console.error(`[appwrite-materiel-loan] Error deleting loan ${t}:`,e),e}}function vm(){return[`databases.${$a.APPWRITE_CONFIG.databaseId}.collections.${ka}.documents`]}class bm{constructor(){T(this,"dbName","materiel-cache");T(this,"db",null);T(this,"version",1);T(this,"MATERIELS_STORE","materiels");T(this,"LOANS_STORE","loans");T(this,"METADATA_STORE","metadata");T(this,"LAST_SYNC_MATERIEL_KEY","lastSyncMateriel");T(this,"LAST_SYNC_LOANS_KEY","lastSyncLoans")}async open(){if(this.db)return;const e=()=>new Promise((o,c)=>{const l=indexedDB.open(this.dbName,this.version);l.onerror=()=>c(l.error),l.onsuccess=()=>o(l.result),l.onupgradeneeded=u=>{const d=u.target.result;d.objectStoreNames.contains(this.MATERIELS_STORE)||(d.createObjectStore(this.MATERIELS_STORE,{keyPath:"$id"}),console.log("[MaterielIDBCache] Object store 'materiels' crÃ©Ã©")),d.objectStoreNames.contains(this.LOANS_STORE)||(d.createObjectStore(this.LOANS_STORE,{keyPath:"$id"}),console.log("[MaterielIDBCache] Object store 'loans' crÃ©Ã©")),d.objectStoreNames.contains(this.METADATA_STORE)||(d.createObjectStore(this.METADATA_STORE,{keyPath:"key"}),console.log("[MaterielIDBCache] Object store 'metadata' crÃ©Ã©"))}});let r=await e();const s=r.objectStoreNames.contains(this.MATERIELS_STORE),n=r.objectStoreNames.contains(this.LOANS_STORE),a=r.objectStoreNames.contains(this.METADATA_STORE);(!s||!n||!a)&&(console.warn(`[MaterielIDBCache] Base incomplÃ¨te dÃ©tectÃ©e (materiels=${s}, loans=${n}, metadata=${a}), suppression et recrÃ©ation...`),r.close(),await new Promise((o,c)=>{const l=indexedDB.deleteDatabase(this.dbName);l.onsuccess=()=>o(),l.onerror=()=>c(l.error),l.onblocked=()=>{console.warn("[MaterielIDBCache] Suppression bloquÃ©e, rÃ©essai...")}}),r=await e()),this.db=r,console.log(`[MaterielIDBCache] Base ouverte: ${this.dbName}`)}async loadMateriels(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,r)=>{const a=this.db.transaction(this.MATERIELS_STORE,"readonly").objectStore(this.MATERIELS_STORE).getAll();a.onsuccess=()=>{const o=new Map;a.result.forEach(c=>{o.set(c.$id,c)}),console.log(`[MaterielIDBCache] ${o.size} matÃ©riels chargÃ©s`),e(o)},a.onerror=()=>r(a.error)})}async saveMateriels(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction(this.MATERIELS_STORE,"readwrite"),a=n.objectStore(this.MATERIELS_STORE);a.clear(),e.forEach(o=>{a.put(o)}),n.oncomplete=()=>{console.log(`[MaterielIDBCache] ${e.size} matÃ©riels sauvegardÃ©s`),r()},n.onerror=()=>s(n.error)})}async upsertMateriel(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.MATERIELS_STORE,"readwrite").objectStore(this.MATERIELS_STORE).put(e);o.onsuccess=()=>{console.log(`[MaterielIDBCache] MatÃ©riel ${e.$id} sauvegardÃ©`),r()},o.onerror=()=>s(o.error)})}async deleteMateriel(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.MATERIELS_STORE,"readwrite").objectStore(this.MATERIELS_STORE).delete(e);o.onsuccess=()=>{console.log(`[MaterielIDBCache] MatÃ©riel ${e} supprimÃ©`),r()},o.onerror=()=>s(o.error)})}async loadLoans(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,r)=>{const a=this.db.transaction(this.LOANS_STORE,"readonly").objectStore(this.LOANS_STORE).getAll();a.onsuccess=()=>{const o=new Map;a.result.forEach(c=>{o.set(c.$id,c)}),console.log(`[MaterielIDBCache] ${o.size} emprunts chargÃ©s`),e(o)},a.onerror=()=>r(a.error)})}async saveLoans(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction(this.LOANS_STORE,"readwrite"),a=n.objectStore(this.LOANS_STORE);a.clear(),e.forEach(o=>{a.put(o)}),n.oncomplete=()=>{console.log(`[MaterielIDBCache] ${e.size} emprunts sauvegardÃ©s`),r()},n.onerror=()=>s(n.error)})}async upsertLoan(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.LOANS_STORE,"readwrite").objectStore(this.LOANS_STORE).put(e);o.onsuccess=()=>{console.log(`[MaterielIDBCache] Emprunt ${e.$id} sauvegardÃ©`),r()},o.onerror=()=>s(o.error)})}async deleteLoan(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.LOANS_STORE,"readwrite").objectStore(this.LOANS_STORE).delete(e);o.onsuccess=()=>{console.log(`[MaterielIDBCache] Emprunt ${e} supprimÃ©`),r()},o.onerror=()=>s(o.error)})}async loadMetadata(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,r)=>{const a=this.db.transaction(this.METADATA_STORE,"readonly").objectStore(this.METADATA_STORE).getAll();a.onsuccess=()=>{const o=a.result,c={lastSyncMateriel:null,lastSyncLoans:null};o.forEach(l=>{l.key===this.LAST_SYNC_MATERIEL_KEY&&(c.lastSyncMateriel=l.value),l.key===this.LAST_SYNC_LOANS_KEY&&(c.lastSyncLoans=l.value)}),console.log(`[MaterielIDBCache] Metadata chargÃ©es: lastSyncMateriel=${c.lastSyncMateriel}, lastSyncLoans=${c.lastSyncLoans}`),e(c)},a.onerror=()=>r(a.error)})}async saveMetadata(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction(this.METADATA_STORE,"readwrite"),a=n.objectStore(this.METADATA_STORE);a.put({key:this.LAST_SYNC_MATERIEL_KEY,value:e.lastSyncMateriel}),a.put({key:this.LAST_SYNC_LOANS_KEY,value:e.lastSyncLoans}),n.oncomplete=()=>{console.log("[MaterielIDBCache] Metadata sauvegardÃ©es"),r()},n.onerror=()=>s(n.error)})}async clear(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,r)=>{const s=this.db.transaction([this.MATERIELS_STORE,this.LOANS_STORE,this.METADATA_STORE],"readwrite");s.objectStore(this.MATERIELS_STORE).clear(),s.objectStore(this.LOANS_STORE).clear(),s.objectStore(this.METADATA_STORE).clear(),s.oncomplete=()=>{console.log("[MaterielIDBCache] Cache vidÃ©"),e()},s.onerror=()=>r(s.error)})}close(){this.db&&(this.db.close(),this.db=null,console.log("[MaterielIDBCache] Connexion fermÃ©e"))}}async function Em(){const t=new bm;return await t.open(),t}function Bo(t){const e={electronic:{label:"Ãlectronique",badgeClass:"badge-warning",textColor:"text-warning",bgColor:"bg-warning/10"},manual:{label:"Manuel",badgeClass:"badge-info",textColor:"text-info",bgColor:"bg-info/10"},tools:{label:"Outils",badgeClass:"badge-secondary",textColor:"text-secondary",bgColor:"bg-secondary/10"},dish:{label:"Vaisselle",badgeClass:"badge-primary",textColor:"text-primary",bgColor:"bg-primary/10"},cooking:{label:"Cuisine",badgeClass:"badge-success",textColor:"text-success",bgColor:"bg-success/10"},gaz:{label:"Gaz",badgeClass:"badge-error",textColor:"text-error",bgColor:"bg-error/10"},hygiene:{label:"HygiÃ¨ne",badgeClass:"badge-info",textColor:"text-info",bgColor:"bg-info/10"},other:{label:"Autre",badgeClass:"badge-neutral",textColor:"text-neutral",bgColor:"bg-neutral/10"}};return e[t||"other"]||e.other}function Hy(t){return Bo(t).badgeClass}function Vy(t){return Bo(t).textColor}function Wy(t){return Bo(t).bgColor}function Gy(t){return{ok:"OK",lost:"Perdu",torepair:"Ã rÃ©parer",loan:"EmpruntÃ©",reserved:"RÃ©server"}[t||"ok"]||t||"OK"}const ol={userName:"",userId:"",teamName:"",teamId:""};function Sm(t){if(!t)return ol;try{return typeof t=="string"?JSON.parse(t):t}catch(e){return console.error("[materiel.utils] Error parsing owner from Appwrite:",t,e),ol}}function xo(t){if(!t)return[];try{return Array.isArray(t)?t.map(e=>{try{return JSON.parse(e)}catch{return console.warn("[materiel.utils] Failed to parse loan item string:",e),null}}).filter(e=>e!==null):typeof t=="string"?JSON.parse(t):[]}catch(e){return console.error("[materiel.utils] Error parsing loan items from Appwrite:",t,e),[]}}function Im(t){return xo(t)}function pn(t){return{...t,materielItems:Im(t.materiels)}}function td(t,e,r=new Date){const s=Sm(t.owner),n=[];let a=0;e.forEach(d=>{const p=xo(d.materiels).filter(M=>M.materielId===t.$id);if(p.length===0)return;const g=new Date(d.startDate),w=new Date(d.endDate),_=g<=r&&w>=r,E=g>r,A=["accepted","asked"].includes(d.status);(_||E)&&A&&p.forEach(M=>{n.push({loanId:d.$id,responsibleName:d.responsibleName||"",startDate:d.startDate,endDate:d.endDate,quantity:M.quantity,status:d.status})}),_&&A&&p.forEach(M=>{a+=M.quantity})});const o=n.some(d=>{const h=new Date(d.startDate),p=new Date(d.endDate);return h<=r&&p>=r}),c=n.some(d=>new Date(d.startDate)>r);let l=t.status;o?l="loan":c&&(l="reserved");const u=t.quantity-a;return{...t,status:l,ownerData:s,loanDetails:n,availableQuantity:u,totalLoanedQuantity:a,isAvailable:u>0,isFullyLoaned:u===0}}function Am(t,e){const r={...t};return td(r,e)}function _m(t){return["asked","accepted"].includes(t.status)}function Rm(t,e,r,s){return t<=s&&e>=r}function Pm(t,e,r,s,n){let a=0;return e.forEach(o=>{if(n&&o.$id===n||!_m(o))return;const c=new Date(o.startDate),l=new Date(o.endDate);if(!Rm(c,l,r,s))return;const d=xo(o.materiels).filter(h=>h.materielId===t);a+=d.reduce((h,p)=>h+p.quantity,0)}),a}var pe,we,ne,me,he,ls,qn,Rr,Ot,Ut,Ii,ar,Ai,_i,Ri,On,oe,rd,sd,nd,ad,id,od,Ps,Ds;class Dm{constructor(){y(this,oe);y(this,pe,new gt);y(this,we,new gt);y(this,ne,null);y(this,me,P(!1));y(this,he,P(null));y(this,ls,P(!1));y(this,qn,P(!1));y(this,Rr,!1);y(this,Ot,P(null));y(this,Ut,P(null));y(this,Ii,null);y(this,ar,z(()=>Array.from(i(this,pe).values())));y(this,Ai,z(()=>Array.from(i(this,we).values())));y(this,_i,z(()=>{if(!k.userId)return[];const e=vt.myTeams.map(r=>r.$id);return f(i(this,ar)).filter(r=>r.ownerData?.teamId&&e.includes(r.ownerData.teamId))}));y(this,Ri,z(()=>{if(!k.userId)return[];const e=vt.myTeams.map(r=>r.$id);return f(i(this,ar)).filter(r=>r.shareableWith?.some(n=>e.includes(n))&&!(r.ownerData?.teamId&&e.includes(r.ownerData.teamId)))}));y(this,On,z(()=>f(i(this,ar)).filter(e=>e.isAvailable)))}get loading(){return f(i(this,me))}get error(){return f(i(this,he))}get isInitialized(){return f(i(this,ls))}get isRealtimeActive(){return f(i(this,qn))}get count(){return i(this,pe).size}get materiels(){return f(i(this,ar))}get loans(){return f(i(this,Ai))}get teamMateriels(){return f(i(this,_i))}get shareableMateriels(){return f(i(this,Ri))}get availableMateriels(){return f(i(this,On))}getAvailableMaterielsByOwner(e){return f(i(this,On)).filter(r=>r.ownerData?.teamId===e&&r.status!=="lost"&&r.status!=="torepair")}getMaterielsByOwner(e){return f(i(this,ar)).filter(r=>r.ownerData?.teamId===e)}getAvailableMaterielsForPeriod(e,r,s,n){const a=new Date(r),o=new Date(s),c=Array.from(i(this,we).values());return f(i(this,ar)).filter(l=>l.ownerData?.teamId===e).filter(l=>l.status!=="lost"&&l.status!=="torepair").map(l=>{const u=Pm(l.$id,c,a,o,n),d=l.quantity-u;return{...l,availableForPeriod:d}}).filter(l=>l.availableForPeriod>0)}async loadCache(){if(!f(i(this,ls))){m(i(this,me),!0),m(i(this,he),null);try{if(!k.userId){m(i(this,ls),!0);return}I(this,ne,await Em()),await b(this,oe,rd).call(this),m(i(this,ls),!0),console.log(`[MaterielStore] Cache chargÃ© : ${i(this,pe).size} matÃ©riels, ${i(this,we).size} emprunts`)}catch(e){throw m(i(this,he),e instanceof Error?e.message:"Erreur de chargement du cache",!0),console.error("[MaterielStore] LoadCache error:",e),e}finally{m(i(this,me),!1)}}}async syncFromRemote(){m(i(this,me),!0),m(i(this,he),null);try{if(!k.userId)return;await b(this,oe,sd).call(this),console.log(`[MaterielStore] Sync terminÃ© : ${i(this,pe).size} matÃ©riels, ${i(this,we).size} emprunts`)}catch(e){throw m(i(this,he),e instanceof Error?e.message:"Erreur de synchronisation",!0),console.error("[MaterielStore] SyncFromRemote error:",e),e}finally{m(i(this,me),!1)}}async setupRealtime(){if(k.isAuthenticated){if(i(this,Rr)&&be.isInitialized){console.log("[MaterielStore] Realtime dÃ©jÃ  configurÃ©");return}i(this,Rr)&&!be.isInitialized&&(console.log("[MaterielStore] RealtimeManager dÃ©truit, rÃ©initialisation..."),I(this,Rr,!1));try{await b(this,oe,ad).call(this),m(i(this,qn),!0),I(this,Rr,!0),console.log("[MaterielStore] Realtime configurÃ©")}catch(e){throw m(i(this,he),e instanceof Error?e.message:"Erreur de configuration realtime",!0),console.error("[MaterielStore] SetupRealtime error:",e),e}}}async initialize(){await this.loadCache(),await this.syncFromRemote(),await this.setupRealtime()}getMaterielById(e){return i(this,pe).get(e)}getLoanById(e){return i(this,we).get(e)}async createMateriel(e){m(i(this,me),!0),m(i(this,he),null);try{if(!k.userId)throw new Error("Utilisateur non connectÃ©");const r=await hm(e,k.userId),s=b(this,oe,Ps).call(this,r);return i(this,pe).set(r.$id,s),i(this,ne)?.upsertMateriel(s),s}catch(r){throw m(i(this,he),r instanceof Error?r.message:"Erreur de crÃ©ation",!0),r}finally{m(i(this,me),!1)}}async updateMateriel(e,r){m(i(this,me),!0),m(i(this,he),null);try{const s=await Oa(e,r),n=b(this,oe,Ps).call(this,s);i(this,pe).set(s.$id,n),i(this,ne)?.upsertMateriel(n)}catch(s){throw m(i(this,he),s instanceof Error?s.message:"Erreur de mise Ã  jour",!0),s}finally{m(i(this,me),!1)}}async deleteMateriel(e){m(i(this,me),!0),m(i(this,he),null);try{await pm(e),i(this,pe).delete(e),i(this,ne)?.deleteMateriel(e)}catch(r){throw m(i(this,he),r instanceof Error?r.message:"Erreur de suppression",!0),r}finally{m(i(this,me),!1)}}async createLoan(e){m(i(this,me),!0),m(i(this,he),null);try{if(!k.userId)throw new Error("Utilisateur non connectÃ©");const r=await gm(e,k.userId);return pn(r)}catch(r){throw m(i(this,he),r instanceof Error?r.message:"Erreur de crÃ©ation",!0),r}finally{m(i(this,me),!1)}}async updateLoan(e,r){m(i(this,me),!0),m(i(this,he),null);try{await ym(e,r)}catch(s){throw m(i(this,he),s instanceof Error?s.message:"Erreur de mise Ã  jour",!0),s}finally{m(i(this,me),!1)}}async acceptLoan(e){await this.updateLoan(e,{status:"accepted"})}async refuseLoan(e){await this.updateLoan(e,{status:"refused"})}async cancelLoan(e){await this.updateLoan(e,{status:"canceled"})}async completeLoanWithReturn(e,r){for(const s of r.materiels){const n=s.lostQuantity||0,a=s.brokenQuantity||0;n+a>=s.quantity?await Oa(s.materielId,{status:"lost"}):a>0?await Oa(s.materielId,{status:"torepair"}):await Oa(s.materielId,{status:"ok"})}await this.updateLoan(e,{status:"completed",returnedAt:new Date().toISOString(),returnNotes:r.returnNotes,materiels:r.materiels})}async completeLoan(e){await this.updateLoan(e,{status:"completed",returnedAt:new Date().toISOString()})}async deleteLoan(e){m(i(this,me),!0),m(i(this,he),null);try{const r=i(this,we).get(e);r&&b(this,oe,Ds).call(this,r),await wm(e)}catch(r){throw m(i(this,he),r instanceof Error?r.message:"Erreur de suppression",!0),r}finally{m(i(this,me),!1)}}async hardReset(){console.log("[MaterielStore] ð HARD RESET - Vidage complet..."),m(i(this,me),!0),m(i(this,he),null);try{if(i(this,pe).clear(),i(this,we).clear(),i(this,ne)&&(await i(this,ne).clear(),console.log("[MaterielStore] Cache IDB vidÃ©")),await b(this,oe,nd).call(this),i(this,ne)){for(const[,e]of i(this,pe))await i(this,ne).upsertMateriel(e);for(const[,e]of i(this,we))await i(this,ne).upsertLoan(e);await i(this,ne).saveMetadata({lastSyncMateriel:f(i(this,Ot)),lastSyncLoans:f(i(this,Ut))}),console.log("[MaterielStore] Cache IDB recrÃ©Ã©")}console.log("[MaterielStore] â HARD RESET terminÃ©")}catch(e){const r=e instanceof Error?e.message:"Erreur lors du hard reset";throw m(i(this,he),r,!0),console.error("[MaterielStore] Erreur hard reset:",e),e}finally{m(i(this,me),!1)}}destroy(){var e;(e=i(this,Ii))==null||e.call(this),i(this,pe).clear(),i(this,we).clear(),I(this,ne,null),I(this,Rr,!1)}}pe=new WeakMap,we=new WeakMap,ne=new WeakMap,me=new WeakMap,he=new WeakMap,ls=new WeakMap,qn=new WeakMap,Rr=new WeakMap,Ot=new WeakMap,Ut=new WeakMap,Ii=new WeakMap,ar=new WeakMap,Ai=new WeakMap,_i=new WeakMap,Ri=new WeakMap,On=new WeakMap,oe=new WeakSet,rd=async function(){if(i(this,ne))try{(await i(this,ne).loadMateriels()).forEach(n=>{i(this,pe).set(n.$id,n)}),(await i(this,ne).loadLoans()).forEach(n=>{const a=pn(n);i(this,we).set(n.$id,a)});const s=await i(this,ne).loadMetadata();m(i(this,Ot),s.lastSyncMateriel,!0),m(i(this,Ut),s.lastSyncLoans,!0),console.log(`[MaterielStore] ${i(this,pe).size} matÃ©riels et ${i(this,we).size} emprunts chargÃ©s du cache IDB`)}catch(e){console.warn("[MaterielStore] Erreur lecture cache IDB, ignorÃ©:",e)}},sd=async function(){try{const e=f(i(this,Ot))?[S.greaterThan("$updatedAt",f(i(this,Ot)))]:[],r=await al(e);for(const a of r){const o=b(this,oe,Ps).call(this,a);i(this,pe).set(a.$id,o),i(this,ne)?.upsertMateriel(o)}m(i(this,Ot),new Date().toISOString(),!0);const s=f(i(this,Ut))?[S.greaterThan("$updatedAt",f(i(this,Ut))),S.limit(100)]:[],n=await il(s);for(const a of n){const o=pn(a);i(this,we).set(a.$id,o),i(this,ne)?.upsertLoan(a),b(this,oe,Ds).call(this,o)}m(i(this,Ut),new Date().toISOString(),!0),await i(this,ne)?.saveMetadata({lastSyncMateriel:f(i(this,Ot)),lastSyncLoans:f(i(this,Ut))}),console.log("[MaterielStore] Sync terminÃ©")}catch(e){throw console.error("[MaterielStore] Erreur sync:",e),e}},nd=async function(){try{console.log("[MaterielStore] Chargement complet depuis Appwrite...");const e=await al([S.limit(1e3)]);for(const n of e){const a=b(this,oe,Ps).call(this,n);i(this,pe).set(n.$id,a)}const r=await il([S.limit(1e3)]),s=[];for(const n of r){const a=pn(n);i(this,we).set(n.$id,a),s.push(a)}for(const n of s)b(this,oe,Ds).call(this,n);m(i(this,Ot),new Date().toISOString(),!0),m(i(this,Ut),new Date().toISOString(),!0),console.log(`[MaterielStore] ${e.length} matÃ©riels et ${r.length} emprunts chargÃ©s`)}catch(e){throw console.error("[MaterielStore] Erreur chargement complet:",e),e}},ad=async function(){be.register(mm(),async e=>{await b(this,oe,id).call(this,e)}),be.register(vm(),async e=>{await b(this,oe,od).call(this,e)})},id=async function(e){try{const r=e.events,s=e.payload;if(!s){console.warn("[MaterielStore] Realtime Materiel : pas de payload dans la rÃ©ponse");return}const n=r.some(a=>a.includes(".create"))?"create":r.some(a=>a.includes(".delete"))?"delete":"update";if(console.log(`[MaterielStore] â¡ï¸ Realtime Materiel RECEIVED: ${n} pour ${s.$id}`),n==="create"||n==="update"){const a=b(this,oe,Ps).call(this,s);i(this,pe).set(s.$id,a),i(this,ne)?.upsertMateriel(a)}else n==="delete"&&(i(this,pe).delete(s.$id),i(this,ne)?.deleteMateriel(s.$id))}catch(r){console.error("[MaterielStore] Erreur realtime Materiel:",r)}},od=async function(e){try{const r=e.events,s=e.payload;if(!s){console.warn("[MaterielStore] Realtime Loan : pas de payload dans la rÃ©ponse");return}const n=r.some(a=>a.includes(".create"))?"create":r.some(a=>a.includes(".delete"))?"delete":"update";if(console.log(`[MaterielStore] â¡ï¸ Realtime Loan RECEIVED: ${n} pour ${s.$id}`),n==="create"||n==="update"){const a=pn(s);i(this,we).set(s.$id,a),i(this,ne)?.upsertLoan(s),b(this,oe,Ds).call(this,a)}else if(n==="delete"){const a=i(this,we).get(s.$id);a&&b(this,oe,Ds).call(this,a),i(this,we).delete(s.$id),i(this,ne)?.deleteLoan(s.$id)}}catch(r){console.error("[MaterielStore] Erreur realtime Loan:",r)}},Ps=function(e){const r=Array.from(i(this,we).values());return td(e,r)},Ds=function(e){const r=e.materielItems,s=Array.from(i(this,we).values());for(const n of r){const a=i(this,pe).get(n.materielId);if(a){const o=Am(a,s);i(this,pe).set(n.materielId,o),i(this,ne)?.upsertMateriel(o)}}};const cl=new Dm,Ui="teamdocs";async function Mm(){try{const{tables:t,config:e}=await D();return(await t.listRows({databaseId:e.databaseId,tableId:Ui})).rows}catch(t){throw console.error("[appwrite-teamdocs] Error listing documents:",t),t}}async function $m(t,e,r,s){try{const{tables:n,config:a}=await D(),o=[te.read(ie.team(e)),te.update(ie.team(e)),te.delete(ie.team(e))],c=await n.createRow({databaseId:a.databaseId,tableId:Ui,rowId:yt.unique(),data:{...t,teamId:e,createdBy:r},permissions:o});return console.log(`[appwrite-teamdocs] Document created: ${c.$id}`),c}catch(n){throw console.error("[appwrite-teamdocs] Error creating document:",n),n}}async function cd(t,e){try{const{tables:r,config:s}=await D(),n=await r.updateRow({databaseId:s.databaseId,tableId:Ui,rowId:t,data:e});return console.log(`[appwrite-teamdocs] Document updated: ${t}`),n}catch(r){throw console.error(`[appwrite-teamdocs] Error updating document ${t}:`,r),r}}async function km(t){try{const{tables:e,config:r}=await D();await e.deleteRow({databaseId:r.databaseId,tableId:Ui,rowId:t}),console.log(`[appwrite-teamdocs] Document deleted: ${t}`)}catch(e){throw console.error(`[appwrite-teamdocs] Error deleting document ${t}:`,e),e}}async function Cm(t,e){try{await cd(t,{lockedBy:e}),console.log(`[appwrite-teamdocs] Lock ${t} mis Ã  jour: ${e||"libÃ©rÃ©"}`)}catch(r){throw console.error(`[appwrite-teamdocs] Erreur verrouillage ${t}:`,r),r}}var Le,xs,Pr,ir,Dr,Hs,Mr,Un,us,Vs,it,ld,ud,Xr;class Tm{constructor(){y(this,it);y(this,Le,new gt);y(this,xs,new gt);y(this,Pr,P(!1));y(this,ir,P(null));y(this,Dr,P(!1));y(this,Hs,P(!1));y(this,Mr,!1);y(this,Un,P(null));y(this,us,null);y(this,Vs,z(()=>Array.from(i(this,Le).values())))}get loading(){return f(i(this,Pr))}get error(){return f(i(this,ir))}get isInitialized(){return f(i(this,Dr))}get isRealtimeActive(){return f(i(this,Hs))}get count(){return i(this,Le).size}get documents(){return f(i(this,Vs))}getTeamDocuments(e){return f(i(this,Vs)).filter(r=>r.teamId===e)}getTeamTags(e){return i(this,xs).get(e)||[]}async loadCache(){if(!f(i(this,Dr))){m(i(this,Pr),!0),m(i(this,ir),null);try{if(!k.userId){m(i(this,Dr),!0);return}m(i(this,Dr),!0),console.log("[TeamdocsStore] Cache chargÃ© (sans IDB)")}catch(e){throw m(i(this,ir),e instanceof Error?e.message:"Erreur de chargement du cache",!0),console.error("[TeamdocsStore] LoadCache error:",e),e}finally{m(i(this,Pr),!1)}}}async syncFromRemote(){m(i(this,Pr),!0),m(i(this,ir),null);try{if(!k.userId)return;const e=await Mm();for(const r of e)i(this,Le).set(r.$id,r);await b(this,it,Xr).call(this),m(i(this,Un),new Date().toISOString(),!0),console.log(`[TeamdocsStore] Sync terminÃ© : ${i(this,Le).size} documents`)}catch(e){throw m(i(this,ir),e instanceof Error?e.message:"Erreur de synchronisation",!0),console.error("[TeamdocsStore] SyncFromRemote error:",e),e}finally{m(i(this,Pr),!1)}}async setupRealtime(){if(k.isAuthenticated){if(i(this,Mr)&&be.isInitialized){console.log("[TeamdocsStore] Realtime dÃ©jÃ  configurÃ©");return}i(this,Mr)&&!be.isInitialized&&(console.log("[TeamdocsStore] RealtimeManager dÃ©truit, rÃ©initialisation..."),I(this,Mr,!1));try{await b(this,it,ld).call(this),m(i(this,Hs),!0),I(this,Mr,!0),console.log("[TeamdocsStore] Realtime configurÃ©")}catch(e){throw m(i(this,ir),e instanceof Error?e.message:"Erreur de configuration realtime",!0),console.error("[TeamdocsStore] SetupRealtime error:",e),e}}}async initialize(){await this.loadCache(),await this.syncFromRemote(),await this.setupRealtime()}async createDocument(e,r){if(!k.userId||!k.userName)throw new Error("Utilisateur non connectÃ©");const s=await $m(e,r,k.userId,k.userName);return i(this,Le).set(s.$id,s),await b(this,it,Xr).call(this),console.log(`[TeamdocsStore] Document crÃ©Ã© : ${s.$id}`),s}async updateDocument(e,r){const s=await cd(e,r);return i(this,Le).set(e,s),r.tags&&await b(this,it,Xr).call(this),console.log(`[TeamdocsStore] Document mis Ã  jour : ${e}`),s}async deleteDocument(e){await km(e),i(this,Le).delete(e),await b(this,it,Xr).call(this),console.log(`[TeamdocsStore] Document supprimÃ© : ${e}`)}getDocumentById(e){return i(this,Le).get(e)}async updateDocumentLock(e,r){if(k.userId)try{await Cm(e,r);const s=i(this,Le).get(e);s&&i(this,Le).set(e,{...s,lockedBy:r}),console.log(`[TeamdocsStore] Verrou ${e} mis Ã  jour: ${r||"libÃ©rÃ©"}`)}catch(s){throw console.error(`[TeamdocsStore] Erreur verrouillage ${e}:`,s),s}}destroy(){i(this,us)&&(i(this,us).call(this),I(this,us,null)),i(this,Le).clear(),i(this,xs).clear(),m(i(this,Dr),!1),m(i(this,Hs),!1),I(this,Mr,!1),console.log("[TeamdocsStore] Store dÃ©truit")}async hardReset(){this.destroy(),m(i(this,Un),null),console.log("[TeamdocsStore] Hard reset effectuÃ©")}}Le=new WeakMap,xs=new WeakMap,Pr=new WeakMap,ir=new WeakMap,Dr=new WeakMap,Hs=new WeakMap,Mr=new WeakMap,Un=new WeakMap,us=new WeakMap,Vs=new WeakMap,it=new WeakSet,ld=async function(){const e=["databases.*.collections.undefined"];be.register(e,async r=>{await b(this,it,ud).call(this,r)}),I(this,us,()=>{})},ud=async function(e){const{events:r,payload:s}=e,n=r?.[0];if(!n)return;const a=s;switch(n){case"databases.*.collections.*.documents.create":case"databases.*.collections.*.documents.update":a&&(i(this,Le).set(a.$id,a),await b(this,it,Xr).call(this),console.log(`[TeamdocsStore] Document mis Ã  jour : ${a.$id}`));break;case"databases.*.collections.*.documents.delete":a?.$id&&(i(this,Le).delete(a.$id),await b(this,it,Xr).call(this),console.log(`[TeamdocsStore] Document supprimÃ© : ${a.$id}`));break}},Xr=async function(){const e=new Map;for(const r of f(i(this,Vs))){const s=r.teamId;e.has(s)||e.set(s,new Set),r.tags&&r.tags.forEach(n=>{e.get(s).add(n)})}e.forEach((r,s)=>{i(this,xs).set(s,Array.from(r).sort())}),console.log(`[TeamdocsStore] Tags mis Ã  jour pour ${e.size} Ã©quipes`)};const ll=new Tm;var Bn,Ws,Gs,Qr,dd,fd,hd;class Nm{constructor(){y(this,Qr);y(this,Bn,P(!1));y(this,Ws,!1);y(this,Gs,[])}async initialize(){const e=k.userId;if(!e){console.error("[NotificationStore] No userId found, cannot initialize");return}const r=dt();try{const n=await(await D()).tables.getRow({databaseId:r,tableId:"user_notifications",rowId:e});I(this,Gs,JSON.parse(n.notifications||"[]")),console.log(`[NotificationStore] User row found for ${e}`)}catch(s){if(s.code===404)console.log(`[NotificationStore] User row not found, creating lazy init for ${e}`),await b(this,Qr,hd).call(this,e),I(this,Gs,[]);else throw console.error("[NotificationStore] Error fetching user row:",s),s}await this.setupRealtime()}async setupRealtime(){if(i(this,Ws)){console.log("[NotificationStore] Already initialized, skipping.");return}try{console.log("[NotificationStore] Setting up realtime...");const e=dt();be.register([`databases.${e}.collections.user_notifications.documents`],async r=>await b(this,Qr,dd).call(this,r)),m(i(this,Bn),!0),I(this,Ws,!0),console.log("[NotificationStore] â Realtime configured (RealtimeManager)")}catch(e){throw console.error("[NotificationStore] Error configuring realtime:",e),e}}destroy(){m(i(this,Bn),!1),I(this,Ws,!1),I(this,Gs,[]),console.log("[NotificationStore] Store destroyed")}}Bn=new WeakMap,Ws=new WeakMap,Gs=new WeakMap,Qr=new WeakSet,dd=async function(e){console.log("[NotificationStore] ð¨ Raw realtime event:",{events:e.events,channels:e.channels,payload:e.payload});const r=e.payload,s=k.userId,n=k.currentMainId;if(console.log("[NotificationStore] ð Context check:",{payloadScope:r.scope,payloadId:r.$id,currentUserId:s,currentMainId:n}),r.scope==="event"&&!n){console.log("[NotificationStore] â ï¸ Ignored: event scope but no currentMainId");return}if(r.scope==="user"){if(r.$id!==s){console.log("[NotificationStore] â ï¸ Ignored: user ID mismatch");return}}else if(r.scope==="event"){if(r.$id!==n){console.log("[NotificationStore] â ï¸ Ignored: event ID mismatch");return}}else{console.log("[NotificationStore] â ï¸ Ignored: invalid scope");return}if(console.log("[NotificationStore] â Event passed filters, processing..."),e.events.some(a=>a.includes(".update")||a.includes(".create"))){console.log("[NotificationStore] â Update/Create event detected");const a=JSON.parse(r.notifications||"[]");console.log("[NotificationStore] ð Notifications to process:",a);for(const o of a)await b(this,Qr,fd).call(this,o)}else console.log("[NotificationStore] â ï¸ Ignored: unexpected event type",e.events)},fd=async function(e){switch(console.log("[NotificationStore] ð Processing notification:",e),e.type){case"team_access_granted":await vt.reload(),Ke.success("Nouvelle Ã©quipe ajoutÃ©e");break;case"event_access_granted":console.log("[NotificationStore] ð event_access_granted received");const r=e.targetDocumentId;await Ze.fetchEvent(r)?(console.log(`[NotificationStore] â Event ${r} fetched successfully`),Ke.success("Nouvel Ã©vÃ©nement disponible")):(console.log(`[NotificationStore] â ï¸ Failed to fetch ${r}, falling back to reload()`),await Ze.reload(),Ke.success("Nouvel Ã©vÃ©nement disponible"));break;case"batch_products_update":console.log("[NotificationStore] ð batch_products_update received"),e.targetDocumentId===k.currentMainId?(console.log("[NotificationStore] â Calling productsStore.syncFromAppwrite()"),await Gd.syncFromAppwrite(),e.from&&e.from!==k.userId&&(e.from==="system"?Ke.info("Produits mis Ã  jour",{source:"system"}):Ke.info("Produits modifiÃ©s par un autre utilisateur",{source:"realtime-other"}))):console.log("[NotificationStore] â ï¸ Ignored: mainId mismatch",{notificationTarget:e.targetDocumentId,currentMain:k.currentMainId});break;default:console.log("[NotificationStore] â Unknown notification type:",e.type)}},hd=async function(e){const r=dt();await(await D()).tables.createRow({databaseId:r,tableId:"user_notifications",rowId:e,data:{scope:"user",notifications:JSON.stringify([])},permissions:[te.read(ie.user(e)),te.update(ie.user(e))]}),console.log(`[NotificationStore] User row created for ${e}`)};const Lm=new Nm;function fi(t,e){if(e)for(const r in e)t=t.replace(`:${r}`,String(e[r]));return ue.name==="#"?t==="/"?"/#/":hi("#",t):ue.name?hi(ue.name,t):t}function jm(t,e){let r=fi(t,e?.params);return e?.search&&(r+=Wo(e.search)),e?.hash&&!e.hash.startsWith("#")&&(r+="#"+e.hash),r}function pd(t){return Promise.all(t.map(e=>qm(e)))}function qm(t){return new Promise(e=>{Om(t)?Promise.resolve(t()).then(r=>{e(r.default)}):e(t)})}function Om(t){return typeof t=="function"&&!!/\(\)\s?=>\s?(import|__vite_ssr_dynamic_import__)\(.*\)/.test(String(t))}function hi(...t){let e="";for(let r of t)r.startsWith("/")||(e+="/"),r.endsWith("/")&&(r=r.slice(0,-1)),e+=r;return e}function Ho(t){return ue.name&&t.startsWith(ue.name)&&(t=t.slice(ue.name.length)||"/"),t}function Vo(){const t=ue.name==="#"?globalThis.location.hash.slice(1):globalThis.location.pathname,e=ue.name==="#"?"":globalThis.location.hash;return{pathname:t,search:globalThis.location.search,state:history.state,hash:e}}function Wo(t){if(!t)return;if(typeof t=="string")return t.startsWith("?")||(t="?"+t),t;const e=Object.fromEntries(Object.entries(t).map(([s,n])=>[s,String(n)]));return Object.keys(e).length===0?void 0:"?"+new URLSearchParams(e).toString()}function Go(t){if(!t)return{};if(typeof t=="string"){const e=new URLSearchParams(t);return Object.fromEntries([...e.entries()].map(([r,s])=>[r,vn(s)]))}return t}function vn(t){if(t==="")return"";if(t==="true")return!0;if(t==="false")return!1;const e=Number(t);return Number.isNaN(e)?t:e}function po(t,e){return md((r,s)=>r===s,t,e)}po.startsWith=(t,e)=>md((r,s)=>r.startsWith(s),t,e);function md(t,e,r){if(!e.includes(":"))return t(Ae.pathname,e);if(r)return ue.name==="#"?t(Ae.pathname,fi(e,r).replace("/#","")):t(Ae.pathname,fi(e,r));const s=e.split("/").slice(1);let n=Ae.pathname.split("/").slice(1);if(s.length>n.length)return!1;for(const[a,o]of s.entries()){const c=n[a];if(!o.startsWith(":")&&o!==c)return!1}return!0}function Qo(t,e){t.length>1&&t.endsWith("/")&&(t=t.slice(0,-1));const r=t.split("/").slice(1),s=Um(Object.keys(e));let n,a=[],o=[],c={},l={};const u=e["/"];u&&typeof u=="object"&&"meta"in u&&u.meta&&(l={...l,...u.meta});let d=!1;e:for(const h of s){const p=h.split("/");p[0]===""&&p.shift();for(let[g,w]of p.entries()){d=w.startsWith("(")&&w.endsWith(")"),d&&(w=w.slice(1,-1));const _=r[g];if(w.startsWith(":"))c[w.slice(1)]=decodeURIComponent(_);else if(w.startsWith("*")){const H=w.slice(1);H&&(c[H]=r.slice(g).map(decodeURIComponent).join("/")),d?(w=`(${w})`,a=[]):"layout"in e&&e.layout&&a.push(e.layout);const B=(g?"/":"")+p.join("/");n=e[B];break e}else if(w.toLowerCase()!==_?.toLowerCase())break;if(g!==p.length-1)continue;const E=e["/"+p.join("/")];if(typeof E=="function"&&p.length!==r.length)continue;if(!d&&"layout"in e&&e.layout&&a.push(e.layout),"hooks"in e&&e.hooks&&o.push(e.hooks),"meta"in e&&e.meta&&(l={...l,...e.meta}),typeof E=="function"){if(p.length===r.length){n=E;break e}continue}const A="/"+r.slice(g+1).join("/"),M=Qo(A,E);if(M.match)n=M.match,c={...c,...M.params},o.push(...M.hooks),l={...l,...M.meta},M.breakFromLayouts?a=[]:a.push(...M.layouts);else continue;break e}}return{match:n,layouts:a,hooks:o,params:c,meta:l,breakFromLayouts:d}}function Um(t){return t.toSorted((e,r)=>ul(e)-ul(r))}function ul(t){return t===""||t==="/"?1:t.includes("*")?4:t.includes(":")?3:2}const Bm=200,xm=Math.PI/6,Hm=50;async function gd(t,e,r){const{match:s,layouts:n,hooks:a,meta:o}=Qo(e,t);for(const{onPreload:c}of a)c?.({pathname:e,meta:o,...r,search:Go(r?.search)});await pd(s?[...n,s]:n)}const dl=new Set,Is=new Set;function Vm(t){function e(o){if(!o.getAttribute("href"))return;const l=new URL(o.href),u=Ho(l.pathname),{replace:d,state:h}=o.dataset;gd(t,u,{replace:d===""||d==="true",search:l.search,state:h,hash:l.hash})}let r=null;function s(o){if(!o.getPredictedEvents||r)return;if(r=setTimeout(()=>{r=null},Hm),Is.size===0){document.removeEventListener("pointermove",s);return}const l=o.getPredictedEvents().at(-1);if(!l)return;const u=o.clientX,d=o.clientY,h=l.clientX-u,p=l.clientY-d,g=Math.hypot(h,p);if(g<2)return;const w=h/g,_=p/g;e:for(const E of Is){E.isConnected||Is.delete(E);const A=E.getBoundingClientRect(),M=[{x:A.left,y:A.top},{x:A.right,y:A.top},{x:A.left,y:A.bottom},{x:A.right,y:A.bottom},{x:A.left+A.width/2,y:A.top+A.height/2}];for(const H of M){const B=H.x-u,Q=H.y-d,N=Math.hypot(B,Q);if(N>Bm||N<.001)continue;const O=B/N,F=Q/N,se=w*O+_*F;if(Math.acos(Math.max(-1,Math.min(1,se)))<=xm){e(E),Is.delete(E);continue e}}}}const n=new IntersectionObserver(o=>{for(const c of o)c.isIntersecting&&(n.unobserve(c.target),e(c.target))});new MutationObserver(()=>{const o=document.querySelectorAll("a[data-preload]");for(const c of o)if(!dl.has(c)){switch(dl.add(c),c.dataset.preload){case"":case"hover":{c.addEventListener("mouseenter",function l(){c.removeEventListener("mouseenter",l),e(c)});break}case"predict":{Is.size===0&&document.addEventListener("pointermove",s),Is.add(c);break}case"viewport":{n.observe(c);break}default:{console.warn(`Unknown preload strategy \`${c.dataset.preload}\` on`,c,`
Available strategies are: hover, viewport, predict`);break}}c.addEventListener("focus",function l(){c.removeEventListener("focus",l),e(c)})}}).observe(document.body,{subtree:!0,childList:!0})}class fl extends Error{constructor(e){super(`Navigating to: ${e}`),this.name="Redirect"}}let Ie=new zh(globalThis.location.search);const Wm={append(t,e,r){Ie.append(t,String(e)),Ua(r)},delete(t,e,r){Ie.delete(t,e===void 0?void 0:String(e)),Ua(r)},entries(){return[...Ie.entries()].map(([t,e])=>[t,vn(e)])},forEach(...t){return Ie.forEach(...t)},get(...t){const e=Ie.get(...t);return e===null?null:vn(e)},getAll(...t){return Ie.getAll(...t).map(vn)},has(...t){return Ie.has(...t)},keys(){return Ie.keys()},set(t,e,r){Ie.set(t,String(e)),Ua(r)},sort(t){Ie.sort(),Ua(t)},toString(){return Ie.toString()},values(){return[...Ie.values()].map(vn)},get size(){return Ie.size},[Symbol.iterator](){return Ie[Symbol.iterator]()}};function hl(t){if(Ie.toString()===t)return;const e=new URLSearchParams(t);for(const[r,s]of e)Ie.set(r,s);for(const r of Ie.keys())e.has(r)||Ie.delete(r)}function Ua(t){const e=new URL(globalThis.location.toString());e.search=Ie.toString(),globalThis.history[t?.replace?"replaceState":"pushState"]({},"",e)}let Sn;const ue={name:void 0};let mo=ge({value:[]}),Ae=ge({pathname:"/",search:"",state:null,hash:""});queueMicrotask(()=>{const t=Vo();Ae.pathname=t.pathname,Ae.search=t.search,Ae.state=t.state,Ae.hash=t.hash});let go=ge({value:{}}),yd=ge({value:{}}),Xa=null,Xi=0,pl=0;function Gm(t){if(t){const e=new URL(globalThis.location.toString());t==="#"?(ue.name="#",globalThis.location.href.includes("#")||(e.hash="/",history.replaceState(history.state||{},"",e.toString()))):(ue.name=(t.startsWith("/")?"":"/")+t,e.pathname.startsWith(ue.name)||(e.pathname=hi(ue.name,e.pathname),history.replaceState(history.state||{},"",e.toString())))}Object.assign(Ae,Vo())}function Qm(t){return Sn=t,Vm(Sn),{p:jm,navigate:Jm,isActive:po,async preload(e){await gd(Sn,e)},route:{get params(){return go.value},getParams(e){if(!po(e))throw new Error(`\`${e}\` does not match the current route`);return go.value},get pathname(){return Ho(Ae.pathname)},get search(){return Go(Ae.search)},get state(){return Ae.state},get hash(){return Ae.hash},get meta(){return yd.value}}}}function Jm(t,e={}){return typeof t=="number"?(globalThis.history.go(t),new fl(`History entry: ${t}`)):(t=fi(t,e.params),ue.name==="#"?t=t.replace("/#",""):e.hash&&!e.hash.startsWith("#")&&(e.hash="#"+e.hash),pi(t,e),new fl(`${t}${Wo(e?.search??"")}${e?.hash??""}`))}async function pi(t,e={}){if(!Sn)throw new Error("Router not initialized: `createRouter` was not called.");if(Xa){if(!Xa()){const w=new URL(globalThis.location.toString());w.search=Ae.search,w.hash=Ae.hash,ue.name==="#"?w.hash=Ae.pathname:w.pathname=Ae.pathname,globalThis.history.replaceState(Rs(Ae.state)||{},"",w.toString());return}Xa=null}Xi++;const r=Xi,s=Km(t),{match:n,layouts:a,hooks:o,meta:c,params:l}=Qo(s,Sn),u=Go(e.search),d={pathname:s,meta:c,...e,search:u};let h=[];for(const w of o)try{const{beforeLoad:_}=w;h.push(w),pl=r,await _?.(d)}catch(_){for(const{onError:E}of h)E?.(_,d);return}const p=new Error().stack?.includes("beforeLoad");let g;try{g=await pd(n?[...a,n]:a)}catch(w){for(const{onError:_}of o)_?.(w,d);throw w}if(!(Xi!==r||p&&pl+1!==r)){if(t){const w=Wo(e.search),_=new URL(globalThis.location.toString());_.search=w||"",_.hash=e.hash||"",ue.name==="#"?_.hash=t:ue.name&&!t.startsWith(ue.name)?_.pathname=hi(ue.name,t):_.pathname=t;const E=e.replace?"replaceState":"pushState";globalThis.history[E](e.state||{},"",_.toString()),hl(w)}else hl(globalThis.location.search);e.viewTransition&&document.startViewTransition!==void 0?document.startViewTransition(()=>{mo.value=g}):mo.value=g,go.value=l,yd.value=c,Object.assign(Ae,Vo()),e.scrollToTop!==!1&&window.scrollTo({top:0,left:0,behavior:e.scrollToTop});for(const{afterLoad:w}of o)w?.(d)}}function Km(t){let e;return t?e=t:ue.name==="#"?e=globalThis.location.hash.slice(1):e=globalThis.location.pathname,ue.name&&e.startsWith(ue.name)&&(e=e.slice(ue.name.length)||"/"),Ho(e)}function Ym(t){const e=t.target.closest("a");if(!e||e.hasAttribute("target")||e.hasAttribute("download")||!e.hasAttribute("href")||e.getAttribute("href")?.startsWith("#"))return;const r=new URL(e.href),s=globalThis.location.origin;if(r.origin!==s)return;const n=ue.name==="#"?r.hash:r.pathname,a=ue.name==="#"?void 0:r.hash;t.preventDefault();const{replace:o,state:c,scrollToTop:l,viewTransition:u}=e.dataset;let d;if(c)try{d=JSON.parse(c)}catch{d=c}pi(n,{replace:o===""||o==="true",search:r.search,state:d,hash:a,scrollToTop:l==="false"?!1:l,viewTransition:u===""||u==="true"})}function Xm(t){Xa=t}function wd(t,e){Ro(e,!0);const r=z(()=>e.tree[0]),s=z(()=>e.tree.slice(1));var n=vc(),a=pc(n);_h(a,()=>f(r),(o,c)=>{c(o,{children:(l,u)=>{var d=vc(),h=pc(d);{var p=g=>{wd(g,{get tree(){return f(s)}})};Eh(h,g=>{f(s).length>0&&g(p)})}bc(l,d)},$$slots:{default:!0}})}),bc(t,n),Po()}function Zm(t,e){Ro(e,!0),Gm(e.base),pi(),Vr(()=>{const r=Fs(globalThis,"popstate",()=>pi()),s=Fs(globalThis,"click",Ym);return()=>{r(),s()}}),wd(t,{get tree(){return mo.value}}),Po()}const Xt={async beforeLoad({pathname:t}){if(!k.isAuthenticated){console.log(`[AuthGuard] AccÃ¨s refusÃ© Ã  ${t} > Redirection /`);const{navigate:e}=await W(async()=>{const{navigate:r}=await Promise.resolve().then(()=>ng);return{navigate:r}},void 0);throw e("/",{replace:!0})}}},zm={async beforeLoad(){Ze.isInitialized||(k.isAuthenticated?(console.log("[EventGuard] Mode normal > initialize"),await Ze.initialize()):(console.log("[EventGuard] Mode public > initializeForPublic"),await Ze.initializeForPublic())),console.log("[EventGuard] â Store initialisÃ©")}},Fm={"/":()=>W(()=>import("./HomePage.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])),"/verify-email":()=>W(()=>import("./VerifyEmailPage.js"),__vite__mapDeps([8,1,2,3])),"/recipe":()=>W(()=>import("./RecipesListPage.js"),__vite__mapDeps([9,2,10,11,12,13,14,15,16,17,1,3])),"/recipe/:uuid":()=>W(()=>import("./RecipeDetailPage.js"),__vite__mapDeps([18,15,19,20,2,10,21,5,22,23,1,3])),"/accept-invite":()=>W(()=>import("./AcceptInvite.js"),__vite__mapDeps([24,1,2,3])),"/reset-password":()=>W(()=>import("./ResetPassword.js"),__vite__mapDeps([25,2,26])),"/dashboard":{hooks:Xt,"/":()=>W(()=>import("./DashboardPage.js"),__vite__mapDeps([27,1,2,3,28,29,30,31,32,20,33,34,35,6])),"/user":()=>W(()=>import("./UserPage.js"),__vite__mapDeps([36,2])),"/teams":()=>W(()=>import("./TeamsManagement.js"),__vite__mapDeps([37,2,29,1,3,30,31])),"/eventCreate":()=>W(()=>import("./EventCreatePage.js"),__vite__mapDeps([38,39,12,2,30,1,3,20,28,4,10])),"/eventCreate/:teamId":()=>W(()=>import("./EventCreatePage.js"),__vite__mapDeps([38,39,12,2,30,1,3,20,28,4,10])),"/materiel":()=>W(()=>import("./MaterielPage.js"),__vite__mapDeps([40,1,2,3,28,14,13,10,16])),"/materiel/:teamId":()=>W(()=>import("./MaterielPage.js"),__vite__mapDeps([40,1,2,3,28,14,13,10,16])),"/loans":()=>W(()=>import("./LoansPage.js"),__vite__mapDeps([41,1,2,3,11,12,42,14,28])),"/loans/:teamId":()=>W(()=>import("./LoansPage.js"),__vite__mapDeps([41,1,2,3,11,12,42,14,28])),"/loans/return/:loanId":()=>W(()=>import("./LoanReturnPage.js"),__vite__mapDeps([43,1,2,3,28]))},"/recipe/my":{hooks:Xt,"/":()=>W(()=>import("./RecipesListPage.js"),__vite__mapDeps([9,2,10,11,12,13,14,15,16,17,1,3])),"/draft":()=>W(()=>import("./RecipesListPage.js"),__vite__mapDeps([9,2,10,11,12,13,14,15,16,17,1,3]))},"/recipe/new":{hooks:Xt,"/":()=>W(()=>import("./RecipeCreatePage.js"),__vite__mapDeps([44,17,1,2,3,45,20,46,10,42,14,47,48]))},"/recipe/:uuid/edit":(()=>{const t=()=>W(()=>import("./RecipeEditPage.js"),__vite__mapDeps([49,17,1,2,3,45,20,46,10,42,14,47,11,12,30,48,23]));return t.hooks=Xt,t})(),"/recipe/:uuid/duplicate":(()=>{const t=()=>W(()=>import("./RecipeCreatePage.js"),__vite__mapDeps([44,17,1,2,3,45,20,46,10,42,14,47,48]));return t.hooks=Xt,t})(),"/eventList":{hooks:Xt,"/":()=>W(()=>import("./EventListPage.js"),__vite__mapDeps([50,1,2,3,32,20,33,34]))},"/createdocument/:teamId/new":(()=>{const t=()=>W(()=>import("./CreateDocumentPage.js"),__vite__mapDeps([51,1,2,3,52,46,53,42,14,48,54]));return t.hooks=Xt,t})(),"/editdocument/:teamId/:docId":(()=>{const t=()=>W(()=>import("./EditDocumentPage.js"),__vite__mapDeps([55,1,2,3,52,46,53,42,14,48,21,5,22,56]));return t.hooks=Xt,t})(),"/documents/:teamId":(()=>{const t=()=>W(()=>import("./DocumentListPage.js"),__vite__mapDeps([57,1,2,3,35,28]));return t.hooks=Xt,t})(),"/event/:id":{hooks:zm,"/":()=>W(()=>import("./EventEditPage.js"),__vite__mapDeps([58,39,12,2,30,1,3,20,28,4,10,59,33,60,14,42,48,34])),"/recipes":()=>W(()=>import("./EventRecipesPage.js"),__vite__mapDeps([61,33,60,2,28,19,20,10,21,5,22,15,16,11,12,1,3,62])),"/products":()=>W(()=>import("./EventProductsPage.js"),__vite__mapDeps([63,28,42,14,2,31,1,3,20,10,60,33,59,16,34,64])),"/posters":()=>W(()=>import("./EventPosterPage.js"),__vite__mapDeps([65,1,2,3,16,59,10,30,66]))},"(*)":()=>W(()=>import("./NotFoundPage.js"),__vite__mapDeps([67,5,1,2,3]))},{p:eg,navigate:tg,preload:rg,route:yo}=Qm(Fm),sg=Zm,ng=Object.freeze(Object.defineProperty({__proto__:null,Router:sg,blockNavigation:Xm,navigate:tg,p:eg,preload:rg,route:yo,searchParams:Wm},Symbol.toStringTag,{value:"Module"}));var ce,rt,$r,kr,ds,Pi,or,fs,Qs,xn,Hn,Vn,Wn;class ag{constructor(){T(this,"isMobileQuery",new Tc("max-width: 768px"));T(this,"isDesktopQuery",new Tc("min-width: 1024px"));y(this,ce,P(null));y(this,rt,P(ge([])));y(this,$r,P(!1));y(this,kr,P(null));y(this,ds,P(!1));y(this,Pi,z(()=>{const e=yo.pathname,r=yo.params.id;return e.includes("/event/")&&r?(console.log(`[GlobalState] â currentMainId dÃ©rivÃ©: ${r}`),r):(console.log(`[GlobalState] â ï¸ Pas de mainId: path=${e}, params.id=${r}`),null)}));y(this,or,P(0));y(this,fs,P(!0));y(this,Qs,P("down"));y(this,xn,P(ge({isOpen:!1,conflicts:[]})));y(this,Hn,P(ge({isOpen:!1})));y(this,Vn,P(ge({isRunning:!1,name:"",progress:0})));y(this,Wn,P(ge({isOpen:!1,showLogin:!0})))}get user(){return f(i(this,ce))}get userId(){return f(i(this,ce))?.$id??null}get userEmail(){return f(i(this,ce))?.email??null}get userTeams(){return f(i(this,rt))}get isAuthenticated(){return f(i(this,ce))!==null}get authLoading(){return f(i(this,$r))}get authError(){return f(i(this,kr))}get authInitialized(){return f(i(this,ds))}async initializeAuth(){if(f(i(this,ds))){console.log("[GlobalState] Authentification dÃ©jÃ  initialisÃ©e");return}console.log("[GlobalState] Initialisation de l'authentification..."),m(i(this,$r),!0),m(i(this,kr),null);try{const{account:e}=await D();m(i(this,ce),await e.get(),!0),localStorage.setItem("appwrite-user-name",f(i(this,ce)).name),localStorage.setItem("appwrite-user-email",f(i(this,ce)).email),localStorage.setItem("appwrite-user-id",f(i(this,ce)).$id),await vt.initialize(),m(i(this,rt),vt.myTeams.map(r=>r.$id),!0),console.log(`[GlobalState] AuthentifiÃ©: ${f(i(this,ce)).name} (${f(i(this,rt)).length} Ã©quipes)`)}catch(e){m(i(this,ce),null),m(i(this,rt),[],!0),m(i(this,kr),e instanceof Error?e.message:"Erreur d'authentification",!0),console.log("[GlobalState] Utilisateur non connectÃ©")}finally{m(i(this,$r),!1),m(i(this,ds),!0)}}async refreshAuthAfterLogin(){console.log("[GlobalState] RÃ©initialisation aprÃ¨s login..."),m(i(this,$r),!0),m(i(this,kr),null);try{const{account:e}=await D();m(i(this,ce),await e.get(),!0),localStorage.setItem("appwrite-user-name",f(i(this,ce)).name),localStorage.setItem("appwrite-user-email",f(i(this,ce)).email),localStorage.setItem("appwrite-user-id",f(i(this,ce)).$id),await vt.initialize(),await Ze.syncFromRemote(),await Ze.setupRealtime(),await cl.syncFromRemote(),await cl.setupRealtime(),await ll.syncFromRemote(),await ll.setupRealtime(),await Lm.initialize(),await be.initialize(),m(i(this,rt),vt.myTeams.map(r=>r.$id),!0),console.log(`[GlobalState] RÃ©initialisÃ© aprÃ¨s login: ${f(i(this,ce)).name} (${f(i(this,rt)).length} Ã©quipes)`)}catch(e){console.error("[GlobalState] Erreur lors de la rÃ©initialisation:",e),m(i(this,kr),e instanceof Error?e.message:"Erreur de rÃ©initialisation",!0)}finally{m(i(this,$r),!1)}}async logout(){try{const{account:e}=await D();await e.deleteSession({sessionId:"current"}),ju(),localStorage.removeItem("appwrite-user-name"),localStorage.removeItem("appwrite-user-email"),localStorage.removeItem("appwrite-user-id"),m(i(this,ce),null),m(i(this,rt),[],!0),m(i(this,ds),!1),console.log("[GlobalState] DÃ©connexion rÃ©ussie")}catch(e){throw console.error("[GlobalState] Erreur lors de la dÃ©connexion:",e),e}}async refreshTeams(){if(!f(i(this,ce))){console.warn("[GlobalState] Impossible de rafraÃ®chir les Ã©quipes: utilisateur non connectÃ©");return}try{await vt.syncFromRemote();const e=vt.myTeams.map(r=>r.$id);(e.length>0||f(i(this,rt)).length===0)&&(m(i(this,rt),e,!0),console.log(`[GlobalState] Ãquipes rafraÃ®chies: ${f(i(this,rt)).length}`))}catch(e){console.error("[GlobalState] Erreur lors du rafraÃ®chissement des Ã©quipes:",e)}}isTeamOwner(e){if(!f(i(this,ce)))return!1;const r=vt.myTeams.find(n=>n.$id===e);return r?r.members.find(n=>n.id===f(i(this,ce)).$id)?.roles?.includes("owner")??!1:!1}hasTeamRole(e,r){if(!f(i(this,ce)))return!1;const s=vt.myTeams.find(a=>a.$id===e);return s?s.members.find(a=>a.id===f(i(this,ce)).$id)?.roles?.includes(r)??!1:!1}get currentMainId(){return f(i(this,Pi))}get isMobile(){return this.isMobileQuery.current}get isDesktop(){return this.isDesktopQuery.current}get headerVisible(){return f(i(this,fs))}get scrollDirection(){return f(i(this,Qs))}initializeScrollDirection(){Vr(()=>{const e=Np.current??0;if(e>f(i(this,or))?m(i(this,Qs),"down"):e<f(i(this,or))&&m(i(this,Qs),"up"),this.isDesktop){m(i(this,fs),!0),m(i(this,or),e,!0);return}e>f(i(this,or))&&e>100?m(i(this,fs),!1):e<f(i(this,or))&&m(i(this,fs),!0),m(i(this,or),e,!0)})}get userName(){return f(i(this,ce))?.name||localStorage.getItem("appwrite-user-name")||""}get toasts(){return Ke.toasts}get toast(){return Ke}get modalOverride(){return f(i(this,xn))}set modalOverride(e){m(i(this,xn),e,!0)}get modal(){return f(i(this,Hn))}set modal(e){m(i(this,Hn),e,!0)}get backgroundOperation(){return f(i(this,Vn))}set backgroundOperation(e){m(i(this,Vn),e,!0)}get authModal(){return f(i(this,Wn))}set authModal(e){m(i(this,Wn),e,!0)}}ce=new WeakMap,rt=new WeakMap,$r=new WeakMap,kr=new WeakMap,ds=new WeakMap,Pi=new WeakMap,or=new WeakMap,fs=new WeakMap,Qs=new WeakMap,xn=new WeakMap,Hn=new WeakMap,Vn=new WeakMap,Wn=new WeakMap;const k=new ag;var Gn,Qn;class vd{constructor(){y(this,Gn,P("survolez des Ã©lÃ©ment pour obtenir de l'aide"));y(this,Qn,P(!0));T(this,"reset",()=>{this.msg="survolez des Ã©lÃ©ment pour obtenir de l'aide"});T(this,"toggle",()=>{this.isExpanded=!this.isExpanded});T(this,"expand",()=>{this.isExpanded=!0});T(this,"collapse",()=>{this.isExpanded=!1})}get msg(){return f(i(this,Gn))}set msg(e){m(i(this,Gn),e,!0)}get isExpanded(){return f(i(this,Qn))}set isExpanded(e){m(i(this,Qn),e,!0)}get help(){return this.msg}set help(e){this.msg=e}}Gn=new WeakMap,Qn=new WeakMap;const ig=new vd,Qy=Object.freeze(Object.defineProperty({__proto__:null,HoverHelp:vd,globalState:k,hoverHelp:ig},Symbol.toStringTag,{value:"Module"}));async function og(t,e,r,s,n=!1){try{const{functions:a,config:o}=await D(),c=o.functions.enkaData,l=JSON.stringify({action:t,recipeId:e,userId:r,data:s}),u=await a.createExecution({functionId:c,body:l,async:n});if(n){if(u.status==="failed")throw new Error(`Function execution failed to start: ${u.status}`);return{success:!0,executionId:u.$id}}if(u.status!=="completed")throw new Error(`Function execution failed: ${u.status} - ${u.responseBody}`);const d=JSON.parse(u.responseBody);if(!d.success)throw new Error(d.error||"Unknown error in manage_recipe");return d.data}catch(a){throw console.error(`[appwrite-recipes] Error executing manage_recipe (${t}):`,a),a}}const on="recettes";async function ml(){try{const{tables:t,config:e}=await D();return(await t.listRows({databaseId:e.databaseId,tableId:on})).rows}catch(t){throw console.error("[appwrite-recipes] Error listing all recipes:",t),t}}async function cg(t){try{const{tables:e,config:r}=await D(),s=[S.greaterThan("$updatedAt",t)];return(await e.listRows({databaseId:r.databaseId,tableId:on,queries:s})).rows}catch(e){throw console.error(`[appwrite-recipes] Error listing updated recipes since ${t}:`,e),e}}async function Zi(t){try{const{tables:e,config:r}=await D(),n=await e.getRow({databaseId:r.databaseId,tableId:on,rowId:t});return n.status==="deleted"?(console.log(`[appwrite-recipes] Recipe ${t} is deleted, returning null`),null):n}catch(e){if(e.code===404)return null;throw console.error(`[appwrite-recipes] Error getting recipe ${t}:`,e),e}}async function Jy(t,e){try{const{tables:r,config:s,account:n}=await D(),a=Tp(t.title,t.versionLabel||void 0),o=[te.read(ie.users()),te.update(ie.user(e)),te.delete(ie.user(e))],l=(await n.get()).name,u={title:t.title,plate:t.plate,ingredients:t.ingredients,preparation:t.preparation,draft:t.draft??!0,typeR:t.typeR,categories:t.categories??[],regime:t.regime??[],check:t.check??!1,description:t.description??null,quantite_desc:t.quantite_desc??null,region:t.region??null,saison:t.saison??[],cuisson:t.cuisson??[],serveHot:t.serveHot??!0,auteur:l,preparation24h:t.preparation24h??null,astuces:t.astuces??null,publishedAt:t.publishedAt||new Date().toISOString().split("T")[0]+"T00:00:00Z",$id:a,createdBy:e,permissionWrite:t.permissionWrite||[e],rootRecipeId:t.rootRecipeId??null,versionLabel:t.versionLabel??null},d=await r.createRow({databaseId:s.databaseId,tableId:on,rowId:a,data:u,permissions:o});return console.log(`[appwrite-recipes] Recipe created: ${a}`),d}catch(r){throw console.error("[appwrite-recipes] Error creating recipe:",r),r}}async function lg(t,e,r){try{const{tables:s,config:n}=await D(),a={...e,check:e.check??!1,...e.publishedAt&&{publishedAt:e.publishedAt}},o=await s.updateRow({databaseId:n.databaseId,tableId:on,rowId:t,data:a});return console.log(`[appwrite-recipes] Recipe updated: ${t}`),o}catch(s){throw console.error(`[appwrite-recipes] Error updating recipe ${t}:`,s),s}}async function Ky(t,e){try{await og("delete_recipe",t,e,{},!1),console.log(`[appwrite-recipes] Recipe deleted from GitHub and marked as deleted: ${t}`)}catch(r){throw console.error(`[appwrite-recipes] Error deleting recipe ${t} with GitHub sync:`,r),r}}const ug="/data/data.json";var J,je,Ue,Cr,Jn,x,Bt,Tr,Nr,Oe,Za,bd,Ed,wo,vo;class dg{constructor(){y(this,Oe);y(this,J,P(ge(new gt)));y(this,je,P(!1));y(this,Ue,P(null));y(this,Cr,P(!1));y(this,Jn,P(null));y(this,x,null);y(this,Bt,new Set);y(this,Tr,null);y(this,Nr,!1)}get loading(){return f(i(this,je))}get error(){return f(i(this,Ue))}get isInitialized(){return f(i(this,Cr))}get recipesIndex(){return Array.from(f(i(this,J)).values())}get count(){return f(i(this,J)).size}getAllRecipes(){return Array.from(f(i(this,J)).values())}async loadCache(){if(f(i(this,Cr))){console.log("[RecipesStore] Cache dÃ©jÃ  chargÃ©");return}console.log("[RecipesStore] Chargement du cache..."),m(i(this,je),!0),m(i(this,Ue),null);try{I(this,x,await vp());const e=await i(this,x).loadRecipesIndex(),r=await i(this,x).loadMetadata();e.size>0&&(console.log(`[RecipesStore] ${e.size} recettes (index) chargÃ©es depuis le cache`),m(i(this,J),new gt(e),!0)),m(i(this,Cr),!0),console.log(`[RecipesStore] Cache chargÃ©: ${f(i(this,J)).size} recettes`)}catch(e){const r=e instanceof Error?e.message:"Erreur lors du chargement du cache";throw m(i(this,Ue),r,!0),console.error("[RecipesStore]",r,e),e}finally{m(i(this,je),!1)}}async syncFromRemote(){if(!i(this,x)){console.warn("[RecipesStore] Impossible de sync : cache non initialisÃ©");return}console.log("[RecipesStore] Synchronisation depuis sources distantes..."),m(i(this,je),!0);try{const e=await i(this,x).loadMetadata();try{await b(this,Oe,Za).call(this,e)}catch(r){if(console.error("[RecipesStore] Erreur chargement data.json:",r),f(i(this,J)).size===0)throw new Error("Aucun cache disponible et data.json inaccessible");console.log("[RecipesStore] Continuation avec les donnÃ©es du cache")}if(k.userId)try{await b(this,Oe,bd).call(this,e)}catch(r){console.warn("[RecipesStore] Erreur sync Appwrite:",r)}console.log(`[RecipesStore] Synchronisation terminÃ©e: ${f(i(this,J)).size} recettes`)}catch(e){const r=e instanceof Error?e.message:"Erreur lors de la synchronisation";throw m(i(this,Ue),r,!0),console.error("[RecipesStore]",r,e),e}finally{m(i(this,je),!1)}}async syncFromRemotePublicOnly(){if(!i(this,x)){console.warn("[RecipesStore] Impossible de sync : cache non initialisÃ©");return}console.log("[RecipesStore] Synchronisation publique (Hugo uniquement)..."),m(i(this,je),!0);try{const e=await i(this,x).loadMetadata();try{await b(this,Oe,Za).call(this,e)}catch(r){if(console.error("[RecipesStore] Erreur chargement data.json:",r),f(i(this,J)).size===0)throw new Error("Aucun cache disponible et data.json inaccessible");console.log("[RecipesStore] Continuation avec les donnÃ©es du cache")}console.log(`[RecipesStore] Synchronisation publique terminÃ©e: ${f(i(this,J)).size} recettes`)}catch(e){const r=e instanceof Error?e.message:"Erreur lors de la synchronisation publique";throw m(i(this,Ue),r,!0),console.error("[RecipesStore]",r,e),e}finally{m(i(this,je),!1)}}async setupRealtime(){if(!i(this,x)){console.warn("[RecipesStore] Impossible de setup realtime : cache non initialisÃ©");return}if(i(this,Nr)&&be.isInitialized){console.log("[RecipesStore] Realtime dÃ©jÃ  configurÃ©");return}if(i(this,Nr)&&!be.isInitialized&&(console.log("[RecipesStore] RealtimeManager dÃ©truit, rÃ©initialisation..."),I(this,Nr,!1)),console.log("[RecipesStore] Configuration du realtime..."),!k.isAuthenticated){console.log("[RecipesStore] Mode visiteur : pas de realtime");return}try{b(this,Oe,Ed).call(this),I(this,Nr,!0)}catch(e){console.warn("[RecipesStore] Erreur activation realtime:",e)}}async initialize(){if(f(i(this,Cr))){console.log("[RecipesStore] DÃ©jÃ  initialisÃ©");return}return i(this,Tr)?(console.log("[RecipesStore] Initialisation dÃ©jÃ  en cours, attente..."),i(this,Tr)):(console.log("[RecipesStore] Initialisation..."),m(i(this,je),!0),m(i(this,Ue),null),I(this,Tr,(async()=>{try{if(await this.loadCache(),await this.syncFromRemote(),await this.setupRealtime(),f(i(this,J)).size===0){const e="Aucune recette disponible aprÃ¨s initialisation";m(i(this,Ue),e),console.warn("[RecipesStore]",e)}console.log(`[RecipesStore] Initialisation complÃ©tÃ©e: ${f(i(this,J)).size} recettes`)}catch(e){const r=e instanceof Error?e.message:"Erreur lors de l'initialisation";throw m(i(this,Ue),r,!0),console.error("[RecipesStore] ECHEC Initialisation:",r,e),e}finally{m(i(this,je),!1),I(this,Tr,null)}})()),i(this,Tr))}async forceReloadAllRecipes(){if(!k.userId)throw new Error("Utilisateur non connectÃ©");m(i(this,je),!0),m(i(this,Ue),null);try{console.log("[RecipesStore] Rechargement forcÃ© des recettes Appwrite...");const e=await ml();let r=0,s=0;if(e.forEach(n=>{n.status==="deleted"?f(i(this,J)).has(n.$id)&&(f(i(this,J)).delete(n.$id),s++,console.log(`[RecipesStore] Recette ${n.$id} supprimÃ©e (status=deleted)`)):(f(i(this,J)).set(n.$id,ja(n)),r++)}),console.log(`[RecipesStore] ${r} recettes Appwrite chargÃ©es, ${s} supprimÃ©es`),i(this,x)){const n=await i(this,x).loadMetadata(),a=new Date().toISOString();await i(this,x).saveRecipesIndex(f(i(this,J))),await i(this,x).saveMetadata({...n,lastAppwriteSync:a,recipesCount:f(i(this,J)).size,cacheVersion:1})}console.log("[RecipesStore] Rechargement forcÃ© terminÃ©")}catch(e){const r=e instanceof Error?e.message:"Erreur lors du rechargement";throw m(i(this,Ue),r,!0),console.error("[RecipesStore] Erreur rechargement forcÃ©:",e),e}finally{m(i(this,je),!1)}}async hardReset(){if(!k.userId)throw new Error("Utilisateur non connectÃ©");console.log("[RecipesStore] ð HARD RESET - Vidage complet..."),m(i(this,je),!0),m(i(this,Ue),null);try{f(i(this,J)).clear(),i(this,x)&&(await i(this,x).clear(),console.log("[RecipesStore] Cache IDB vidÃ©")),await b(this,Oe,Za).call(this,null);const e=await ml();let r=0,s=0;if(e.forEach(n=>{n.status!=="deleted"?(f(i(this,J)).set(n.$id,ja(n)),r++):s++}),console.log(`[RecipesStore] ${r} recettes Appwrite chargÃ©es, ${s} supprimÃ©es ignorÃ©es`),i(this,x)){const n=new Date().toISOString();await i(this,x).saveRecipesIndex(f(i(this,J))),await i(this,x).saveMetadata({buildTimestamp:f(i(this,Jn)),lastAppwriteSync:n,recipesCount:f(i(this,J)).size,cacheVersion:1}),console.log("[RecipesStore] Cache IDB recrÃ©Ã©")}console.log("[RecipesStore] â HARD RESET terminÃ©")}catch(e){const r=e instanceof Error?e.message:"Erreur lors du hard reset";throw m(i(this,Ue),r,!0),console.error("[RecipesStore] Erreur hard reset:",e),e}finally{m(i(this,je),!1)}}getRecipeIndexByUuid(e){return f(i(this,J)).get(e)||null}searchRecipes(e){if(!e.trim())return this.recipesIndex;const r=b(this,Oe,wo).call(this,e.trim()).split(/\s+/);return this.recipesIndex.filter(s=>{const a=b(this,Oe,wo).call(this,s.title).split(/[\s\-_]+/);return r.every(o=>a.some(c=>c.startsWith(o)))})}get availableTypes(){const e=new Set;return this.recipesIndex.forEach(r=>e.add(r.typeR)),Array.from(e).sort()}async canEditRecipe(e){if(!k.userId)return!1;try{const r=await Zi(e);return r?r.createdBy===k.userId||!!r.permissionWrite?.includes(k.userId)||!!r.teams?.some(s=>k.userTeams.includes(s)):!1}catch(r){return console.error(`[RecipesStore] Erreur lors de la vÃ©rification des permissions pour ${e}:`,r),!1}}getRecipeLockStatus(e){return f(i(this,J)).get(e)?.lockedBy||null}async updateRecipeLock(e,r){if(k.userId)try{await lg(e,{lockedBy:r},k.userId),console.log(`[RecipesStore] Verrou ${e} mis Ã  jour: ${r||"libÃ©rÃ©"}`);const s=f(i(this,J)).get(e);s&&f(i(this,J)).set(e,{...s,lockedBy:r})}catch(s){throw console.error(`[RecipesStore] Erreur verrouillage ${e}:`,s),s}}async getRecipeByUuid(e){if(i(this,Bt).has(e)){for(console.log(`[RecipesStore] Chargement de ${e} dÃ©jÃ  en cours, attente...`);i(this,Bt).has(e);)await new Promise(r=>setTimeout(r,50));return i(this,x)&&await i(this,x).loadRecipeDetail(e)||null}i(this,Bt).add(e);try{if(i(this,x)){const s=await i(this,x).loadRecipeDetail(e);if(s)return s}let r=null;try{const s=`/recettes/${e}/recipe.json`,n=await fetch(s);if(n.ok){const a=await n.json();r=Oc(a),console.log(`[RecipesStore] ${e} chargÃ©e depuis Hugo`)}}catch{console.log(`[RecipesStore] ${e} non trouvÃ©e dans Hugo`)}if(!r&&k.userId)try{const s=await Zi(e);if(s){const n=Qa(s.ingredients||[]);r={...s,ingredients:n,astuces:Ki(s.astuces),prepAlt:s.prepAlt||null,categories:s.categories,regime:s.regime,saison:s.saison,teams:s.teams,permissionWrite:s.permissionWrite},console.log(`[RecipesStore] ${e} chargÃ©e depuis Appwrite (fallback)`)}}catch{console.log(`[RecipesStore] ${e} non trouvÃ©e dans Appwrite`)}return r&&i(this,x)&&await i(this,x).saveRecipeDetail(r),r||console.warn(`[RecipesStore] ${e} non trouvÃ©e (Hugo ni Appwrite)`),r}catch(r){return console.error(`[RecipesStore] Erreur lors du chargement de ${e}:`,r),null}finally{i(this,Bt).delete(e)}}async getRecipesByUuidsBulk(e){const r=performance.now(),s=[...new Set(e.filter(Boolean))];if(s.length===0)return new Map;console.log(`[RecipesStore] Chargement bulk de ${s.length} recettes...`);const n=new Map;i(this,x)&&(await i(this,x).loadRecipeDetailsBulk(s)).forEach((d,h)=>n.set(h,d));const a=s.filter(u=>!n.has(u));console.log(`[RecipesStore] Bulk: ${n.size} dans le cache, ${a.length} Ã  fetch`);const o=new Map;if(a.length>0){a.forEach(u=>i(this,Bt).add(u));try{const u=a.map(async h=>{let p=null;try{const g=`/recettes/${h}/recipe.json`,w=await fetch(g);if(w.ok){const _=await w.json();p=Oc(_)}}catch{}if(!p&&k.userId)try{const g=await Zi(h);if(g){const w=Qa(g.ingredients||[]);p={...g,ingredients:w,astuces:Ki(g.astuces),prepAlt:g.prepAlt||null,categories:g.categories,regime:g.regime,saison:g.saison,teams:g.teams,permissionWrite:g.permissionWrite}}}catch{}return p?{uuid:h,recipe:p}:null});(await Promise.all(u)).forEach(h=>{h&&o.set(h.uuid,h.recipe)}),o.size>0&&i(this,x)&&await i(this,x).saveRecipeDetailsBulk(o),a.forEach(h=>i(this,Bt).delete(h))}catch(u){console.error("[RecipesStore] Erreur lors du fetch bulk:",u),a.forEach(d=>i(this,Bt).delete(d))}}const c=new Map([...n,...o]),l=performance.now()-r;return console.log(`[RecipesStore] Bulk terminÃ©: ${c.size}/${s.length} recettes en ${l.toFixed(0)}ms`),c}async preloadRecipes(e){console.log(`[RecipesStore] PrÃ©chargement de ${e.length} recettes...`);const r=e.map(s=>this.getRecipeByUuid(s));await Promise.all(r),console.log("[RecipesStore] PrÃ©chargement terminÃ©")}async getVariantGroup(e,r=2){const s=this.getRecipeIndexByUuid(e);if(!s)return{root:null,variants:[],isRoot:!1};const n=new Map,a=new Set;let o=s;for(;o.rootRecipeId&&!a.has(o.rootRecipeId);){a.add(o.$id);const l=this.getRecipeIndexByUuid(o.rootRecipeId);if(!l)break;o=l}const c=o;return n.set(c.$id,c),await b(this,Oe,vo).call(this,c.$id,n,new Set([c.$id]),0,r),{root:c,variants:Array.from(n.values()),isRoot:!s.rootRecipeId||s.rootRecipeId===s.$id}}findRootRecipe(e){const r=new Set;let s=e,n=10;for(let a=0;a<n;a++){const o=this.getRecipeIndexByUuid(s);if(!o||!o.rootRecipeId)return s;if(r.has(s))return console.error("[RecipesStore] Cycle dÃ©tectÃ© dans rootRecipeId, retour Ã ",e),e;r.add(s),s=o.rootRecipeId}return e}destroy(){i(this,x)&&(i(this,x).close(),I(this,x,null)),f(i(this,J)).clear(),m(i(this,Cr),!1),I(this,Nr,!1),console.log("[RecipesStore] Ressources nettoyÃ©es")}}J=new WeakMap,je=new WeakMap,Ue=new WeakMap,Cr=new WeakMap,Jn=new WeakMap,x=new WeakMap,Bt=new WeakMap,Tr=new WeakMap,Nr=new WeakMap,Oe=new WeakSet,Za=async function(e){try{console.log("[RecipesStore] Chargement data.json...");const r=await fetch(ug);if(!r.ok)throw new Error(`Erreur HTTP: ${r.status}`);const s=await r.json();if(!Array.isArray(s.recipes))throw new Error("Format invalide: recipes n'est pas un tableau");const n=s.meta?.timestamp;if(m(i(this,Jn),n,!0),n&&e&&e.buildTimestamp&&e.buildTimestamp>=n){console.log(`[RecipesStore] Cache Ã  jour (Ts: ${e.buildTimestamp} >= ${n})`);return}console.log(`[RecipesStore] Nouvelle version dÃ©tectÃ©e ou cache manquant (Ts: ${n}), Traitement...`);const a=s.recipes.map(c=>Ip(c));let o=0;a.forEach(c=>{const l=f(i(this,J)).get(c.$id);let u=!1;if(!l)u=!0;else{const d=new Date(c.$updatedAt).getTime(),h=new Date(l.$updatedAt).getTime();d>h&&(u=!0)}u&&(f(i(this,J)).set(c.$id,c),o++)}),console.log(`[RecipesStore] Smart Merge: ${o} recettes mises Ã  jour/ajoutÃ©es.`),i(this,x)&&(await i(this,x).saveRecipesIndex(f(i(this,J))),await i(this,x).saveMetadata({...e,buildTimestamp:n||Date.now()/1e3,recipesCount:f(i(this,J)).size,cacheVersion:1}))}catch(r){throw console.error("[RecipesStore] Erreur loadIndexFromDataJson:",r),r}},bd=async function(e){console.log("[RecipesStore] Sync incrÃ©mentiel Appwrite...");const r=e?.lastAppwriteSync||"1970-01-01T00:00:00.000Z";e?.buildTimestamp&&new Date(e.buildTimestamp*1e3).toISOString(),console.log(`[RecipesStore] Sync Appwrite: depuis ${r}`);const s=await cg(r);if(s.length===0){console.log("[RecipesStore] Aucune mise Ã  jour Appwrite dÃ©tectÃ©e.");return}console.log(`[RecipesStore] ${s.length} recettes mises Ã  jour depuis Appwrite.`);let n=0,a=0;s.forEach(c=>{if(c.status==="deleted")f(i(this,J)).has(c.$id)&&(f(i(this,J)).delete(c.$id),a++,console.log(`[RecipesStore] Recette ${c.$id} supprimÃ©e (status=deleted)`));else{const l=ja(c);f(i(this,J)).set(l.$id,l),n++}});const o=new Date().toISOString();i(this,x)&&(await i(this,x).saveRecipesIndex(f(i(this,J))),await i(this,x).saveMetadata({...e,lastAppwriteSync:o})),console.log(`[RecipesStore] Sync incrÃ©mentiel terminÃ© (${n} mises Ã  jour, ${a} supprimÃ©es).`)},Ed=async function(){try{console.log("[RecipesStore] Configuration du Realtime...");const e=dt();be.register([`databases.${e}.collections.${on}.documents`],async r=>{const s=r.payload;let n="update";if(r.events.some(a=>a.includes(".create"))?n="create":r.events.some(a=>a.includes(".delete"))&&(n="delete"),console.log(`[RecipesStore] â¡ï¸ Realtime RECEIVED: ${n} pour ${s.$id}`),n==="create"||n==="update"){if(s.status==="deleted"){if(f(i(this,J)).delete(s.$id),i(this,x))try{await i(this,x).deleteRecipeFromIndex(s.$id),console.log(`[RecipesStore] Recette ${s.$id} supprimÃ©e de l'index (status=deleted)`)}catch(l){console.warn(`[RecipesStore] Erreur suppression index ${s.$id}:`,l)}return}const a=ja(s);f(i(this,J)).set(s.$id,a);const o=Qa(s.ingredients),c={...s,ingredients:o,astuces:Ki(s.astuces)};if(i(this,x))try{await i(this,x).saveRecipeDetail(c),console.log(`[RecipesStore] DÃ©tails de ${s.$id} mis Ã  jour dans le cache`)}catch(l){console.warn(`[RecipesStore] Erreur mise Ã  jour cache dÃ©tails ${s.$id}:`,l)}}else if(n==="delete"&&(f(i(this,J)).delete(s.$id),i(this,x)))try{await i(this,x).deleteRecipeFromIndex(s.$id),console.log(`[RecipesStore] Recette ${s.$id} supprimÃ©e du cache`)}catch(a){console.warn(`[RecipesStore] Erreur suppression cache ${s.$id}:`,a)}}),console.log("[RecipesStore] Realtime enregistrÃ© auprÃ¨s du manager")}catch(e){console.error("[RecipesStore] Erreur lors de la configuration du realtime:",e)}},wo=function(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")},vo=async function(e,r,s,n,a){if(!(n>a))for(const[o,c]of f(i(this,J)))r.has(o)||c.rootRecipeId===e&&(r.set(o,c),c.rootRecipeId&&c.rootRecipeId!==e&&!s.has(c.rootRecipeId)&&(s.add(c.rootRecipeId),await b(this,Oe,vo).call(this,c.rootRecipeId,r,s,n+1,a)))};const mi=new dg;function fg(t){const e=qr(t.specs)??null,r=qo(jo(t.purchases??[]));let s=[];e?.quantity&&(s=[e.quantity]);const n=qr(t.totalNeededOverride),a=n?[n.totalOverride]:s,{numeric:o,display:c}=Oi(a,r);let l=qr(t.stockReel)??null;if(l&&l.quantity&&l.unit){const p=Oo.normalize(parseFloat(l.quantity),l.unit);l={...l,quantity:p.quantity,unit:p.unit}}const u=ft(r),d=t.store?qr(t.store):null,h=l?`${l.quantity} ${l.unit}`:u;return{$id:t.$id,$createdAt:t.$createdAt,$updatedAt:t.$updatedAt,productHugoUuid:t.productHugoUuid||"",productName:t.productName,productType:t.productType||"none",pF:e?.pF??!1,pS:e?.pS??!1,nbRecipes:0,totalAssiettes:0,isSynced:t.isSynced,mainId:t.mainId,totalNeededRaw:[],status:t.status,who:t.who,store:t.store,stockReel:t.stockReel,previousNames:t.previousNames,isMerged:t.isMerged,mergedFrom:t.mergedFrom,mergeDate:t.mergeDate,mergeReason:t.mergeReason,mergedInto:t.mergedInto,totalNeededOverride:t.totalNeededOverride,purchases:t.purchases,specs:t.specs,byDate:{},storeInfo:d,stockParsed:l,specsParsed:e,totalNeededArray:s,totalPurchasesArray:r,missingQuantityArray:o,stockOrTotalPurchases:h,displayTotalNeeded:ft(s),displayTotalPurchases:u,displayMissingQuantity:c,totalNeededOverrideParsed:n,displayTotalOverride:n?ft([n.totalOverride]):"",dateDisplayInfo:{}}}function Ba(t,e){const r=t.purchases??e.purchases,s=t.specs??e.specs,n=s?qr(s):e.specsParsed,a=qo(jo(r??[])),o=ft(a);let c=e.totalNeededArray;!e.productHugoUuid&&n?.quantity&&(c=[n.quantity]);const l=qr(t.totalNeededOverride??e.totalNeededOverride),u=l?[l.totalOverride]:c,{numeric:d,display:h}=Oi(u,a),p=t.stockReel??e.stockReel;let g=p?qr(p):e.stockParsed;if(g&&g.quantity&&g.unit){const A=Oo.normalize(parseFloat(g.quantity),g.unit);g={...g,quantity:A.quantity,unit:A.unit}}const w=t.store??e.store,_=w?qr(w):e.storeInfo,E=g?`${g.quantity} ${g.unit}`:o;return t.purchases===void 0&&e.purchases?.length&&console.log(`[ProductsStore] Fusion intelligente : prÃ©servation de ${e.purchases.length} purchases pour ${e.productName}`),{...e,$updatedAt:t.$updatedAt,productName:t.productName??e.productName,productType:t.productType??e.productType,isSynced:t.isSynced??e.isSynced,mainId:t.mainId??e.mainId,pF:n?.pF??e.pF,pS:n?.pS??e.pS,status:t.status??e.status,who:t.who??e.who,store:w,stockReel:p,specs:s,purchases:r,previousNames:t.previousNames??e.previousNames,isMerged:t.isMerged??e.isMerged,mergedFrom:t.mergedFrom??e.mergedFrom,mergeDate:t.mergeDate??e.mergeDate,mergeReason:t.mergeReason??e.mergeReason,mergedInto:t.mergedInto??e.mergedInto,totalNeededOverride:t.totalNeededOverride??e.totalNeededOverride,storeInfo:_,stockParsed:g,specsParsed:n,totalNeededArray:c,totalPurchasesArray:a,missingQuantityArray:d,stockOrTotalPurchases:E,displayTotalPurchases:o,displayMissingQuantity:h,displayTotalNeeded:ft(c),totalNeededOverrideParsed:l,displayTotalOverride:l?ft([l.totalOverride]):""}}function hg(t){t.totalPurchasesArray=qo(jo(t.purchases??[]));const e=t.totalNeededOverrideParsed?[t.totalNeededOverrideParsed.totalOverride]:t.totalNeededArray,{numeric:r,display:s}=Oi(e,t.totalPurchasesArray);t.missingQuantityArray=r,t.displayMissingQuantity=s}async function gl(t,e,r){console.log(`[productEnrichment] Calcul pour Ã©vÃ©nement ${t.$id} avec ${t.meals.length} repas`);const s=new Set;for(const l of t.meals)for(const u of l.recipes)s.add(u.recipeUuid);console.log(`[productEnrichment] ${s.size} recettes uniques identifiÃ©es`);const n=await mi.getRecipesByUuidsBulk([...s]);console.log(`[productEnrichment] ${n.size}/${s.size} recettes chargÃ©es`);const a=l=>Promise.resolve(n.get(l)||null),o=new Map;for(const l of t.meals)await pg(l,a,o);const c=[];for(const[l,u]of o)c.push(gg(u,r));return console.log(`[productEnrichment] ${c.length} produits calculÃ©s`),c}async function pg(t,e,r){const s=t.date;for(const n of t.recipes){const a=await e(n.recipeUuid);if(!a){console.warn(`[processMeal] Recette ${n.recipeUuid} introuvable`);continue}const o=n.plates/a.plate;for(const c of a.ingredients)mg(c,o,s,r,a.title,n.plates)}}function mg(t,e,r,s,n,a){const o=t.uuid;s.has(o)||s.set(o,{productHugoUuid:o,productName:t.name,productType:t.type,pF:t.pF??!1,pS:t.pS??!1,byDate:{},allergens:new Set(t.allergens||[])});const c=s.get(o),l=t.normalizedUnit==="au goÃ»t"?t.normalizedQuantity:t.normalizedQuantity*e,u=t.normalizedUnit==="au goÃ»t"?t.originalQuantity:t.originalQuantity*e;c.byDate[r]||(c.byDate[r]={quantities:[],recipes:[],totalAssiettes:0});const d=c.byDate[r];d.quantities.push({q:l,u:t.normalizedUnit}),d.recipes.push({r:n,q:u,u:t.originalUnit,qEq:l,uEq:t.normalizedUnit,a}),d.totalAssiettes+=a,t.allergens&&t.allergens.forEach(h=>c.allergens.add(h))}function gg(t,e){const r=Cu(t.productName).substring(0,20),s=e.slice(-10),n=`${r}_${s}`,a={};for(const[A,M]of Object.entries(t.byDate))a[A]={totalConsolidated:fo(M.quantities),recipes:M.recipes,totalAssiettes:M.totalAssiettes,recipeCount:M.recipes.length};const o=Object.values(a).flatMap(A=>A.totalConsolidated),c=fo(o),l=[],u=[],d=c,{numeric:h,display:p}=Oi(d,l),g=Object.values(a).reduce((A,M)=>A+M.recipeCount,0),w=Object.values(a).reduce((A,M)=>A+M.totalAssiettes,0),_=mp(Object.keys(a));return{$id:n,mainId:e,productHugoUuid:t.productHugoUuid,productName:t.productName,productType:t.productType,byDate:a,totalNeededArray:c,totalPurchasesArray:l,missingQuantityArray:h,displayTotalNeeded:ft(c),displayTotalPurchases:ft(l),displayMissingQuantity:p,isSynced:!1,status:"active",who:[],store:"",storeInfo:null,purchases:u,stockReel:"",stockParsed:null,totalNeededOverride:null,totalNeededOverrideParsed:null,displayTotalOverride:"",stockOrTotalPurchases:"",previousNames:null,isMerged:!1,mergedFrom:[],mergeDate:null,mergeReason:null,mergedInto:null,specs:null,specsParsed:null,pF:t.pF??!1,pS:t.pS??!1,nbRecipes:g,totalAssiettes:w,totalNeededRaw:c,dateDisplayInfo:_,$createdAt:new Date().toISOString(),$updatedAt:new Date().toISOString(),$permissions:[],$databaseId:"",$tableId:""}}function Sd(t,e){const{operationName:r,maxAutoRetries:s=1,autoRetryDelay:n=1e3}=e;let a=1;return new Promise((o,c)=>{const l=async()=>{try{console.log(`[RetryUtils] ${r} - Tentative ${a}/${s+1}`);const u=await t();console.log(`[RetryUtils] ${r} - SuccÃ¨s`),e.onSuccess?.(u),o(u)}catch(u){if(console.error(`[RetryUtils] Erreur ${r} (Tentative ${a}):`,u),u instanceof Error&&u.message,a<=s){a++,console.log(`[RetryUtils] Nouvelle tentative dans ${n/1e3}s...`),setTimeout(()=>l(),n);return}console.error(`[RetryUtils] ${r} - Ãchec aprÃ¨s ${a} tentatives`),e.onError?.(u),c(u)}};l()})}function Ca(t){if(!t)return[];const e=[],r=t.$id;return e.push(te.read(ie.label(r)),te.update(ie.label(r))),e}function yg(t,e,r,s){let n=t.who,a=t.store;return r==="who"?n=e.names||null:r==="store"&&(a=JSON.stringify(e)),{$id:t.$id,productHugoUuid:t.productHugoUuid,productName:t.productName,mainId:t.mainId,status:t.status||null,who:n,store:a,stockReel:t.stockReel||null,previousNames:t.previousNames||null,isMerged:t.isMerged||!1,mergedFrom:t.mergedFrom||null,mergeDate:t.mergeDate||null,mergeReason:t.mergeReason||null,mergedInto:t.mergedInto||null,totalNeededOverride:t.totalNeededOverride||null,$permissions:[te.read(ie.label(s)),te.update(ie.label(s))]}}function Id(t,e){return{$id:t.$id,mainId:t.mainId,productHugoUuid:t.productHugoUuid,productName:t.productName,...e}}async function wg(t){const{account:e}=await D(),r=await e.get();return{...t,updatedBy:r.name}}function Ad(){return localStorage.getItem("appwrite-user-name")||""}async function _d(t,e,r=100){try{const{tables:s,config:n}=await D(),a=await s.listRows({databaseId:n.databaseId,tableId:n.collections.purchases,queries:[S.greaterThan("$updatedAt",e),S.equal("mainId",t),S.limit(r)]});return console.log(`[Appwrite product] ${a.rows.length} purchases modifiÃ©s chargÃ©s`),a.rows}catch(s){return console.error("[Appwrite product] Erreur chargement purchases modifiÃ©s:",s),[]}}async function Rd(t,e){const{lastSync:r,limit:s=1e3}=e;try{const{tables:n,config:a}=await D();if(!r){console.log("[Appwrite product] Chargement complet des produits et achats");const p=(await n.listRows({databaseId:a.databaseId,tableId:a.collections.products,queries:[S.equal("mainId",t),S.limit(s)]})).rows,w=(await n.listRows({databaseId:a.databaseId,tableId:a.collections.purchases,queries:[S.equal("mainId",t),S.limit(s*2)]})).rows,_=new Map;return p.forEach(E=>{_.set(E.$id,{...E,purchases:[]})}),w.forEach(E=>{E.products?.forEach(A=>{const M=_.get(A);M&&(M.purchases||(M.purchases=[]),M.purchases.push(E))})}),console.log(`[Appwrite product] ${p.length} produits chargÃ©s avec ${w.length} achats`),Array.from(_.values())}const o=await n.listRows({databaseId:a.databaseId,tableId:a.collections.products,queries:[S.greaterThan("$updatedAt",r),S.equal("mainId",t),S.limit(s)]}),c=o.rows,u=(await n.listRows({databaseId:a.databaseId,tableId:a.collections.purchases,queries:[S.greaterThan("$updatedAt",r),S.equal("mainId",t),S.limit(s*2)]})).rows,d=new Map;return c.forEach(h=>{d.set(h.$id,{...h,purchases:[]})}),u.forEach(h=>{h.products?.forEach(p=>{const g=d.get(p);g&&(g.purchases||(g.purchases=[]),g.purchases.push(h))})}),o.rows.length>0&&console.log(`[Appwrite product] ${o.rows.length} produits synchronisÃ©s (delta)`),Array.from(d.values())}catch(n){console.error(`[Appwrite product] Erreur sync produits avec purchases pour mainId ${t}:`,n);const a=n instanceof Error?n.message:"Erreur lors de la synchronisation";throw new Error(`Ãchec de la synchronisation: ${a}`)}}async function Pd(t,e,r=!0){const{tables:s,config:n}=await D();return r&&(e.updatedBy=Ad()),await s.updateRow({databaseId:n.databaseId,tableId:n.collections.products,rowId:t,data:e})}async function Dd(t,e,r){try{const s=r(t);if(!s)throw new Error(`Produit ${t} non trouvÃ© localement pour crÃ©ation`);console.log(`[Appwrite product] CrÃ©ation produit ${t} sur Appwrite...`);const n=Id(s,e),a=await wg(n),{tables:o,config:c}=await D(),l=Ze.getEventById(a.mainId),u=Ca(l),d=await o.createRow({databaseId:c.databaseId,tableId:c.collections.products,rowId:t,data:a,permissions:u});return console.log(`[Appwrite product] Produit ${t} crÃ©Ã© avec permissions (labels + teams)`),d}catch(s){console.error(`[Appwrite product] Erreur crÃ©ation produit ${t}:`,s);const n=s instanceof Error?s.message:"Erreur inconnue";throw new Error(`Ãchec de la crÃ©ation du produit: ${n}`)}}async function vg(t,e){try{const{tables:r,config:s}=await D(),a=`${Cu(t.productName).substring(0,10)}_${Date.now().toString(36)}`,o={quantity:t.quantity,pF:t.pF||!1,pS:t.pS||!1},c={productHugoUuid:null,productName:t.productName,productType:t.productType||"Autre",store:t.store?JSON.stringify(t.store):null,who:t.who||[],isSynced:!0,mainId:e,status:"active",updatedBy:Ad(),stockReel:null,isMerged:!1,mergedFrom:null,mergeDate:null,mergeReason:null,mergedInto:null,totalNeededOverride:null,specs:JSON.stringify(o)};console.log(`[Appwrite product] CrÃ©ation produit manuel ${a}...`,c);const l=Ze.getEventById(e),u=Ca(l),d=await r.createRow({databaseId:s.databaseId,tableId:s.collections.products,rowId:a,data:c,permissions:u});return console.log(`[Appwrite product] Produit manuel ${a} crÃ©Ã© avec permissions Label`),d}catch(r){throw console.error("[Appwrite product] Erreur crÃ©ation produit manuel:",r),r}}async function bg(t,e,r){try{const s=r(t);if(!s)throw new Error(`Produit ${t} non trouvÃ© localement pour mise Ã  jour batch`);const n={};return e.stockReel!==void 0&&(n.stockReel=e.stockReel),e.who!==void 0&&(n.who=e.who),e.storeInfo!==void 0&&(n.store=JSON.stringify(e.storeInfo)),s.isSynced?(console.log(`[Appwrite product] Produit ${t} dÃ©jÃ  sync, update batch normal...`),await Pd(t,n)):(console.log(`[Appwrite product] Produit ${t} local, crÃ©ation batch avec upsert...`),await Dd(t,n,r))}catch(s){throw console.error(`[Appwrite product] Erreur lors de la mise Ã  jour batch du produit ${t}:`,s),s}}async function Eg(t,e){try{const{tables:r,config:s}=await D(),n=await r.updateRow(s.databaseId,s.collections.purchases,t,e);return console.log(`[Appwrite product] Achat ${t} mis Ã  jour:`,e),n}catch(r){console.error(`[Appwrite product] Erreur mise Ã  jour achat ${t}:`,r);const s=r instanceof Error?r.message:"Erreur inconnue";throw new Error(`Ãchec de la mise Ã  jour de l'achat: ${s}`)}}async function Sg(t){try{const{tables:e,config:r}=await D();await e.deleteRow(r.databaseId,r.collections.purchases,t),console.log(`[Appwrite product] Achat ${t} supprimÃ©`)}catch(e){console.error(`[Appwrite product] Erreur suppression achat ${t}:`,e);const r=e instanceof Error?e.message:"Erreur inconnue";throw new Error(`Ãchec de la suppression de l'achat: ${r}`)}}async function Md(t){if(!t?.length)return[];try{const{tables:e,config:r}=await D(),s=await e.listRows(r.databaseId,r.collections.purchases,[S.equal("$id",t)]);return console.log(`[Appwrite product] ${s.rows.length} purchases chargÃ©s avec relations products`),s.rows}catch(e){console.error("[Appwrite product] Erreur chargement purchases avec relations:",e);const r=e instanceof Error?e.message:"Erreur inconnue";throw new Error(`Ãchec du chargement des purchases: ${r}`)}}async function Ig(t,e,r,s){try{const{functions:n,config:a,account:o}=await D(),c=Gd.currentMainId;if(!c)throw new Error("No current event - cannot determine mainId for permissions");const l=await o.get(),u=t.map(g=>{const w=e.find(_=>_.$id===g);if(!w)throw new Error(`Product ${g} not found in products data`);return yg(w,s,r,c)});console.log(`[Appwrite product] Lancement mise Ã  jour groupÃ©e OPTIMISÃE: ${u.length} produits, type: ${r}`);const d={operation:"batchUpdateProductsOptimized",data:{rows:u,fromUserId:l.$id}},h=await Sd(()=>n.createExecution(a.functions.batchUpdate,JSON.stringify(d),!1,"/",_n.POST),{operationName:`batchUpdateProductsOptimized (${u.length} products, type: ${r})`,maxAutoRetries:1,autoRetryDelay:2e3});if(!h)throw new Error("OpÃ©ration annulÃ©e ou Ã©chouÃ©e aprÃ¨s tentatives de mise Ã  jour groupÃ©e optimisÃ©e");if(h.status!=="completed")throw new Error(`ExÃ©cution Ã©chouÃ©e avec statut: ${h.status}. Erreur: ${h.stderr||h.responseBody}`);const p=JSON.parse(h.responseBody);return p.success?console.log(`[Appwrite product] Mise Ã  jour groupÃ©e optimisÃ©e rÃ©ussie: ${p.updatedCount} produits mis Ã  jour`):console.error("[Appwrite product] Mise Ã  jour groupÃ©e optimisÃ©e Ã©chouÃ©e:",p.error),p}catch(n){console.error("[Appwrite products] Erreur mise Ã  jour groupÃ©e optimisÃ©e:",n);const a=n instanceof Error?n.message:"Erreur inconnue";return{success:!1,updatedCount:t.length,updateType:r,error:a,timestamp:new Date().toISOString()}}}async function Ag(t,e,r,s={}){try{const{tables:n,config:a,account:o}=await D(),c=await o.get(),l=Ze.getEventById(t),u=Ca(l),d=[];console.log("[Appwrite product] Debug createQuickValidationPurchases:",{mainId:t,productId:e,productIdType:typeof e,quantities:r,options:s});const h=s.status||"delivered";let p=s.deliveryDate||null;h==="delivered"&&!p&&(p=new Date().toISOString());for(const g of r){const w={products:[e],mainId:t,quantity:g.q,unit:g.u,status:h,notes:s.notes||`Validation rapide ${new Date().toLocaleDateString("fr-FR")}`,store:s.store??null,who:s.who||c.name,price:s.price||null,orderDate:s.orderDate||null,deliveryDate:p,createdBy:c.$id,invoiceId:s.invoiceId,invoiceTotal:null},_=await n.createRow(a.databaseId,a.collections.purchases,yt.unique(),w,u);d.push(_)}return console.log(`[Appwrite product] ${d.length} validations rapides crÃ©Ã©es avec permissions (labels + teams) pour produit ${e}`),d}catch(n){console.error("[Appwrite product] Erreur crÃ©ation validation rapide:",n);const a=n instanceof Error?n.message:"Erreur inconnue";throw new Error(`Ãchec de la validation rapide: ${a}`)}}async function _g(t,e,r,s,n,a){try{const{tables:o,config:c,account:l}=await D(),u=await l.get(),d=e||yt.unique(),h=u.name;if(!r)throw new Error("invoiceTotal est requis pour une dÃ©pense");const p=Ze.getEventById(t),g=Ca(p),w={products:[],mainId:t,quantity:1,unit:"global",status:"expense",notes:n||"",store:s??null,who:h||u.name,price:r,invoiceId:d,invoiceTotal:r,orderDate:null,deliveryDate:new Date().toISOString(),createdBy:u.$id},_=await o.createRow(c.databaseId,c.collections.purchases,yt.unique(),w,g);return console.log("[Appwrite product] DÃ©pense crÃ©Ã©e avec permissions (labels + teams):",_),_}catch(o){console.error("[Appwrite product] Erreur crÃ©ation dÃ©pense:",o);const c=o instanceof Error?o.message:"Erreur inconnue";throw new Error(`Ãchec de la crÃ©ation de la dÃ©pense: ${c}`)}}async function $d(t){try{const{tables:e,config:r}=await D(),s=await e.listRows(r.databaseId,r.collections.purchases,[S.equal("mainId",t),S.equal("status","expense"),S.limit(1e3)]);return console.log(`[Appwrite product] ${s.rows.length} dÃ©penses globales chargÃ©es`),s.rows}catch(e){return console.error("[Appwrite product] Erreur chargement dÃ©penses globales:",e),[]}}const Yr=Object.freeze(Object.defineProperty({__proto__:null,batchUpdateProductsOptimized:Ig,createExpensePurchase:_g,createManualProduct:vg,createQuickValidationPurchases:Ag,deletePurchase:Sg,enrichedProductToAppwriteProduct:Id,getEventPermissionsFromEvent:Ca,loadOrphanPurchases:$d,loadPurchasesListByIds:Md,loadUpdatedPurchases:_d,syncProductsWithPurchases:Rd,updateProduct:Pd,updateProductBatch:bg,updatePurchase:Eg,upsertProduct:Dd},Symbol.toStringTag,{value:"Module"}));class Rg{constructor(e){T(this,"dbName");T(this,"db",null);T(this,"version",1);T(this,"PRODUCTS_STORE","products");T(this,"METADATA_STORE","metadata");T(this,"LAST_SYNC_KEY","lastSync");T(this,"ALL_DATES_KEY","allDates");T(this,"HUGO_HASH_KEY","hugoContentHash");this.dbName=`products-cache-${e}`}async open(){if(!this.db)return new Promise((e,r)=>{const s=indexedDB.open(this.dbName,this.version);s.onerror=()=>r(s.error),s.onsuccess=()=>{this.db=s.result,console.log(`[IDBCache] Base ouverte: ${this.dbName}`),e()},s.onupgradeneeded=n=>{const a=n.target.result;a.objectStoreNames.contains(this.PRODUCTS_STORE)||(a.createObjectStore(this.PRODUCTS_STORE,{keyPath:"$id"}),console.log("[IDBCache] Object store 'products' crÃ©Ã©")),a.objectStoreNames.contains(this.METADATA_STORE)||(a.createObjectStore(this.METADATA_STORE,{keyPath:"key"}),console.log("[IDBCache] Object store 'metadata' crÃ©Ã© avec keyPath"))}})}async loadProducts(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,r)=>{const a=this.db.transaction(this.PRODUCTS_STORE,"readonly").objectStore(this.PRODUCTS_STORE).getAll();a.onsuccess=()=>{const o=new Map;a.result.forEach(c=>{o.set(c.$id,c)}),console.log(`[IDBCache] ${o.size} produits chargÃ©s`),e(o)},a.onerror=()=>r(a.error)})}async loadMetadata(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,r)=>{const a=this.db.transaction(this.METADATA_STORE,"readonly").objectStore(this.METADATA_STORE).getAll();a.onsuccess=()=>{const o=a.result,c={lastSync:null,allDates:[],hugoContentHash:null};o.forEach(l=>{l.key===this.LAST_SYNC_KEY?c.lastSync=l.value:l.key===this.ALL_DATES_KEY?c.allDates=l.value||[]:l.key===this.HUGO_HASH_KEY&&(c.hugoContentHash=l.value)}),console.log(`[IDBCache] Metadata chargÃ©es: lastSync=${c.lastSync}, dates=${c.allDates?.length||0}, hash=${c.hugoContentHash}`),e(c)},a.onerror=()=>r(a.error)})}async saveProducts(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction(this.PRODUCTS_STORE,"readwrite"),a=n.objectStore(this.PRODUCTS_STORE);a.clear(),e.forEach(o=>{a.put(o)}),n.oncomplete=()=>{console.log(`[IDBCache] ${e.size} produits sauvegardÃ©s`),r()},n.onerror=()=>s(n.error)})}async saveMetadata(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const n=this.db.transaction(this.METADATA_STORE,"readwrite"),a=n.objectStore(this.METADATA_STORE);a.put({key:this.LAST_SYNC_KEY,value:e.lastSync}),a.put({key:this.ALL_DATES_KEY,value:e.allDates}),e.hugoContentHash!==void 0&&a.put({key:this.HUGO_HASH_KEY,value:e.hugoContentHash}),n.oncomplete=()=>{console.log("[IDBCache] Metadata sauvegardÃ©es (objets {key, value})"),r()},n.onerror=()=>s(n.error)})}async updateLastSync(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.METADATA_STORE,"readwrite").objectStore(this.METADATA_STORE).put({key:this.LAST_SYNC_KEY,value:e});o.onsuccess=()=>{console.log(`[IDBCache] lastSync mis Ã  jour: ${e}`),r()},o.onerror=()=>s(o.error)})}async updateAllDates(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.METADATA_STORE,"readwrite").objectStore(this.METADATA_STORE).put({key:this.ALL_DATES_KEY,value:e});o.onsuccess=()=>{console.log(`[IDBCache] allDates mis Ã  jour: ${e.length} dates`),r()},o.onerror=()=>s(o.error)})}async updateHugoContentHash(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.METADATA_STORE,"readwrite").objectStore(this.METADATA_STORE).put({key:this.HUGO_HASH_KEY,value:e});o.onsuccess=()=>{console.log(`[IDBCache] hugoContentHash mis Ã  jour: ${e}`),r()},o.onerror=()=>s(o.error)})}async updateLastHugoMenuUpdate(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.METADATA_STORE,"readwrite").objectStore(this.METADATA_STORE).put({key:"lastHugoMenuUpdate",value:e});o.onsuccess=()=>{console.log("[IDBCache] lastHugoMenuUpdate sauvegardÃ©"),r()},o.onerror=()=>s(o.error)})}async upsertProduct(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.PRODUCTS_STORE,"readwrite").objectStore(this.PRODUCTS_STORE).put(e);o.onsuccess=()=>r(),o.onerror=()=>s(o.error)})}async deleteProduct(e){if(!this.db)throw new Error("DB non ouverte");return new Promise((r,s)=>{const o=this.db.transaction(this.PRODUCTS_STORE,"readwrite").objectStore(this.PRODUCTS_STORE).delete(e);o.onsuccess=()=>r(),o.onerror=()=>s(o.error)})}async clear(){if(!this.db)throw new Error("DB non ouverte");return new Promise((e,r)=>{const s=this.db.transaction([this.PRODUCTS_STORE,this.METADATA_STORE],"readwrite");s.objectStore(this.PRODUCTS_STORE).clear(),s.objectStore(this.METADATA_STORE).clear(),s.oncomplete=()=>{console.log("[IDBCache] Cache vidÃ©"),e()},s.onerror=()=>r(s.error)})}close(){this.db&&(this.db.close(),this.db=null,console.log("[IDBCache] Connexion fermÃ©e"))}}async function Pg(t){const e=new Rg(t);return await e.open(),e}var Kn,Yn;class As{constructor(e,r){y(this,Kn,P(ge({})));T(this,"dateStore");y(this,Yn,z(()=>{const e=this.dateStore.current;this.dateStore.dates;let r;if(e.start&&e.end)r=gp(this.data,e.start,e.end);else return{quantities:[],formattedQuantities:"",nbRecipes:0,totalAssiettes:0,stockResult:[],availableQuantities:[],missingQuantities:[],formattedMissingQuantities:"",formattedAvailableQuantities:"En attente",hasAvailable:!1,hasMissing:!1,concernedDates:[],recipesByDate:new Map};return{quantities:r.requiredQuantities,formattedQuantities:r.requiredQuantitiesFormatted,nbRecipes:r.totalRecipesInRange,totalAssiettes:r.totalPortionsInRange,stockResult:r.stockBalance,availableQuantities:r.availableStockQuantities,missingQuantities:r.missingStockQuantities,formattedMissingQuantities:r.missingStockFormatted,formattedAvailableQuantities:r.availableStockFormatted,hasAvailable:r.hasAvailableStock,hasMissing:r.hasMissingStock,concernedDates:r.datesInSelectedRange,recipesByDate:r.recipesByDate}}));this.data=e,this.dateStore=r}get data(){return f(i(this,Kn))}set data(e){m(i(this,Kn),e,!0)}update(e){this.data=e}get $id(){return this.data.$id}get productName(){return this.data.productName}get productType(){return this.data.productType}get storeInfo(){return this.data.storeInfo}get who(){return this.data.who}get pF(){return this.data.pF}get pS(){return this.data.pS}get status(){return this.data.status}get previousNames(){return this.data.previousNames}get purchases(){return this.data.purchases}get totalNeededOverrideParsed(){return this.data.totalNeededOverrideParsed}get displayMissingQuantity(){return this.data.displayMissingQuantity}get missingQuantityArray(){return this.data.missingQuantityArray}get isSynced(){return this.data.isSynced}get byDate(){return this.data.byDate}get stats(){return f(i(this,Yn))}set stats(e){m(i(this,Yn),e)}}Kn=new WeakMap,Yn=new WeakMap;var le,ve,Se,Xn,Zn,zn,Fn,ea,ta,ra,sa,na;class Dg{constructor(e=[]){y(this,le,P(ge([])));y(this,ve,P(null));y(this,Se,P(null));y(this,Xn,z(()=>[...f(i(this,le))].sort()[0]));y(this,Zn,z(()=>[...f(i(this,le))].sort()[f(i(this,le)).length-1]));y(this,zn,z(()=>{if(f(i(this,le)).length===0)return!0;const e=this.lastAvailableDate?new Date(this.lastAvailableDate):new Date;return e.setHours(23,59,59,999),e<new Date}));y(this,Fn,z(()=>{if(f(i(this,le)).length===0)return!1;const e=new Date;return e.setHours(0,0,0,0),f(i(this,le)).some(r=>new Date(r)>=e)}));y(this,ea,z(()=>f(i(this,ve))===this.firstAvailableDate&&f(i(this,Se))===this.lastAvailableDate));y(this,ta,z(()=>{if(f(i(this,le)).length===0)return!1;const e=[...f(i(this,le))].sort(),r=new Date;r.setHours(0,0,0,0);const s=e.find(o=>new Date(o)>=r)||null;let n,a;if(s)n=s,a=e[e.length-1];else{const o=e[e.length-1];n=o,a=o}return f(i(this,ve))===n&&f(i(this,Se))===a}));y(this,ra,z(()=>f(i(this,le)).length===1));y(this,sa,z(()=>!!(f(i(this,ve))&&f(i(this,ve))===f(i(this,Se)))));y(this,na,z(()=>{if(!f(i(this,ve))||!f(i(this,Se))||this.isEventPassed)return!1;const e=new Date(f(i(this,ve)));return e.setHours(e.getHours()+Tu),e<new Date}));m(i(this,le),e,!0),this.initializeSmartRange()}get start(){return f(i(this,ve))}get end(){return f(i(this,Se))}get dates(){return f(i(this,le))}get firstAvailableDate(){return f(i(this,Xn))}set firstAvailableDate(e){m(i(this,Xn),e)}get lastAvailableDate(){return f(i(this,Zn))}set lastAvailableDate(e){m(i(this,Zn),e)}get current(){return{start:f(i(this,ve)),end:f(i(this,Se))}}get isEventPassed(){return f(i(this,zn))}set isEventPassed(e){m(i(this,zn),e)}get hasUpcomingDates(){return f(i(this,Fn))}set hasUpcomingDates(e){m(i(this,Fn),e)}get isFullRange(){return f(i(this,ea))}set isFullRange(e){m(i(this,ea),e)}get isUpcomingRange(){return f(i(this,ta))}set isUpcomingRange(e){m(i(this,ta),e)}get hasSingleDateEvent(){return f(i(this,ra))}set hasSingleDateEvent(e){m(i(this,ra),e)}get hasSingleDateInRange(){return f(i(this,sa))}set hasSingleDateInRange(e){m(i(this,sa),e)}get hasPastDatesInRange(){return f(i(this,na))}set hasPastDatesInRange(e){m(i(this,na),e)}setAvailableDates(e){m(i(this,le),e,!0),this.initializeSmartRange()}setRange(e,r){if(!e&&!r){m(i(this,ve),null),m(i(this,Se),null);return}if(!e||!r){const a=e||r;m(i(this,ve),a,!0),m(i(this,Se),a,!0);return}const s=new Date(e)<=new Date(r)?e:r,n=new Date(e)>=new Date(r)?e:r;m(i(this,ve),s,!0),m(i(this,Se),n,!0)}selectAll(){f(i(this,le)).length!==0&&(m(i(this,ve),f(i(this,le))[0],!0),m(i(this,Se),f(i(this,le))[f(i(this,le)).length-1],!0))}selectUpcoming(){if(f(i(this,le)).length===0)return;const e=[...f(i(this,le))].sort(),r=new Date;r.setHours(0,0,0,0);const s=e.find(n=>new Date(n)>=r)||null;if(s)m(i(this,ve),s,!0),m(i(this,Se),e[e.length-1],!0);else{const n=e[e.length-1];m(i(this,ve),n,!0),m(i(this,Se),n,!0)}}selectFutureDatesOnly(){const e=new Date;e.setDate(e.getDate()+1),e.setHours(0,0,0,0);const r=f(i(this,le)).filter(s=>new Date(s)>=e);r.length>0&&(m(i(this,ve),r[0],!0),m(i(this,Se),r[r.length-1],!0))}initializeSmartRange(){if(f(i(this,le)).length===0)return;const e=[...f(i(this,le))].sort(),r=this.isEventPassed,s=new Date(e[0])<new Date,n=new Date;let a;r?a=e[0]:s?a=n.toISOString().slice(0,19)+"Z":a=e[0],m(i(this,ve),a,!0),m(i(this,Se),e[e.length-1],!0),console.log(`[DateRangeStore] Initialized: ${f(i(this,ve))} - ${f(i(this,Se))}`)}reset(){m(i(this,le),[],!0),m(i(this,ve),null),m(i(this,Se),null),console.log("[DateRangeStore] Reset")}}le=new WeakMap,ve=new WeakMap,Se=new WeakMap,Xn=new WeakMap,Zn=new WeakMap,zn=new WeakMap,Fn=new WeakMap,ea=new WeakMap,ta=new WeakMap,ra=new WeakMap,sa=new WeakMap,na=new WeakMap;function Mg(t,e={}){const{showOtherUserToasts:r=!0}=e;return s=>{const{events:n,payload:a}=s;if(!a)return;if(s.event==="client.connected"){t.onConnect?.();return}const o=n.some(h=>h.includes("products.")),c=n.some(h=>h.includes("purchases.")),l=n.some(h=>h.includes(".create")),u=n.some(h=>h.includes(".update")),d=n.some(h=>h.includes(".delete"));o?$g(a,{isCreate:l,isUpdate:u,isDelete:d},t,r):c&&kg(a,{isCreate:l,isUpdate:u,isDelete:d},t,r)}}function $g(t,e,r,s){const{isCreate:n,isUpdate:a,isDelete:o}=e;s&&t.updatedBy&&t.updatedBy!==k.userName&&(n||a?Ke.info(`${t.updatedBy} a modifiÃ© le produit "${t.productName}"`,{source:"realtime-other"}):o&&Ke.info(`${t.updatedBy} a supprimÃ© un produit`,{source:"realtime-other"})),n?r.onProductCreate(t):a?r.onProductUpdate(t):o&&r.onProductDelete(t.$id)}function kg(t,e,r,s){const{isCreate:n,isUpdate:a,isDelete:o}=e;if(s&&t.createdBy&&t.createdBy!==k.userName){const c="un produit";n&&t.who!==k.userName?Ke.info(`${t.who} a ajoutÃ© un achat pour ${c}`,{source:"realtime-other"}):a&&t.who!==k.userName?Ke.info(`${t.who} a modifiÃ© un achat pour ${c}`,{source:"realtime-other"}):o&&Ke.info(`${t.who} a supprimÃ© un achat pour ${c}`,{source:"realtime-other"})}n?r.onPurchaseCreate(t):a?r.onPurchaseUpdate(t):o&&r.onPurchaseDelete(t.$id)}function Cg(t,e={}){const r=dt(),s=vr("products"),n=vr("purchases"),a=[`databases.${r}.collections.${s}.documents`,`databases.${r}.collections.${n}.documents`],o=Mg(t,e),c=be.registerDynamic(a,o);return console.log(`[ProductsRealtimeHandler] â Realtime configurÃ© (${a.length} channels)`),c}const yl=1e3;var U,st,qe,de,Lr,aa,Js,hs,ps,Ge,re,jr,ia,q,oa,ca,la,ua,da,Di,fa,ha,Mi,j,kd,Ks,cr,Cd,Td,za,Fa,Nd,bo,Ng,ei,Ld,jd,qd,Od,Ud,ti,Eo,Bd,xd,Hd,Vd,Wd,pa,ma;class Tg{constructor(){y(this,j);y(this,U,new gt);y(this,st,new gt);y(this,qe,P(null));y(this,de,P(null));y(this,Lr,P(!1));y(this,aa,P(!1));y(this,Js,P(null));y(this,hs,P(!1));y(this,ps,P(!1));y(this,Ge,P(null));T(this,"dateStore",new Dg);y(this,re,null);y(this,jr,null);y(this,ia,P(ge([])));y(this,q,P(ge({searchQuery:"",selectedStores:[],selectedWho:[],selectedProductTypes:[],selectedTemperatures:[],temperatureFilter:"all",completionStatus:"all",groupBy:"productType",sortColumn:"",sortDirection:"asc"})));y(this,oa,z(()=>{const e=Array.from(i(this,U).values()).map(r=>r.data);return console.log(`[ProductsStore] enrichedProducts recalculated: ${e.length} products`),e}));y(this,ca,z(()=>{if(console.log("[Store] Filtering products by date range (Map)"),!this.dateRange.start||!this.dateRange.end)return new Map;new Date(this.dateRange.start),new Date(this.dateRange.end);const e=new Map,r=this.dateRange.start,s=this.dateRange.end;for(const[n,a]of i(this,U)){const o=a.data,c=!o.productHugoUuid;if(!o.byDate&&!c||!dp(o,f(i(this,q))))continue;if(f(i(this,q)).completionStatus!=="all"){const d=a.stats.hasMissing;if(f(i(this,q)).completionStatus==="completed"&&d||f(i(this,q)).completionStatus==="incomplete"&&!d)continue}let u=!1;o.byDate&&(u=Object.keys(o.byDate).some(d=>d>=r&&d<=s)),(u||c)&&e.set(n,a)}return e}));y(this,la,z(()=>({total:i(this,U).size,frais:Array.from(i(this,U).values()).filter(e=>e.pF).length,surgel:Array.from(i(this,U).values()).filter(e=>e.pS).length,merged:Array.from(i(this,U).values()).filter(e=>e.data.isMerged).length})));y(this,ua,z(()=>{const e=Array.from(i(this,U).values()).map(r=>r.storeInfo?.storeName).filter(Boolean);return[...new Set(e)]}));y(this,da,z(()=>{if(!f(i(this,de)))return[];const e=Ze.getEventById(f(i(this,de)));return e?.contributors?e.contributors.filter(r=>r.status==="accepted"&&r.name?.trim()).map(r=>r.name.trim()).sort():[]}));y(this,Di,z(()=>{const e=Array.from(i(this,U).values()).flatMap(r=>r.who||[]);return[...new Set(e)].sort()}));y(this,fa,z(()=>{const e=new Set([...this.eventContributors,...f(i(this,Di))]);return Array.from(e).sort()}));y(this,ha,z(()=>{const e=Array.from(i(this,U).values()).map(r=>r.productType).filter(Boolean);return[...new Set(e)]}));y(this,Mi,z(()=>{const r=Array.from(this.filteredProductsMap.values()).sort((o,c)=>o.$id.localeCompare(c.$id));if(f(i(this,q)).groupBy==="none")return{"":r};const s=Object.groupBy(r,o=>f(i(this,q)).groupBy==="store"?o.storeInfo?.storeName||"Non dÃ©fini":o.productType||"Non dÃ©fini"),n=Object.keys(s).sort((o,c)=>o===""?1:c===""?-1:o.localeCompare(c)),a={};return n.forEach(o=>{a[o]=s[o]}),a}));y(this,Ks,"");y(this,cr,null);T(this,"setSearchQuery",ap(e=>{f(i(this,q)).searchQuery=e,e.trim().length>0&&(f(i(this,q)).selectedStores=[],f(i(this,q)).selectedWho=[],f(i(this,q)).selectedProductTypes=[],f(i(this,q)).selectedTemperatures=[],f(i(this,q)).temperatureFilter="all",f(i(this,q)).completionStatus="all")},()=>500));y(this,pa,z(()=>{let e=0,r=0;for(const s of i(this,U).values())s.stats.hasMissing?r++:e++;return{completed:e,missing:r,total:e+r}}));y(this,ma,z(()=>{let e=0;const r={},s={},n=[];for(const a of i(this,st).values()){const o=a.invoiceTotal||a.price||0;e+=o;const c=a.store||"Non dÃ©fini";r[c]=(r[c]||0)+o;const l=a.who||"Non dÃ©fini";s[l]=(s[l]||0)+o,n.push(a)}for(const a of i(this,U).values()){const o=a.data;if(o.purchases&&o.purchases.length>0){for(const c of o.purchases)if(c.price){e+=c.price;const l=c.store||"Non dÃ©fini";r[l]=(r[l]||0)+c.price;const u=c.who||"Non dÃ©fini";s[u]=(s[u]||0)+c.price;const d={...c,_productName:o.productName};n.push(d)}}}return n.sort((a,o)=>{const c=new Date(a.orderDate||a.$createdAt).getTime();return new Date(o.orderDate||o.$createdAt).getTime()-c}),{totalGlobal:e,byStore:r,byWho:s,allPurchases:n}}))}get currentMainId(){return f(i(this,qe))}get dateRange(){return this.dateStore.current}get availableDates(){return this.dateStore.dates}get isEventPassed(){return this.dateStore.isEventPassed}get hasSingleDateEvent(){return this.dateStore.hasSingleDateEvent}get hasSingleDateInRange(){return this.dateStore.hasSingleDateInRange}get hasPastDatesInRange(){return this.dateStore.hasPastDatesInRange}get hasPendingConflicts(){return f(i(this,ia)).length>0}get pendingConflicts(){return f(i(this,ia))}get filters(){return f(i(this,q))}get hasFilters(){return this.filters.searchQuery!==""||this.filters.selectedStores.length>0||this.filters.selectedWho.length>0||this.filters.selectedProductTypes.length>0||this.filters.selectedTemperatures.length>0||this.filters.temperatureFilter!=="all"||this.filters.completionStatus!=="all"}get isSearchActive(){return this.filters.searchQuery.trim().length>0}get activeFiltersDescription(){const e=[];if(this.filters.completionStatus==="incomplete"?e.push("Manquants"):this.filters.completionStatus==="completed"&&e.push("Complets"),this.filters.temperatureFilter!=="all"){const r={frais:"Frais","not-frais":"Sans frais",surgele:"SurgelÃ©s","not-surgele":"Sans surgelÃ©s"};e.push(r[this.filters.temperatureFilter]||"")}return this.filters.selectedProductTypes.length>0&&e.push(`Types: ${this.filters.selectedProductTypes.length}`),this.filters.selectedStores.length>0&&e.push(`Magasins: ${this.filters.selectedStores.length}`),this.filters.selectedWho.length>0&&e.push(`Qui: ${this.filters.selectedWho.length}`),e}get groupedFilteredProducts(){return f(i(this,Mi))}get loading(){return f(i(this,aa))}get error(){return f(i(this,Js))}get lastSync(){return f(i(this,Ge))}get syncing(){return f(i(this,hs))}setDateRange(e,r){this.dateStore.setRange(e,r)}isFullRange(){return this.dateStore.isFullRange}initializeDateRange(){this.dateStore.initializeSmartRange()}selectUpcomingDates(){this.dateStore.selectUpcoming()}isUpcomingRange(){return this.dateStore.isUpcomingRange}get firstAvailableDate(){return this.dateStore.firstAvailableDate}get lastAvailableDate(){return this.dateStore.lastAvailableDate}selectFutureDatesOnly(){this.dateStore.selectFutureDatesOnly()}get realtimeConnected(){return f(i(this,ps))}get enrichedProducts(){return f(i(this,oa))}set enrichedProducts(e){m(i(this,oa),e)}get filteredProductsMap(){return f(i(this,ca))}set filteredProductsMap(e){m(i(this,ca),e)}get stats(){return f(i(this,la))}set stats(e){m(i(this,la),e)}get uniqueStores(){return f(i(this,ua))}set uniqueStores(e){m(i(this,ua),e)}get eventContributors(){return f(i(this,da))}set eventContributors(e){m(i(this,da),e)}get uniqueWho(){return f(i(this,fa))}set uniqueWho(e){m(i(this,fa),e)}get uniqueProductTypes(){return f(i(this,ha))}set uniqueProductTypes(e){m(i(this,ha),e)}async initialize(e){if(!e?.trim())throw new Error("eventId invalide fourni");if(f(i(this,Lr))&&f(i(this,de))===e){console.log(`[ProductsStore] DÃ©jÃ  initialisÃ© pour eventId: ${e}`);return}f(i(this,Lr))&&f(i(this,de))!==e&&(console.log(`[ProductsStore] Changement d'Ã©vÃ©nement: ${f(i(this,de))} â ${e}, reset...`),this.reset()),console.log(`[ProductsStore] Initialisation avec eventId: ${e}`);const r=Ze.getEventById(e);if(!r)throw new Error(`ÃvÃ©nement ${e} introuvable dans EventsStore`);try{m(i(this,de),r.$id,!0),m(i(this,qe),r.$id,!0),console.log(`[ProductsStore] Initialisation du cache IDB pour mainId: ${f(i(this,qe))}`),I(this,re,await Pg(f(i(this,qe)))),await b(this,j,Td).call(this),i(this,U).size===0&&(console.log("[ProductsStore] Cache vide, calcul depuis event.meals..."),await b(this,j,Cd).call(this,r),await b(this,j,za).call(this)),this.dateStore.setAvailableDates([...r.allDates||[]]),this.initializeDateRange(),await this.syncFromAppwrite(),await b(this,j,Wd).call(this),m(i(this,Lr),!0),b(this,j,xd).call(this),i(this,cr)&&i(this,cr).call(this),I(this,cr,tu(()=>{Vr(()=>{const s=Ze.getEventById(e);s&&b(this,j,kd).call(this,s)})})),console.log(`[ProductsStore] Initialisation complÃ©tÃ©e: ${i(this,U).size} produits`)}catch(s){const n=s instanceof Error?s.message:"Erreur lors de l'initialisation";throw m(i(this,Js),n,!0),console.error("[ProductsStore]",n,s),s}}async syncFromAppwrite(){if(ae(f(i(this,de)))){console.log("[ProductsStore] Mode local: skip syncFromAppwrite");return}if(f(i(this,qe))){m(i(this,hs),!0),console.log(`[ProductsStore] DÃ©but syncFromAppwrite pour mainId: ${f(i(this,qe))}`);try{console.log(`[ProductsStore] RÃ©cupÃ©ration des produits modifiÃ©s depuis lastSync: ${f(i(this,Ge))}`);const e=await Rd(f(i(this,qe)),{lastSync:f(i(this,Ge)),limit:yl});if(console.log(`[ProductsStore] ${e.length} produits rÃ©cupÃ©rÃ©s depuis Appwrite`),e.forEach(r=>{const s=i(this,U).get(r.$id);console.log(`[ProductsStore] Sync produit ${r.$id}: existing=${!!s}, who=${r.who}, store=${r.store}`);const n=b(this,j,bo).call(this,r,s?.data);n.isSynced=!0,n.status="active",s?s.update(n):i(this,U).set(r.$id,new As(n,this.dateStore))}),f(i(this,Ge))){console.log(`[ProductsStore] RÃ©cupÃ©ration des purchases modifiÃ©s depuis lastSync: ${f(i(this,Ge))}`);const r=await _d(f(i(this,qe)),f(i(this,Ge)),yl);console.log(`[ProductsStore] ${r.length} purchases modifiÃ©s rÃ©cupÃ©rÃ©s`),r.forEach(s=>{if(s.status==="expense")i(this,st).set(s.$id,s);else if(s.products?.length){const n=s.products.map(a=>typeof a=="string"?a:a.$id);b(this,j,ti).call(this,n,s)}})}b(this,j,Nd).call(this),await b(this,j,za).call(this),console.log("[ProductsStore] SyncFromAppwrite terminÃ© avec succÃ¨s")}catch(e){throw console.error("[ProductsStore] Erreur lors du sync:",e),e}finally{m(i(this,hs),!1)}}}toggleProductType(e){const r=f(i(this,q)).selectedProductTypes.indexOf(e);r>-1?f(i(this,q)).selectedProductTypes.splice(r,1):f(i(this,q)).selectedProductTypes.push(e)}toggleTemperature(e){const r=f(i(this,q)).selectedTemperatures.indexOf(e);r>-1?f(i(this,q)).selectedTemperatures.splice(r,1):f(i(this,q)).selectedTemperatures.push(e)}setTemperatureFilter(e){f(i(this,q)).temperatureFilter=e}clearTypeAndTemperatureFilters(){f(i(this,q)).selectedProductTypes=[],f(i(this,q)).selectedTemperatures=[],f(i(this,q)).temperatureFilter="all"}setGroupBy(e){f(i(this,q)).groupBy=e}toggleStore(e){const r=f(i(this,q)).selectedStores.indexOf(e);r>-1?f(i(this,q)).selectedStores.splice(r,1):f(i(this,q)).selectedStores.push(e)}toggleWho(e){const r=f(i(this,q)).selectedWho.indexOf(e);r>-1?f(i(this,q)).selectedWho.splice(r,1):f(i(this,q)).selectedWho.push(e)}clearStoreFilters(){f(i(this,q)).selectedStores=[]}clearWhoFilters(){f(i(this,q)).selectedWho=[]}setCompletionStatus(e){f(i(this,q)).completionStatus=e}handleSort(e){f(i(this,q)).sortColumn===e?f(i(this,q)).sortDirection=f(i(this,q)).sortDirection==="asc"?"desc":"asc":(f(i(this,q)).sortColumn=e,f(i(this,q)).sortDirection="asc")}clearFilters(){m(i(this,q),{searchQuery:"",selectedStores:[],selectedWho:[],selectedProductTypes:[],selectedTemperatures:[],temperatureFilter:"all",completionStatus:"all",groupBy:"productType",sortColumn:"",sortDirection:"asc"},!0)}sortProducts(e){return f(i(this,q)).sortColumn?[...e].sort((r,s)=>{let n=r[f(i(this,q)).sortColumn],a=s[f(i(this,q)).sortColumn];return f(i(this,q)).sortColumn==="totalNeededConsolidated"?(n=parseFloat(n)||0,a=parseFloat(a)||0):f(i(this,q)).sortColumn==="purchases"&&(n=r.purchases?.length||0,a=s.purchases?.length||0),n<a?f(i(this,q)).sortDirection==="asc"?-1:1:n>a?f(i(this,q)).sortDirection==="asc"?1:-1:0}):e}getEnrichedProductById(e){return i(this,U).get(e)?.data??null}getProductModelById(e){return i(this,U).get(e)??null}hasConversions(e){const r=i(this,U).get(e)?.data;return r?.byDate?up(r.byDate):!1}async forceReload(e){await this.clearCache(),await this.initialize(e)}async clearCache(){i(this,U).clear(),m(i(this,Ge),null),i(this,re)&&await i(this,re).clear(),console.log("[ProductsStore] Cache vidÃ©")}setSyncStatus(e,r){const s=r?"isSyncing":"active";e.forEach(n=>{const a=i(this,U).get(n);if(a){const o={...a.data,status:s};a.update(o)}}),console.log(`[ProductsStore] Statut de synchronisation mis Ã  jour: ${e.length} produits â ${s}`)}clearSyncStatus(){const e=[];for(const[r,s]of i(this,U))s.status==="isSyncing"&&e.push(r);e.length>0&&(this.setSyncStatus(e,!1),console.log(`[ProductsStore] Nettoyage de ${e.length} produits en statut "isSyncing"`))}reset(){var e;console.log(`[ProductsStore] Reset pour eventId: ${f(i(this,de))}`),(e=i(this,jr))==null||e.call(this),I(this,jr,null),i(this,cr)&&(i(this,cr).call(this),I(this,cr,null)),i(this,re)&&(i(this,re).close(),I(this,re,null)),i(this,U).clear(),i(this,st).clear(),m(i(this,qe),null),m(i(this,de),null),m(i(this,Lr),!1),m(i(this,aa),!1),m(i(this,Js),null),m(i(this,hs),!1),m(i(this,ps),!1),m(i(this,Ge),null),I(this,Ks,""),this.dateStore.reset(),m(i(this,q),{searchQuery:"",selectedStores:[],selectedWho:[],selectedProductTypes:[],selectedTemperatures:[],temperatureFilter:"all",completionStatus:"all",groupBy:"productType",sortColumn:"",sortDirection:"asc"},!0),console.log("[ProductsStore] Reset terminÃ©")}async createPurchaseLocal(e,r,s){const n=i(this,U).get(e);if(!n)throw new Error(`Produit ${e} introuvable`);const a=s.status||"delivered";let o=s.deliveryDate||null;a==="delivered"&&!o&&(o=new Date().toISOString());const c={$id:crypto.randomUUID(),$createdAt:new Date().toISOString(),$updatedAt:new Date().toISOString(),$databaseId:"localDemo",$tableId:"localDemo",$permissions:[],$sequence:0,invoiceId:s.invoiceId||null,notes:s.notes||"",store:s.store||null,mainId:f(i(this,de)),unit:r[0]?.u||"",quantity:r.reduce((d,h)=>d+h.q,0),price:s.price||null,status:a,who:s.who||null,createdBy:"guest",orderDate:s.orderDate||new Date().toISOString(),deliveryDate:o,invoiceTotal:null,products:[e]},l=Rs(n.data),u={...l,purchases:[...l.purchases||[],c],$updatedAt:new Date().toISOString()};i(this,re)&&await i(this,re).upsertProduct(u),n.update(u),console.log(`[ProductsStore] Mode local: purchase crÃ©Ã© pour ${e}`)}async createProductLocal(e){const r=crypto.randomUUID(),s={$id:r,$createdAt:new Date().toISOString(),$updatedAt:new Date().toISOString(),$permissions:[],productHugoUuid:null,productName:e.productName,productType:e.productType||"ingredient",pF:e.pF??!1,pS:e.pS??!1,nbRecipes:0,totalAssiettes:0,isSynced:!1,mainId:f(i(this,de)),totalNeededRaw:[],status:e.status||"ok",who:e.who||null,store:e.store||"",stockReel:e.stockReel||null,previousNames:null,isMerged:!1,mergedFrom:null,mergeDate:null,mergeReason:null,isLocal:!0,mergedInto:null,totalNeededOverride:null,updatedBy:null,specs:null,purchases:[],pL:null,byDate:{},storeInfo:null,totalNeededOverrideParsed:null,displayMissingQuantity:null,missingQuantityArray:null},n=new As(s,this.dateStore);return i(this,U).set(r,n),i(this,re)&&await i(this,re).upsertProduct(s),console.log(`[ProductsStore] Mode local: produit crÃ©Ã© ${r}`),r}async updateProductLocal(e,r){const s=i(this,U).get(e);if(!s)throw new Error(`Produit ${e} introuvable`);const n={...s.data,...r,$updatedAt:new Date().toISOString()};if(s.update(n),i(this,re)){const a=Rs(s.data);await i(this,re).upsertProduct(a)}console.log(`[ProductsStore] Mode local: produit mis Ã  jour ${e}`)}async addPurchaseToLocal(e,r,s){return await this.createPurchaseLocal(e,r,s)}async updatePurchaseLocal(e,r){let s=null;for(const[o,c]of i(this,U))if(c.data.purchases?.some(l=>l.$id===e)){s=o;break}if(!s)throw new Error(`Purchase ${e} introuvable`);const a=i(this,U).get(s).data.purchases.map(o=>o.$id===e?{...o,...r,$updatedAt:new Date().toISOString()}:o);await this.updateProductLocal(s,{purchases:a})}async deletePurchaseLocal(e){let r=null;for(const[a,o]of i(this,U))if(o.data.purchases?.some(c=>c.$id===e)){r=a;break}if(!r)throw new Error(`Purchase ${e} introuvable`);const n=i(this,U).get(r).data.purchases.filter(a=>a.$id!==e);await this.updateProductLocal(r,{purchases:n})}async createPurchase(e,r,s){if(ae(f(i(this,de))))return await this.createPurchaseLocal(e,r,s);{const{createQuickValidationPurchases:n}=await W(async()=>{const{createQuickValidationPurchases:a}=await Promise.resolve().then(()=>Yr);return{createQuickValidationPurchases:a}},void 0);await n(f(i(this,qe)),e,r,s)}}async updatePurchase(e,r){if(ae(f(i(this,de))))return await this.updatePurchaseLocal(e,r);{const{updatePurchase:s}=await W(async()=>{const{updatePurchase:n}=await Promise.resolve().then(()=>Yr);return{updatePurchase:n}},void 0);await s(e,r)}}async deletePurchase(e){if(ae(f(i(this,de))))return await this.deletePurchaseLocal(e);{const{deletePurchase:r}=await W(async()=>{const{deletePurchase:s}=await Promise.resolve().then(()=>Yr);return{deletePurchase:s}},void 0);await r(e)}}async createProduct(e){if(ae(f(i(this,de))))return await this.createProductLocal(e);{const{upsertProduct:r}=await W(async()=>{const{upsertProduct:n}=await Promise.resolve().then(()=>Yr);return{upsertProduct:n}},void 0);return(await r(crypto.randomUUID(),e,n=>this.getEnrichedProductById(n))).$id}}async updateProduct(e,r){if(ae(f(i(this,de))))return await this.updateProductLocal(e,r);{const{updateProduct:s}=await W(async()=>{const{updateProduct:n}=await Promise.resolve().then(()=>Yr);return{updateProduct:n}},void 0);await s(e,r)}}async updateProductBatch(e,r,s){if(ae(f(i(this,de))))for(const[n,a]of Object.entries(r))await this.updateProductLocal(e,{[n]:a});else{const{updateProductBatch:n}=await W(async()=>{const{updateProductBatch:a}=await Promise.resolve().then(()=>Yr);return{updateProductBatch:a}},void 0);await n(e,r,s||(a=>this.getEnrichedProductById(a)))}}async batchUpdateProducts(e,r,s,n){if(ae(f(i(this,de))))return await b(this,j,Hd).call(this,e,s,n);{const{batchUpdateProductsOptimized:a}=await W(async()=>{const{batchUpdateProductsOptimized:o}=await Promise.resolve().then(()=>Yr);return{batchUpdateProductsOptimized:o}},void 0);return await a(e,r,s,n)}}async createGroupPurchase(e,r){if(ae(f(i(this,de))))return await b(this,j,Vd).call(this,e,r);{const{createGroupPurchaseWithSync:s}=await W(async()=>{const{createGroupPurchaseWithSync:n}=await Promise.resolve().then(()=>Kg);return{createGroupPurchaseWithSync:n}},void 0);return await s(f(i(this,qe)),e,r)}}destroy(){var e;(e=i(this,jr))==null||e.call(this),I(this,jr,null),i(this,re)&&(i(this,re).close(),I(this,re,null)),console.log("[ProductsStore] Ressources nettoyÃ©es")}get completionStats(){return f(i(this,pa))}set completionStats(e){m(i(this,pa),e)}get financialStats(){return f(i(this,ma))}set financialStats(e){m(i(this,ma),e)}}U=new WeakMap,st=new WeakMap,qe=new WeakMap,de=new WeakMap,Lr=new WeakMap,aa=new WeakMap,Js=new WeakMap,hs=new WeakMap,ps=new WeakMap,Ge=new WeakMap,re=new WeakMap,jr=new WeakMap,ia=new WeakMap,q=new WeakMap,oa=new WeakMap,ca=new WeakMap,la=new WeakMap,ua=new WeakMap,da=new WeakMap,Di=new WeakMap,fa=new WeakMap,ha=new WeakMap,Mi=new WeakMap,j=new WeakSet,kd=async function(e){if(!f(i(this,Lr))){console.warn("[ProductsStore] Sync ignorÃ© car store non initialisÃ©");return}const r=JSON.stringify(e.meals);if(i(this,Ks)===r)return;console.log(`[ProductsStore] â¡ï¸ CHANGEMENT REPAS DÃTECTÃ pour ${e.$id} (Hash: ${r.substring(0,10)}...), recalcul...`),I(this,Ks,r);const n=await gl(e,async o=>await mi.getRecipeByUuid(o),e.$id);n.forEach(o=>{const c=i(this,U).get(o.$id);if(c){const u={...c.data,byDate:o.byDate,totalNeededArray:o.totalNeededArray,totalNeededRaw:o.totalNeededRaw,nbRecipes:o.nbRecipes,totalAssiettes:o.totalAssiettes};hg(u),c.update(u)}else i(this,U).set(o.$id,new As(o,this.dateStore))});const a=new Set(n.map(o=>o.$id));for(const[o,c]of i(this,U))a.has(o)||!c.data.isSynced&&!c.data.purchases?.length&&i(this,U).delete(o);this.dateStore.setAvailableDates([...e.allDates||[]]),b(this,j,za).call(this)},Ks=new WeakMap,cr=new WeakMap,Cd=async function(e){const s=await gl(e,async n=>await mi.getRecipeByUuid(n),e.$id);s.forEach(n=>{i(this,U).set(n.$id,new As(n,this.dateStore))}),console.log(`[ProductsStore] ${s.length} produits calculÃ©s depuis ${e.meals.length} repas`)},Td=async function(){if(i(this,re))try{const e=await i(this,re).loadProducts();e.forEach((s,n)=>{s.status==="isSyncing"&&(s.status="active"),i(this,U).set(n,new As(s,this.dateStore))});const r=await i(this,re).loadMetadata();m(i(this,Ge),r.lastSync,!0),this.dateStore.setAvailableDates([...r.allDates]),console.log(`[ProductsStore] ${e.size} produits chargÃ©s du cache IDB, lastSync: ${r.lastSync}`)}catch(e){console.warn("[ProductsStore] Erreur lecture cache IDB, ignorÃ©:",e)}},za=async function(){if(i(this,re))try{const e=new Map;i(this,U).forEach((r,s)=>{const n=Rs(r.data);n.status==="isSyncing"&&(n.status="active"),e.set(s,n)}),await i(this,re).saveProducts(e),await i(this,re).saveMetadata({lastSync:f(i(this,Ge)),allDates:[...this.dateStore.dates]}),console.log("[ProductsStore] Cache IDB persistÃ©")}catch(e){console.error("[ProductsStore] Erreur persist cache IDB:",e)}},Fa=async function(e){if(!(!i(this,re)||e.length===0))try{const r=e.map(s=>i(this,U).get(s)?.data).filter(s=>s!=null).map(s=>{const n=Rs(s);return n.status==="isSyncing"&&(n.status="active"),i(this,re).upsertProduct(n)});r.length>0&&(await Promise.all(r),console.log(`[ProductsStore] ${r.length} produits affectÃ©s persistÃ©s`))}catch(r){console.error("[ProductsStore] Erreur persistence produits affectÃ©s:",r)}},Nd=function(){m(i(this,Ge),new Date().toISOString(),!0)},bo=function(e,r){return r?Ba(e,r):fg(e)},Ng=function(e){e.length&&(e.forEach(r=>b(this,j,ei).call(this,r)),console.log(`[ProductsStore] ${e.length} produits upserted`))},ei=function(e){const r=i(this,U).get(e.$id),s=b(this,j,bo).call(this,e,r?.data);r?r.update(s):(this.dateStore.dates,i(this,U).set(e.$id,new As(s,this.dateStore)))},Ld=function(e){i(this,U).delete(e)},jd=async function(e){if(!e.products?.length)return console.warn("[ProductsStore] Purchase crÃ©Ã© sans products:",e.$id),[];const r=e.products.map(s=>typeof s=="string"?s:s.$id).filter(Boolean);return b(this,j,Ud).call(this,r,e),r},qd=async function(e){if(e.products?.length){const r=e.products.map(s=>typeof s=="string"?s:s.$id).filter(Boolean);return b(this,j,ti).call(this,r,e),r}console.log("[ProductsStore] Purchase update sans products[], rechargement...");try{const[r]=await Md([e.$id]);if(r?.products?.length){const s=r.products.map(n=>typeof n=="string"?n:n.$id).filter(Boolean);return b(this,j,ti).call(this,s,r),s}return[]}catch(r){return console.error("[ProductsStore] Erreur rechargement purchase:",r),[]}},Od=async function(e){const r=Array.from(i(this,U).values()).map(s=>s.data).filter(s=>s.purchases?.some(n=>n.$id===e));return r.forEach(s=>{b(this,j,ei).call(this,s)}),r.map(s=>s.$id)},Ud=function(e,r){const s=Lc(r),n=[];e.forEach(a=>{const o=i(this,U).get(a);if(o){const c=o.data,l=c.purchases||[];if(!l.some(u=>u.$id===s.$id)){const u=Ba({...c,purchases:[...l,s],status:"active"},c);n.push(u)}}}),n.forEach(a=>{const o=i(this,U).get(a.$id);o&&o.update(a)})},ti=function(e,r){const s=Lc(r),n=[];e.forEach(a=>{const o=i(this,U).get(a);if(o){const c=o.data,l=c.purchases||[],u=l.findIndex(d=>d.$id===s.$id);if(u>=0){const d=[...l];d[u]=s;const h=Ba({...c,purchases:d,status:"active"},c);n.push(h)}else{const d=Ba({...c,purchases:[...l,r],status:"active"},c);n.push(d)}}}),n.forEach(a=>{const o=i(this,U).get(a.$id);o&&o.update(a)})},Eo=function(e){if(b(this,j,ei).call(this,e),i(this,re)){const r=i(this,U).get(e.$id);r&&i(this,re).upsertProduct(Rs(r.data)).catch(s=>console.error("[ProductsStore] Erreur persistence produit:",s))}},Bd=function(){return{onProductCreate:e=>b(this,j,Eo).call(this,e),onProductUpdate:e=>b(this,j,Eo).call(this,e),onProductDelete:e=>{b(this,j,Ld).call(this,e),i(this,re)&&i(this,re).deleteProduct(e).catch(r=>console.error("[ProductsStore] Erreur suppression produit:",r))},onPurchaseCreate:async e=>{if(e.status==="expense"){i(this,st).set(e.$id,e);return}const r=await b(this,j,jd).call(this,e);await b(this,j,Fa).call(this,r)},onPurchaseUpdate:async e=>{if(e.status==="expense"){i(this,st).set(e.$id,e);return}i(this,st).has(e.$id)&&i(this,st).delete(e.$id);const r=await b(this,j,qd).call(this,e);await b(this,j,Fa).call(this,r)},onPurchaseDelete:async e=>{if(i(this,st).has(e)){i(this,st).delete(e);return}const r=await b(this,j,Od).call(this,e);await b(this,j,Fa).call(this,r)},onConnect:()=>{m(i(this,ps),!0)},onDisconnect:()=>{m(i(this,ps),!1)},onError:e=>{console.error("[ProductsStore] Erreur realtime:",e)}}},xd=function(){if(ae(f(i(this,de)))){console.log("[ProductsStore] Mode local: skip realtime setup");return}const e=b(this,j,Bd).call(this);I(this,jr,Cg(e))},Hd=async function(e,r,s){try{let n=0;for(const a of e){if(r==="who"){const o=s.names||[];await this.updateProductLocal(a,{who:o})}else if(r==="store"){const o=s;await this.updateProductLocal(a,{storeInfo:o})}n++}return{success:!0,updatedCount:n,updateType:r,timestamp:new Date().toISOString()}}catch(n){return{success:!1,updatedCount:0,updateType:r,error:n instanceof Error?n.message:"Erreur inconnue",timestamp:new Date().toISOString()}}},Vd=async function(e,r){try{if(!e?.length)return{success:!1,results:[],totalProductsCreated:0,totalPurchasesCreated:0,totalExpensesCreated:0,error:"Aucun produit Ã  traiter"};let s=0;for(const n of e)await this.createPurchaseLocal(n.productId,n.missingQuantities,{invoiceId:r.invoiceId,notes:r.notes,store:r.store}),s++;return{success:!0,results:[],totalProductsCreated:e.length,totalPurchasesCreated:s,totalExpensesCreated:0}}catch(s){return{success:!1,results:[],totalProductsCreated:0,totalPurchasesCreated:0,totalExpensesCreated:0,error:s instanceof Error?s.message:"Erreur inconnue"}}},Wd=async function(){if(ae(f(i(this,de)))){console.log("[ProductsStore] Mode local: skip loadOrphanPurchases");return}if(f(i(this,qe)))try{const e=await $d(f(i(this,qe)));e.forEach(r=>{i(this,st).set(r.$id,r)}),console.log(`[ProductsStore] ${e.length} dÃ©penses globales chargÃ©es`)}catch(e){console.error("[ProductsStore] Erreur chargement dÃ©penses globales:",e)}},pa=new WeakMap,ma=new WeakMap;const Gd=new Tg,{APPWRITE_CONFIG:Bi}=bs();async function Lg(t,e){return Kt(async()=>{const{functions:r}=await D(),s=await r.createExecution({functionId:Bi.functions.usersTeamsManager,body:JSON.stringify({action:"remove-user-from-event",mainId:t,teamId:e}),async:!1}),n=Pa(s.responseBody,{context:"removeTeamFromEvent",fallback:null});if(!n||!n.success)throw new Error(n?.error||"Erreur lors du retrait de la team");console.log(`[appwrite-functions] Team ${e} retirÃ©e de l'Ã©vÃ©nement ${t}`)},{context:"AppwriteFunctions.removeTeamFromEvent",timeout:6e4,errorMessage:"Erreur lors du retrait de la team"})}async function jg(t){return Kt(async()=>{const{functions:e}=await D(),r=await e.createExecution({functionId:Bi.functions.usersTeamsManager,body:JSON.stringify({action:"checkEmails",emails:t}),async:!1}),s=Pa(r.responseBody,{context:"checkUserEmails",fallback:null});if(!s||!s.success)throw new Error(s?.error||"Erreur lors de la vÃ©rification des emails");return s.data},{context:"AppwriteFunctions.checkUserEmails",timeout:15e3,errorMessage:"Erreur lors de la vÃ©rification des emails"})}async function qg(t,e,r){const{teamIds:s=[],emails:n=[],userIds:a=[],message:o,sendEmailToExistingMembers:c=!0}=r;return Kt(async()=>{const{functions:l}=await D(),u=await l.createExecution({functionId:Bi.functions.usersTeamsManager,body:JSON.stringify({action:"invite",context:{type:"event",id:t,name:e},teamIds:s,emails:n,userIds:a,message:o,sendEmailToExistingMembers:c}),async:!1}),d=Pa(u.responseBody,{context:"inviteParticipantsToEvent",fallback:null});if(!d||!d.success)throw new Error(d?.error||"Erreur lors de l'invitation");return console.log(`[appwrite-functions] ${d.processed} invitations traitÃ©es pour ${e}`),d},{context:"AppwriteFunctions.inviteParticipantsToEvent",timeout:6e4,errorMessage:"Erreur lors de l'invitation"})}async function Og(t,e){return Kt(async()=>{const{functions:r}=await D(),s=await r.createExecution({functionId:Bi.functions.usersTeamsManager,body:JSON.stringify({action:"remove-user-from-event",mainId:t,userId:e}),async:!1}),n=Pa(s.responseBody,{context:"removeUserFromEvent",fallback:null});if(!n||!n.success)throw new Error(n?.error||"Erreur lors du retrait de l'utilisateur");console.log(`[appwrite-functions] Utilisateur ${e} retirÃ© de l'Ã©vÃ©nement ${t}`)},{context:"AppwriteFunctions.removeUserFromEvent",timeout:1e4,errorMessage:"Erreur lors du retrait de l'utilisateur"})}const zi=Object.freeze(Object.defineProperty({__proto__:null,checkUserEmails:jg,inviteParticipantsToEvent:qg,removeTeamFromEvent:Lg,removeUserFromEvent:Og},Symbol.toStringTag,{value:"Module"})),Ug=bs().APPWRITE_CONFIG;async function Yy(t,e){try{const{functions:r}=await D(),s=await r.createExecution({functionId:Ug.functions.invitation,body:JSON.stringify({action:"exchange-invite",userId:t,teamId:e})}),n=JSON.parse(s.responseBody);if(!n.success)throw new Error(n.error||"L'invitation est invalide.");return{token:n.token,userId:n.userId,hasMembership:n.hasMembership||!1,membershipRevoked:n.membershipRevoked||!1,teamName:n.teamName||null}}catch(r){throw console.error("[invitations] Error validating invitation:",r),r}}var Bg=(t=>(t.ENTREE="entree",t.PLAT="plat",t.DESSERT="dessert",t.AUTRE="autre",t))(Bg||{}),xg=(t=>(t.PUBLIC="public",t.PRIVATE="private",t.DELETED="deleted",t))(xg||{});const Hg=7,Xy={async getLock(t){const{tables:e}=await D();try{const r=await e.getRow({databaseId:dt(),tableId:vr("locks"),rowId:t});return!r.userId||new Date(r.expiresAt)<new Date?null:r}catch(r){if(r.code===404)return null;throw r}},async acquireLock(t,e,r){const{tables:s}=await D(),n=new Date(Date.now()+Hg*60*1e3).toISOString(),a={userId:e,userName:r,expiresAt:n},o=[te.read(ie.any()),te.update(ie.user(e))];try{return await s.updateRow({databaseId:dt(),tableId:vr("locks"),rowId:t,data:a,permissions:o}),!0}catch(c){if(c.code===404)try{return await s.createRow({databaseId:dt(),tableId:vr("locks"),rowId:t,data:a,permissions:o}),!0}catch(l){return console.error("[locksService] Erreur crÃ©ation verrou:",l),!1}return console.warn("[locksService] Acquisition refusÃ©e (peut-Ãªtre dÃ©jÃ  verrouillÃ©):",c.message),!1}},async releaseLock(t,e){const{tables:r}=await D();try{await r.updateRow({databaseId:dt(),tableId:vr("locks"),rowId:t,data:{userId:"",userName:"",expiresAt:new Date(0).toISOString()},permissions:[te.read(ie.any()),te.update(ie.any())]}),console.log(`[locksService] Verrou libÃ©rÃ© (rÃ©initialisÃ©) pour ${t}`)}catch(s){if(s.code===404){console.log(`[locksService] Verrou dÃ©jÃ  libÃ©rÃ© pour ${t}`);return}console.warn("[locksService] Impossible de libÃ©rer le verrou sur le serveur:",s.message)}},subscribeToLock(t,e){const r=dt(),s=vr("locks"),n=`databases.${r}.collections.${s}.documents.${t}`;return console.log("[locksService] Enregistrement du channel de lock:",n),be.registerDynamic([n],a=>{if(a.events?.some(c=>c.endsWith(".delete"))){e(null);return}if(!a.payload)return;const o=a.payload;!o.userId||new Date(o.expiresAt)<new Date?e(null):e(o)})}};function Vg(t,e){const r=t.reduce((n,a)=>n+a.missingQuantities.length,0),s=e.invoiceTotal?1:0;return r+s}async function Wg(t,e,r){let s=null;try{const{account:c}=await D();s=(await c.get()).$id}catch(c){console.warn("[Appwrite Transaction] Impossible de rÃ©cupÃ©rer l'utilisateur connectÃ©:",c)}const n=e.purchaseStatus||"delivered";let a=e.purchaseDeliveryDate||null;n==="delivered"&&!a&&(a=new Date().toISOString());const o=t.flatMap(c=>c.missingQuantities.map(l=>({productId:c.productId,quantity:l.q,unit:l.u,status:n,notes:e.notes||"",store:e.store||"",who:e.who||void 0,price:void 0,orderDate:null,deliveryDate:a,createdBy:s})));return{mainId:r,purchasesData:o,invoiceData:e,fromUserId:s||""}}function Gg(t,e,r=98){const s=[];let n=[],a=0;const o=!!e.invoiceTotal;let c=!1;for(const l of t){const u=l.missingQuantities.length;let d=a+u>r;o&&!c&&n.length>0&&(d=a+u+1>r),d&&n.length>0?(s.push(n),n=[l],a=u,c=!1):(n.push(l),a+=u)}return n.length>0&&s.push(n),s}async function Qg(t){try{const e=bs(),{functions:r}=await D(),s={operation:"createGroupPurchaseWithSync",data:t};console.log(`[Appwrite Interactions] ExÃ©cution du lot: ${t.purchasesData.length} achats Ã  crÃ©er`);const n=await r.createExecution(e.APPWRITE_CONFIG.functions.batchUpdate,JSON.stringify(s),!1,"/","POST");if(n.status!=="completed")throw new Error(`ExÃ©cution Ã©chouÃ©e avec statut: ${n.status}.`);const a=JSON.parse(n.responseBody);return a.success?console.log(`[Appwrite Interactions] Lot exÃ©cutÃ© avec succÃ¨s: ${a.purchasesCreated} achats crÃ©Ã©s`):console.error("[Appwrite Interactions] Lot Ã©chouÃ©:",a.error),a}catch(e){console.error("[Appwrite Interactions] Erreur exÃ©cution lot:",e);const r=e instanceof Error?e.message:"Erreur inconnue";return{success:!1,productsCreated:0,purchasesCreated:0,expenseCreated:!1,totalOperations:0,invoiceId:t.invoiceData.invoiceId,error:r,timestamp:new Date().toISOString()}}}async function Jg(t,e,r){if(!e?.length)return{success:!1,results:[],totalProductsCreated:0,totalPurchasesCreated:0,totalExpensesCreated:0,error:"Aucun produit Ã  traiter"};const s=Vg(e,r);console.log(`[Appwrite Interactions] Achat groupÃ©: ${e.length} produits, ${s} achats Ã  crÃ©er`);const n=Gg(e,r,98);console.log(`[Appwrite Interactions] DÃ©coupage en ${n.length} lot(s) pour respecter la limite de 100 achats par lot`);const a=[];let o=0,c=0,l=0;for(let h=0;h<n.length;h++){const p=n[h];console.log(`[Appwrite Interactions] ExÃ©cution du lot ${h+1}/${n.length} (${p.length} produits)`);try{const g=await Wg(p,r,t),w=await Sd(()=>Qg(g),{operationName:`Lot ${h+1}/${n.length}`,maxAutoRetries:1,autoRetryDelay:2e3});if(!w)throw new Error("OpÃ©ration annulÃ©e ou Ã©chouÃ©e aprÃ¨s tentatives");if(a.push(w),w.success)o+=w.productsCreated,c+=w.purchasesCreated,l+=w.expenseCreated?1:0;else{console.error(`[Appwrite Interactions] Erreur sur le lot ${h+1}: ${w.error}`);break}}catch(g){const w=g instanceof Error?g.message:"Erreur inconnue";console.error(`[Appwrite Interactions] Erreur lors de l'exÃ©cution du lot ${h+1}:`,g),a.push({success:!1,productsCreated:0,purchasesCreated:0,expenseCreated:!1,totalOperations:0,invoiceId:r.invoiceId,error:w,timestamp:new Date().toISOString()});break}}const u=a.every(h=>h.success),d=a.some(h=>!h.success);return{success:u,results:a,totalProductsCreated:o,totalPurchasesCreated:c,totalExpensesCreated:l,error:d?"Un ou plusieurs lots ont Ã©chouÃ©":void 0}}const Kg=Object.freeze(Object.defineProperty({__proto__:null,createGroupPurchaseWithSync:Jg},Symbol.toStringTag,{value:"Module"}));export{Ze as $,m as A,yh as B,Nf as C,Lh as D,Wm as E,yo as F,tg as G,vt as H,k as I,Vr as J,Eh as K,eg as L,ui as M,mi as N,Ke as O,yy as P,Np as Q,Py as R,ay as S,Ay as T,cy as U,D as V,qh as W,Wh as X,Cy as Y,be as Z,Lm as _,Sy as a,pp as a$,cl as a0,ll as a1,rg as a2,Gd as a3,sg as a4,uy as a5,jh as a6,xu as a7,W as a8,Ch as a9,Bg as aA,Oo as aB,xg as aC,Cc as aD,Ky as aE,gt as aF,xy as aG,Rs as aH,ae as aI,Xy as aJ,$h as aK,Xm as aL,Ny as aM,py as aN,ny as aO,Iy as aP,vg as aQ,Ly as aR,op as aS,Fr as aT,cp as aU,ku as aV,jy as aW,ft as aX,hp as aY,Tu as aZ,ig as a_,Oy as aa,_h as ab,ey as ac,by as ad,Yy as ae,_y as af,qu as ag,sy as ah,vy as ai,dy as aj,gr as ak,Cp as al,Ry as am,Ey as an,gy as ao,Wy as ap,Hy as aq,Bo as ar,Vy as as,Gy as at,Tp as au,Uy as av,qy as aw,Jy as ax,og as ay,lg as az,bc as b,Ty as b0,Eg as b1,_g as b2,$o as b3,Xg as b4,ih as b5,Dy as b6,Fg as b7,By as b8,Qy as b9,zi as ba,Po as c,Ro as d,hy as e,oy as f,ry as g,ty as h,fy as i,vc as j,pc as k,wy as l,f as m,un as n,Tf as o,ky as p,$y as q,My as r,my as s,Zg as t,z as u,iy as v,rh as w,ly as x,P as y,ge as z};
