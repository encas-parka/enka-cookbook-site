var vt=u=>{throw TypeError(u)};var Mt=(u,r,l)=>r.has(u)||vt("Cannot "+l);var Ae=(u,r,l)=>(Mt(u,r,"read from private field"),l?l.call(u):r.get(u)),ut=(u,r,l)=>r.has(u)?vt("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(u):r.set(u,l);import{v as h,h as a,g as i,w as D,x as se,b as n,o as t,y as H,z as xt,m as e,A as m,B as Re,d as pe,C as K,D as Ie,u as me,c as be,E as mt,p as le,e as He,i as ot,F as Je,G as Te,H as Ue,I as L,J as Ve,k as $,K as C,L as Pt,M as ft,j as ue,s as Ke,N as Le,O as Ne,P as wt,t as At,Q as Tt,R as Ze,S as et,T as Se,U as tt,V as Ye,W as qe,X as It,Y as Rt,Z as je,_ as at,$ as We,a0 as $e,a1 as Ge,a2 as rt,a3 as Ot,a4 as zt,a5 as Ft}from"./appwrite.js";import{C as kt,P as Lt,E as St,a as qt,L as pt,b as Xe,U as Dt,c as Ct,d as Bt,B as Ut,R as Nt,e as Vt,f as jt,g as Wt,h as $t,X as Et,A as Gt,i as Ht,j as Kt,M as st}from"./icons.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))_(s);new MutationObserver(s=>{for(const v of s)if(v.type==="childList")for(const o of v.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&_(o)}).observe(document,{childList:!0,subtree:!0});function l(s){const v={};return s.integrity&&(v.integrity=s.integrity),s.referrerPolicy&&(v.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?v.credentials="include":s.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function _(s){if(s.ep)return;s.ep=!0;const v=l(s);fetch(s.href,v)}})();var Yt=h('<div class="alert alert-error max-md:alert-vertical shadow-lg"><!> <div><h3 class="font-bold">Erreur</h3> <div class="text-sm"> </div></div></div>');function bt(u,r){var l=Yt(),_=a(l);kt(_,{class:"h-6 w-6 shrink-0 stroke-current"});var s=i(_,2),v=i(a(s),2),o=a(v,!0);t(v),t(s),t(l),D(()=>se(o,r.message)),n(u,l)}var fe;class Xt{constructor(){ut(this,fe,H(xt({title:""})))}get title(){return e(Ae(this,fe)).title||"ENKA Cookbook"}get backAction(){return e(Ae(this,fe)).backAction}get actions(){return e(Ae(this,fe)).actions}get isLockedByOthers(){return e(Ae(this,fe)).isLockedByOthers||!1}get lockedByUserName(){return e(Ae(this,fe)).lockedByUserName||""}get hasUnsavedChanges(){return e(Ae(this,fe)).hasUnsavedChanges||!1}setConfig(r){m(Ae(this,fe),{...r},!0)}reset(){m(Ae(this,fe),{title:""},!0)}}fe=new WeakMap;const Fe=new Xt;var Jt=h('<div class="rounded-box bg-secondary/10 px-4 py-1"><div class="tabs tabs-border justify-center"><button><!> Édition</button> <button><!> Aperçu</button></div></div>');function _t(u,r){pe(r,!0);const l=me(()=>mt.get("mode")||"preview");function _(b){mt.set("mode",b)}var s=Jt(),v=a(s),o=a(v);let p;o.__click=()=>_("edit");var d=a(o);Lt(d,{class:"h-4 w-4"}),K(),t(o);var y=i(o,2);let w;y.__click=()=>_("preview");var k=a(y);St(k,{class:"h-4 w-4"}),K(),t(y),t(v),t(s),D(()=>{p=Ie(o,1,"tab gap-2 font-semibold",null,p,{"tab-active":e(l)==="edit"}),w=Ie(y,1,"tab gap-2 font-semibold",null,w,{"tab-active":e(l)==="preview"})}),n(u,s),be()}Re(["click"]);var Qt=h("<button> </button>"),Zt=h('<div class="rounded-box bg-secondary/10 px-4 py-1"><div class="tabs tabs-border justify-center"></div></div>');function ht(u,r){pe(r,!0);let l=le(r,"basePath",3,"/event");const _=[{label:"Éditer l'événement",relativePath:""},{label:"Voir les recettes",relativePath:"recipes"},{label:"Listes des produits",relativePath:"products"},{label:"Affiches",relativePath:"posters"}],s=me(()=>{const d=Je.pathname;return d.includes("/recipes")?1:d.includes("/products")?2:d.includes("/posters")?3:0});function v(d){if(!r.eventId)return;const y=_[d].relativePath,w=y?`${l()}/${r.eventId}/${y}`:`${l()}/${r.eventId}`;Te(w)}var o=Zt(),p=a(o);He(p,21,()=>_,ot,(d,y,w)=>{var k=Qt();k.__click=()=>v(w);var b=a(k,!0);t(k),D(()=>{Ie(k,1,`tab font-semibold ${w===e(s)?"tab-active":""}`),se(b,e(y).label)}),n(d,k)}),t(p),t(o),n(u,o),be()}Re(["click"]);var ea=h("<button> </button>"),ta=h('<div class="tabs tabs-lg tabs-border justify-center"></div>');function gt(u,r){pe(r,!0);const l=[{label:"Matériel",getPath:()=>s()},{label:"Reservations",getPath:()=>v()}],_=me(()=>Je.pathname.includes("/loans")?1:0);function s(){if(r.currentTeamId)return`/dashboard/materiel/${r.currentTeamId}`;const d=Ue.myTeams;return d.length>0?`/dashboard/materiel/${d[0].$id}`:"/dashboard/materiel"}function v(){if(r.currentTeamId)return`/dashboard/loans/${r.currentTeamId}`;const d=Ue.myTeams;return d.length>0?`/dashboard/loans/${d[0].$id}`:"/dashboard/loans"}function o(d){const y=l[d].getPath();Te(y)}var p=ta();He(p,21,()=>l,ot,(d,y,w)=>{var k=ea();k.__click=()=>o(w);var b=a(k,!0);t(k),D(()=>{Ie(k,1,`tab font-medium ${w===e(_)?"tab-active":""}`),se(b,e(y).label)}),n(d,k)}),t(p),n(u,p),be()}Re(["click"]);var aa=h('<button class="btn btn-ghost not-md:btn-square md:gap-2"><!> <span class="hidden md:inline">Tableau de bord</span></button>'),ra=h('<h1 class="font-family-fredoka truncate text-sm font-bold tracking-wider uppercase opacity-70"> </h1>'),sa=h('<div class="navbar-center absolute left-1/2 -translate-x-1/2 transform"><!></div>'),oa=h('<div class="badge badge-warning flex items-center gap-1 py-3 font-medium"><!> <span class="text-xs"> </span></div>'),na=h('<div class="dropdown dropdown-end"><div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar bg-primary/10 text-primary border-primary/20 border"><div class="flex w-10 items-center justify-center rounded-full text-lg font-bold"> </div></div> <ul class="menu menu-sm dropdown-content bg-base-100 border-base-200 z-1 mt-3 w-56 rounded-xl border p-2 shadow-xl"><li class="border-base-100 mb-1 border-b px-4 py-2"><span class="block truncate p-0 text-xs font-medium italic opacity-60"> </span></li> <li><button class="flex items-center gap-2"><!> Dashboard</button></li> <li><button class="flex items-center gap-2"><!> Équipes</button></li> <li><button class="flex items-center gap-2"><!> Mon compte</button></li> <li><button class="flex items-center gap-2"><!> Nouvel événement</button></li> <li><button class="flex items-center gap-2"><!> Recettes</button></li> <li><button class="disabled:opacity-50"><!> </button></li> <!> <li class="border-base-100 my-1 border-t"></li> <li><button class="text-error hover:bg-error/10"><!> Se déconnecter</button></li></ul></div>'),ia=h('<button class="btn btn-primary btn-sm shadow-md"><!> Connexion</button>'),la=h('<h1 class="text-center text-sm font-bold tracking-wider uppercase opacity-70"> </h1>'),da=h('<div class="border-base-300 bg-base-100 border-b px-4 py-3"><!></div>'),ca=h('<div><div class="navbar-start w-fit shrink-0 gap-1"><a class="btn btn-ghost btn-circle"><img src="/images/favicon.png" alt="logo" class="h-8 w-8"/></a> <div class=" flex items-center gap-1"><!> <button class="btn btn-ghost not-md:btn-square md:gap-2"><!> <span class="hidden md:inline">Recettes</span></button></div></div> <!> <div class="navbar-end ms-auto w-fit shrink-0 gap-4"><!> <div class="flex items-center gap-2"><!></div> <!></div></div> <!>',1);function va(u,r){pe(r,!0);let l=H(!1),_=H(!1);const s=me(()=>{const g=Je.pathname,c=Je.params;return g.includes("/event/")&&c.id?{type:"eventEdit",basePath:"/event",eventId:c.id}:g.includes("/demo/event/")&&c.id?{type:"eventEdit",basePath:"/demo/event",eventId:c.id}:g.includes("/dashboard/materiel/")&&c.teamId?{type:"materiel",teamId:c.teamId}:g.includes("/dashboard/loans/")&&c.teamId?{type:"loans",teamId:c.teamId}:g.includes("/editdocument/")&&c.teamId&&c.docId?{type:"documentEdit",teamId:c.teamId,docId:c.docId}:null});L.isMobile&&L.initializeScrollDirection();function v(){m(l,!1)}async function o(){try{await L.logout(),window.location.href="/"}catch(g){console.error("Erreur lors de la déconnexion:",g)}}function p(){L.authModal.showLogin=!0,L.authModal.isOpen=!0}async function d(){if(L.userId){m(_,!0);try{await Le.forceReloadAllRecipes(),v()}catch(g){console.error("Erreur lors du rechargement des recettes:",g),alert("Erreur lors du rechargement des recettes")}finally{m(_,!1)}}}function y(g){g.target.closest(".svelte-user-dropdown")||v()}Ve(()=>{if(e(l))return document.addEventListener("click",y),()=>document.removeEventListener("click",y)});var w=ca(),k=$(w),b=a(k),O=a(b),N=i(O,2),G=a(N);{var W=g=>{var c=aa();c.__click=()=>Te("/dashboard");var M=a(c);pt(M,{size:18}),K(2),t(c),n(g,c)};C(G,g=>{L.isAuthenticated&&g(W)})}var T=i(G,2);T.__click=()=>Te("/recipe");var x=a(T);qt(x,{size:18}),K(2),t(T),t(N),t(b);var f=i(b,2);{var q=g=>{var c=sa(),M=a(c);{var ee=B=>{gt(B,{get currentTeamId(){return e(s).teamId}})},ae=B=>{var J=ue(),de=$(J);{var ie=j=>{ht(j,{get eventId(){return e(s).eventId},get basePath(){return e(s).basePath}})},te=j=>{var ce=ue(),S=$(ce);{var P=R=>{_t(R,{})},A=R=>{var U=ra(),X=a(U,!0);t(U),D(()=>{ft(U,"title",Fe.title),se(X,Fe.title)}),n(R,U)};C(S,R=>{e(s)?.type==="documentEdit"?R(P):R(A,!1)},!0)}n(j,ce)};C(de,j=>{e(s)?.type==="eventEdit"?j(ie):j(te,!1)},!0)}n(B,J)};C(M,B=>{e(s)?.type==="materiel"||e(s)?.type==="loans"?B(ee):B(ae,!1)})}t(c),n(g,c)};C(f,g=>{L.isDesktop&&g(q)})}var Y=i(f,2),E=a(Y);{var V=g=>{var c=oa(),M=a(c);Xe(M,{size:14});var ee=i(M,2),ae=a(ee);t(ee),t(c),D(()=>se(ae,`Édition par ${Fe.lockedByUserName??""}`)),n(g,c)};C(E,g=>{Fe.isLockedByOthers&&g(V)})}var Q=i(E,2),ne=a(Q);{var _e=g=>{var c=ue(),M=$(c);Ke(M,()=>Fe.actions),n(g,c)};C(ne,g=>{Fe.actions&&g(_e)})}t(Q);var Z=i(Q,2);{var I=g=>{var c=na(),M=a(c),ee=a(M),ae=a(ee,!0);t(ee),t(M);var B=i(M,2),J=a(B),de=a(J),ie=a(de,!0);t(de),t(J);var te=i(J,2),j=a(te);j.__click=()=>Te("/dashboard");var ce=a(j);pt(ce,{size:16}),K(),t(j),t(te);var S=i(te,2),P=a(S);P.__click=()=>Te("/dashboard/teams");var A=a(P);Dt(A,{size:16}),K(),t(P),t(S);var R=i(S,2),U=a(R);U.__click=()=>Te("/dashboard/user");var X=a(U);Ct(X,{size:16}),K(),t(U),t(R);var F=i(R,2),z=a(F);z.__click=()=>Te("/dashboard/eventCreate");var re=a(z);Bt(re,{size:16}),K(),t(z),t(F);var oe=i(F,2),xe=a(oe);xe.__click=()=>Te("/recipe");var we=a(xe);Ut(we,{size:16}),K(),t(xe),t(oe);var he=i(oe,2),ge=a(he);ge.__click=d;var Oe=a(ge);{let ve=me(()=>e(_)?"animate-spin":"");Nt(Oe,{size:16,get class(){return e(ve)}})}var ke=i(Oe);t(ge),t(he);var Ce=i(he,2);C(Ce,ve=>{});var Ee=i(Ce,4),Me=a(Ee);Me.__click=o;var ze=a(Me);Vt(ze,{size:16}),K(),t(Me),t(Ee),t(B),t(c),D(ve=>{se(ae,ve),se(ie,L.user?.email),ge.disabled=e(_),se(ke,` ${e(_)?"Chargement...":"Recharger les recettes"}`)},[()=>L.user?.name?.charAt(0).toUpperCase()||"U"]),n(g,c)},ye=g=>{var c=ia();c.__click=p;var M=a(c);jt(M,{size:16}),K(),t(c),n(g,c)};C(Z,g=>{L.isAuthenticated?g(I):g(ye,!1)})}t(Y),t(k);var De=i(k,2);{var Be=g=>{var c=da(),M=a(c);{var ee=B=>{gt(B,{get currentTeamId(){return e(s).teamId}})},ae=B=>{var J=ue(),de=$(J);{var ie=j=>{ht(j,{get eventId(){return e(s).eventId},get basePath(){return e(s).basePath}})},te=j=>{var ce=ue(),S=$(ce);{var P=R=>{_t(R,{})},A=R=>{var U=ue(),X=$(U);{var F=z=>{var re=la(),oe=a(re,!0);t(re),D(()=>se(oe,Fe.title)),n(z,re)};C(X,z=>{Fe.title&&z(F)},!0)}n(R,U)};C(S,R=>{e(s)?.type==="documentEdit"?R(P):R(A,!1)},!0)}n(j,ce)};C(de,j=>{e(s)?.type==="eventEdit"?j(ie):j(te,!1)},!0)}n(B,J)};C(M,B=>{e(s)?.type==="materiel"||e(s)?.type==="loans"?B(ee):B(ae,!1)})}t(c),n(g,c)};C(De,g=>{L.isDesktop||g(Be)})}D(g=>{Ie(k,1,`navbar bg-base-100 border-base-300 sticky top-0 z-1000 min-h-13 border-b px-4 py-0 shadow-sm transition-transform duration-300 print:hidden ${(L.isMobile&&"min-h-11")??""}
    ${(L.isMobile&&!L.headerVisible&&"-translate-y-full")??""}`),ft(O,"href",g)},[()=>Pt("/")]),n(u,w),be()}Re(["click"]);const ua=u=>u;function nt(u){const r=u-1;return r*r*r+1}function yt(u){const r=typeof u=="string"&&u.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return r?[parseFloat(r[1]),r[2]||"px"]:[u,"px"]}function ma(u,{delay:r=0,duration:l=400,easing:_=ua}={}){const s=+getComputedStyle(u).opacity;return{delay:r,duration:l,easing:_,css:v=>`opacity: ${v*s}`}}function nr(u,{delay:r=0,duration:l=400,easing:_=nt,x:s=0,y:v=0,opacity:o=0}={}){const p=getComputedStyle(u),d=+p.opacity,y=p.transform==="none"?"":p.transform,w=d*(1-o),[k,b]=yt(s),[O,N]=yt(v);return{delay:r,duration:l,easing:_,css:(G,W)=>`
			transform: ${y} translate(${(1-G)*k}${b}, ${(1-G)*O}${N});
			opacity: ${d-w*W}`}}function fa(u,{delay:r=0,duration:l=400,easing:_=nt,axis:s="y"}={}){const v=getComputedStyle(u),o=+v.opacity,p=s==="y"?"height":"width",d=parseFloat(v[p]),y=s==="y"?["top","bottom"]:["left","right"],w=y.map(T=>`${T[0].toUpperCase()}${T.slice(1)}`),k=parseFloat(v[`padding${w[0]}`]),b=parseFloat(v[`padding${w[1]}`]),O=parseFloat(v[`margin${w[0]}`]),N=parseFloat(v[`margin${w[1]}`]),G=parseFloat(v[`border${w[0]}Width`]),W=parseFloat(v[`border${w[1]}Width`]);return{delay:r,duration:l,easing:_,css:T=>`overflow: hidden;opacity: ${Math.min(T*20,1)*o};${p}: ${T*d}px;padding-${y[0]}: ${T*k}px;padding-${y[1]}: ${T*b}px;margin-${y[0]}: ${T*O}px;margin-${y[1]}: ${T*N}px;border-${y[0]}-width: ${T*G}px;border-${y[1]}-width: ${T*W}px;min-${p}: 0`}}function ir(u,{delay:r=0,duration:l=400,easing:_=nt,start:s=0,opacity:v=0}={}){const o=getComputedStyle(u),p=+o.opacity,d=o.transform==="none"?"":o.transform,y=1-s,w=p*(1-v);return{delay:r,duration:l,easing:_,css:(k,b)=>`
			transform: ${d} scale(${1-y*b});
			opacity: ${p-w*b}
		`}}var pa=h('<button class="btn btn-sm btn-primary"> </button>'),ba=h('<button class="btn btn-ghost btn-xs btn-square" title="Voir les détails" aria-label="Voir les détails"><!></button>'),_a=h('<button class="btn btn-ghost btn-xs btn-circle pe-0" title="Fermer" aria-label="Fermer la notification"><!></button>'),ha=h('<div><div class="flex items-center justify-between gap-4"><div class="flex flex-1 items-center gap-2"><!> <span class="text-sm"> </span></div> <!> <!> <!></div></div>'),ga=h("<div></div>");function ya(u,r){pe(r,!0);let l=le(r,"position",3,"toast-center toast-bottom"),_=le(r,"padding",3,"sm");const s=me(()=>_()==="sm"?" py-0.5":"py-1"),v=me(()=>Ne.toasts),o=me(()=>()=>{const b=new Map;for(const O of e(v)){const N=O.position||l();b.has(N)||b.set(N,[]),b.get(N).push(O)}return b});function p(b){Ne.dismiss(b.id)}function d(b){r.onShowDetails?.({id:b.id,message:b.message,details:b.details})}function y(b,O){O.onClick()}var w=ue(),k=$(w);He(k,17,()=>Array.from(e(o)().entries()),([b,O])=>b,(b,O)=>{var N=me(()=>At(e(O),2));let G=()=>e(N)[0],W=()=>e(N)[1];var T=ga();He(T,21,W,x=>x.id,(x,f)=>{var q=ha(),Y=a(q),E=a(Y),V=a(E);{var Q=c=>{Wt(c,{class:"h-5 w-5 animate-spin"})};C(V,c=>{e(f).state==="loading"&&c(Q)})}var ne=i(V,2),_e=a(ne,!0);t(ne),t(E);var Z=i(E,2);{var I=c=>{var M=ue(),ee=$(M);He(ee,17,()=>e(f).actions,ot,(ae,B)=>{var J=pa();J.__click=()=>y(e(f),e(B));var de=a(J,!0);t(J),D(()=>se(de,e(B).label)),n(ae,J)}),n(c,M)};C(Z,c=>{e(f).actions&&e(f).actions.length>0&&c(I)})}var ye=i(Z,2);{var De=c=>{var M=ba();M.__click=()=>d(e(f));var ee=a(M);$t(ee,{class:"h-3 w-3"}),t(M),n(c,M)};C(ye,c=>{e(f).details&&c(De)})}var Be=i(ye,2);{var g=c=>{var M=_a();M.__click=()=>p(e(f));var ee=a(M);Et(ee,{class:"h-4 w-4"}),t(M),n(c,M)};C(Be,c=>{(e(f).state==="error"||e(f).state==="warning"||e(f).state==="loading")&&c(g)})}t(Y),t(q),D(()=>{Ie(q,1,`alert alert-${e(f).state??""}  ${e(s)??""} shadow-lg`),se(_e,e(f).message)}),wt(3,q,()=>fa),n(x,q)}),t(T),D(()=>Ie(T,1,`toast ${G()??""} z-1050`)),n(b,T)}),n(u,w),be()}Re(["click"]);var xa=h('<button class="btn btn-primary btn-circle fixed right-[2%] bottom-10 z-50 rounded-full shadow-lg" aria-label="Retour en haut de page"><!></button>');function wa(u,r){pe(r,!0);let l=me(()=>(Tt.current||0)>300);function _(){window.scrollTo({top:0,behavior:"smooth"})}var s=ue(),v=$(s);{var o=p=>{var d=xa();d.__click=_;var y=a(d);Gt(y,{class:"h-6 w-6"}),t(d),wt(3,d,()=>ma),n(p,d)};C(v,p=>{e(l)&&p(o)})}n(u,s),be()}Re(["click"]);function ka(u,r){pe(r,!0),be()}var Ca=h('<div role="dialog" aria-modal="true"><!></div>'),Ea=h('<div class="modal modal-open" style="z-index: 1100"><div class="modal-box max-w-md"><h3 class="text-lg font-bold">Confirmer la fermeture</h3> <p class="py-4"> </p> <div class="modal-action"><button class="btn btn-ghost">Annuler</button> <button class="btn btn-error">Fermer sans sauvegarder</button></div></div></div>'),Ma=h("<div><!></div> <!>",1);function Pa(u,r){pe(r,!0);let l=le(r,"fullscreenOnMobile",3,!0);le(r,"closeOnBackdropClick",3,!1);let _=le(r,"hasUnsavedChanges",3,!1),s=le(r,"confirmCloseMessage",3,"Vous avez des modifications non sauvegardées. Voulez-vous vraiment fermer ?"),v=le(r,"maxWidth",3,"lg");le(r,"maxHeight",3,"xl");let o=le(r,"modalClass",3,"");function p(x,f){return{sm:{"max-w":"max-w-[28rem]","max-h":"max-h-[85dvh]"},lg:{"max-w":"max-w-[64rem]","max-h":"max-h-[85dvh]"},xl:{"max-w":"max-w-[90vw]","max-h":"max-h-[85dvh]"}}[x][f]}let d=H(!1);function y(){_()?m(d,!0):r.onClose()}function w(){m(d,!1),r.onClose()}function k(){m(d,!1)}Ve(()=>{if(!r.isOpen)return;const x=f=>{f.key==="Escape"&&!e(d)&&y()};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)}),Ve(()=>{if(r.isOpen)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}});var b=Ma(),O=$(b),N=a(O);{var G=x=>{var f=Ca(),q=a(f);Ke(q,()=>r.children),t(f),D(Y=>Ie(f,1,`modal-box flex flex-col p-0 ${o()??""} ${l()&&L.isMobile?"fixed inset-0 m-0 h-lvh w-lvw rounded-none":"fixed top-10 m-auto "} ${Y??""} ${!(l()&&L.isMobile)&&!o()&&"max-h-[85dvh]"}`),[()=>!(l()&&L.isMobile)&&p(v(),"max-w")]),n(x,f)};C(N,x=>{r.isOpen&&x(G)})}t(O);var W=i(O,2);{var T=x=>{var f=Ea(),q=a(f),Y=i(a(q),2),E=a(Y,!0);t(Y);var V=i(Y,2),Q=a(V);Q.__click=k;var ne=i(Q,2);ne.__click=w,t(V),t(q),t(f),D(()=>se(E,s())),n(x,f)};C(W,x=>{e(d)&&x(T)})}D(()=>Ie(O,1,`modal ${(r.isOpen&&"modal-open")??""} `)),n(u,b),be()}Re(["click"]);var Aa=h('<button class="btn btn-circle btn-ghost btn-sm flex-none" aria-label="Retour"><!></button>'),Ta=h('<button class="btn btn-circle btn-ghost btn-sm flex-none" aria-label="Retour"><!></button>'),Ia=h('<p class="text-base-content/70 truncate text-sm"> </p>'),Ra=h('<div class="flex items-center gap-2 sm:me-10"><!></div>'),Oa=h('<div class="border-base-300 flex-none border-b px-4 py-3"><div class="absolute top-2 right-2"><!></div> <div class="flex flex-wrap items-center gap-2"><div class="flex min-w-0 flex-1 items-center gap-2"><!> <div class="max-w-11/12 min-w-0 flex-1 items-baseline"><h3 class="truncate text-lg font-bold"> </h3> <!></div></div> <!></div></div>');function za(u,r){pe(r,!0);let l=le(r,"showBackButton",3,!0);var _=Oa(),s=a(_),v=a(s);{var o=x=>{var f=Aa();f.__click=function(...Y){r.onClose?.apply(this,Y)};var q=a(f);Et(q,{class:"h-5 w-5"}),t(f),n(x,f)};C(v,x=>{L.isMobile||x(o)})}t(s);var p=i(s,2),d=a(p),y=a(d);{var w=x=>{var f=Ta();f.__click=function(...Y){r.onClose?.apply(this,Y)};var q=a(f);Ht(q,{class:"h-5 w-5"}),t(f),n(x,f)};C(y,x=>{l()&&L.isMobile&&x(w)})}var k=i(y,2),b=a(k),O=a(b,!0);t(b);var N=i(b,2);{var G=x=>{var f=Ia(),q=a(f,!0);t(f),D(()=>se(q,r.subtitle)),n(x,f)};C(N,x=>{r.subtitle&&x(G)})}t(k),t(d);var W=i(d,2);{var T=x=>{var f=Ra(),q=a(f);Ke(q,()=>r.children),t(f),n(x,f)};C(W,x=>{r.children&&x(T)})}t(p),t(_),D(()=>se(O,r.title)),n(u,_),be()}Re(["click"]);var Fa=h('<div class="flex-1 overflow-y-auto p-4 sm:p-6 sm:pt-2"><!></div>');function La(u,r){var l=Fa(),_=a(l);Ke(_,()=>r.children),t(l),n(u,l)}var Sa=h('<div class="border-base-300 flex-none border-t px-4 py-3"><div class="flex flex-wrap items-center justify-end gap-2"><!></div></div>');function qa(u,r){var l=Sa(),_=a(l),s=a(_);Ke(s,()=>r.children),t(_),t(l),n(u,l)}var Da=h('<div role="alert" class="alert alert-error max-md:alert-vertical svelte-o861tn"><!> <span> </span></div>'),Ba=h('<div role="alert" class="alert alert-success max-md:alert-vertical svelte-o861tn"><!> <span> </span></div>'),Ua=h(`<form id="forgotForm" class="space-y-4 svelte-o861tn"><fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="email" placeholder="votre@email.com" required aria-required="true"/></label> <span class="validator-hint hidden">Adresse email valide requise</span></fieldset> <div class="alert alert-info alert-soft svelte-o861tn">Un email avec un lien vous sera envoyé pour renouveller votre mot de
            passe.". Pensez à vérifier s'il n'a pas attéri dans votre dossier
            spam.</div></form> <div class="text-center svelte-o861tn"><button class="btn btn-ghost btn-sm">← Retour à la connexion</button></div>`,1),Na=h(`<form id="loginForm" class="space-y-4 svelte-o861tn"><fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="email" placeholder="votre@email.com" required aria-required="true"/></label> <span class="validator-hint hidden">Adresse email valide requise</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="password" placeholder="Mot de passe" required aria-required="true"/></label> <span class="validator-hint hidden">Mot de passe requis</span></fieldset></form> <div class="space-y-2 text-center svelte-o861tn"><button class="btn btn-link btn-sm btn-primary svelte-o861tn">Mot de passe oublié ?</button> <div class="text-base-content/70 text-sm svelte-o861tn">Pas encore de compte ? <button class="btn btn-primary btn-sm btn-soft ms-1">S'inscrire</button></div></div>`,1),Va=h(`<form id="registerForm" class="space-y-4 svelte-o861tn"><fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="text" placeholder="Votre nom" required aria-required="true" minlength="3" maxlength="25"/></label> <span class="validator-hint hidden">Doit comporter entre 3 et 25 caractères.</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="email" placeholder="votre@email.com" required aria-required="true"/></label> <span class="validator-hint hidden">Adresse email valide requise</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="password" placeholder="Mot de passe" required aria-required="true" minlength="8" maxlength="25"/></label> <span class="validator-hint hidden">Doit comporter entre 8 et 25 caractères.</span></fieldset> <fieldset class="svelte-o861tn"><label class="input validator required w-full"><!> <input type="password" placeholder="Confirmer le mot de passe" required aria-required="true" minlength="8" maxlength="25"/></label> <span class="validator-hint hidden">Doit être identique au mot de passe ci-dessus.</span></fieldset> <div class="alert alert-info alert-soft svelte-o861tn">Un email avec un lien vous sera envoyé. Pensez à vérifier s'il n'a
            pas attéri dans votre dossier spam.</div></form> <div class="text-base-content/70 text-center text-sm svelte-o861tn">Déjà un compte ? <button class="btn btn-soft btn-sm btn-primary ms-1">Se connecter</button></div>`,1),ja=h('<div class="space-y-4 py-4 svelte-o861tn"><!> <!> <!></div>'),Wa=h('<span class="loading loading-spinner"></span>'),$a=h('<button form="forgotForm" type="submit" class="btn btn-primary btn-block"><!></button>'),Ga=h('<span class="loading loading-spinner"></span>'),Ha=h('<button form="loginForm" type="submit" class="btn btn-primary btn-block"><!></button>'),Ka=h('<span class="loading loading-spinner"></span>'),Ya=h('<button form="registerForm" type="submit" class="btn btn-success btn-block"><!></button>'),Xa=h("<!> <!> <!>",1);function Ja(u,r){pe(r,!0);let l=le(r,"isOpen",15),_=le(r,"onAuth_success",3,async()=>{}),s=le(r,"showLogin",3,!0),v=H(xt(s())),o=H(!1),p=H(""),d=H("");Ve(()=>{l()&&(m(v,s()),m(W,!1))});let y=H(""),w=H(""),k=H(""),b=H(""),O=H(""),N=H(""),G=H(""),W=H(!1),T,x,f;async function q(I){if(I.preventDefault(),!T.checkValidity()){T.reportValidity(),m(p,"Formulaire invalide. Veuillez vérifier les champs.");return}m(p,""),await V()}async function Y(I){if(I.preventDefault(),e(O)!==e(N)){m(p,"Les mots de passe ne correspondent pas.");return}if(!x.checkValidity()){x.reportValidity(),m(p,"Formulaire invalide. Veuillez vérifier les champs.");return}m(p,""),await Q()}async function E(I){if(I.preventDefault(),!f.checkValidity()){f.reportValidity(),m(p,"Formulaire invalide. Veuillez vérifier les champs.");return}m(p,""),await ne()}async function V(){m(o,!0);try{const{account:I}=await Ye();await I.createEmailPasswordSession({email:e(y),password:e(w)}),m(d,"Connexion réussie !"),setTimeout(()=>{_()()},1e3)}catch(I){console.error("Erreur de connexion:",I),m(p,I.message||"Erreur lors de la connexion",!0)}finally{m(o,!1)}}async function Q(){m(o,!0);try{const{account:I}=await Ye();await I.create({userId:"unique()",email:e(b),password:e(O),name:e(k)}),await I.createEmailPasswordSession({email:e(b),password:e(O)}),m(d,"Compte créé et connecté !"),setTimeout(()=>{_()()},1e3)}catch(I){if(console.error("Erreur d'inscription:",I),I.response?.code===409||I.message?.includes("already registered")||I.message?.includes("already exists"))try{const{account:ye}=await Ye();await ye.createRecovery({email:e(b),url:`${window.location.origin}/reset-password`}),m(d,"Un compte avec cet email existe déjà. Un email de réinitialisation de mot de passe vous a été envoyé."),setTimeout(()=>{m(v,!0),m(d,""),m(y,e(b),!0)},4e3)}catch(ye){console.error("Erreur lors de l'envoi de l'email de récupération:",ye),m(p,"Un compte avec cet email existe déjà, mais nous n'avons pas pu vous envoyer l'email de réinitialisation. Utilisez l'option 'Mot de passe oublié ?'.")}else m(p,I.message||"Erreur lors de la création du compte",!0)}finally{m(o,!1)}}async function ne(){m(o,!0);try{const{account:I}=await Ye();await I.createRecovery({email:e(G),url:`${window.location.origin}/reset-password`}),m(d,"Email de réinitialisation envoyé !"),setTimeout(()=>{m(W,!1),m(G,"")},2e3)}catch(I){console.error("Erreur mot de passe oublié:",I),m(p,I.message||"Erreur lors de l'envoi de l'email",!0)}finally{m(o,!1)}}function _e(){e(o)||l(!1)}Ve(()=>{(e(v)||e(W))&&(m(p,""),m(d,""))});function Z(){return e(W)?"Mot de passe oublié":e(v)?"Connexion":"Inscription"}Pa(u,{get isOpen(){return l()},onClose:_e,maxWidth:"sm",children:(I,ye)=>{var De=Xa(),Be=$(De);{let M=me(Z);za(Be,{get title(){return e(M)},onClose:_e})}var g=i(Be,2);La(g,{children:(M,ee)=>{var ae=ja(),B=a(ae);{var J=S=>{var P=Da(),A=a(P);kt(A,{class:"h-6 w-6 shrink-0 stroke-current"});var R=i(A,2),U=a(R,!0);t(R),t(P),D(()=>se(U,e(p))),n(S,P)};C(B,S=>{e(p)&&S(J)})}var de=i(B,2);{var ie=S=>{var P=Ba(),A=a(P);Kt(A,{class:"h-6 w-6 shrink-0 stroke-current"});var R=i(A,2),U=a(R,!0);t(R),t(P),D(()=>se(U,e(d))),n(S,P)};C(de,S=>{e(d)&&S(ie)})}var te=i(de,2);{var j=S=>{var P=Ua(),A=$(P),R=a(A),U=a(R),X=a(U);st(X,{class:"h-4 w-4 opacity-50"});var F=i(X,2);qe(F),t(U),K(2),t(R),K(2),t(A),Ze(A,oe=>f=oe,()=>f);var z=i(A,2),re=a(z);re.__click=()=>m(W,!1),t(z),D(()=>{F.disabled=e(o),re.disabled=e(o)}),et("submit",A,E),Se(F,()=>e(G),oe=>m(G,oe)),n(S,P)},ce=S=>{var P=ue(),A=$(P);{var R=X=>{var F=Na(),z=$(F),re=a(z),oe=a(re),xe=a(oe);st(xe,{class:"h-4 w-4 opacity-50"});var we=i(xe,2);qe(we),t(oe),K(2),t(re);var he=i(re,2),ge=a(he),Oe=a(ge);Xe(Oe,{class:"h-4 w-4 opacity-50"});var ke=i(Oe,2);qe(ke),t(ge),K(2),t(he),t(z),Ze(z,ve=>T=ve,()=>T);var Ce=i(z,2),Ee=a(Ce);Ee.__click=()=>m(W,!0);var Me=i(Ee,2),ze=i(a(Me));ze.__click=()=>m(v,!1),t(Me),t(Ce),D(()=>{we.disabled=e(o),ke.disabled=e(o),Ee.disabled=e(o),ze.disabled=e(o)}),et("submit",z,q),Se(we,()=>e(y),ve=>m(y,ve)),Se(ke,()=>e(w),ve=>m(w,ve)),n(X,F)},U=X=>{var F=Va(),z=$(F),re=a(z),oe=a(re),xe=a(oe);Ct(xe,{class:"h-4 w-4 opacity-50"});var we=i(xe,2);qe(we),t(oe),K(2),t(re);var he=i(re,2),ge=a(he),Oe=a(ge);st(Oe,{class:"h-4 w-4 opacity-50"});var ke=i(Oe,2);qe(ke),t(ge),K(2),t(he);var Ce=i(he,2),Ee=a(Ce),Me=a(Ee);Xe(Me,{class:"h-4 w-4 opacity-50"});var ze=i(Me,2);qe(ze),t(Ee),K(2),t(Ce);var ve=i(Ce,2),it=a(ve),lt=a(it);Xe(lt,{class:"h-4 w-4 opacity-50"});var Qe=i(lt,2);qe(Qe),t(it),K(2),t(ve),K(2),t(z),Ze(z,Pe=>x=Pe,()=>x);var dt=i(z,2),ct=i(a(dt));ct.__click=()=>m(v,!0),t(dt),D(()=>{we.disabled=e(o),ke.disabled=e(o),ze.disabled=e(o),Qe.disabled=e(o),ct.disabled=e(o)}),et("submit",z,Y),Se(we,()=>e(k),Pe=>m(k,Pe)),Se(ke,()=>e(b),Pe=>m(b,Pe)),Se(ze,()=>e(O),Pe=>m(O,Pe)),Se(Qe,()=>e(N),Pe=>m(N,Pe)),n(X,F)};C(A,X=>{e(v)?X(R):X(U,!1)},!0)}n(S,P)};C(te,S=>{e(W)?S(j):S(ce,!1)})}t(ae),n(M,ae)}});var c=i(g,2);qa(c,{children:(M,ee)=>{var ae=ue(),B=$(ae);{var J=ie=>{var te=$a(),j=a(te);{var ce=P=>{var A=Wa();n(P,A)},S=P=>{var A=tt("Envoyer l'email de réinitialisation");n(P,A)};C(j,P=>{e(o)?P(ce):P(S,!1)})}t(te),D(()=>te.disabled=e(o)),n(ie,te)},de=ie=>{var te=ue(),j=$(te);{var ce=P=>{var A=Ha(),R=a(A);{var U=F=>{var z=Ga();n(F,z)},X=F=>{var z=tt("Se connecter");n(F,z)};C(R,F=>{e(o)?F(U):F(X,!1)})}t(A),D(()=>A.disabled=e(o)),n(P,A)},S=P=>{var A=Ya(),R=a(A);{var U=F=>{var z=Ka();n(F,z)},X=F=>{var z=tt("Créer un compte");n(F,z)};C(R,F=>{e(o)?F(U):F(X,!1)})}t(A),D(()=>A.disabled=e(o)),n(P,A)};C(j,P=>{e(v)?P(ce):P(S,!1)},!0)}n(ie,te)};C(B,ie=>{e(W)?ie(J):ie(de,!1)})}n(M,ae)}}),n(I,De)},$$slots:{default:!0}}),be()}Re(["click"]);var Qa=h('<div class="flex h-[50vh] items-center justify-center"><!></div>'),Za=h('<div class="flex h-[80vh] flex-col items-center justify-center gap-4"><div class="loading loading-spinner loading-lg text-primary"></div> <p class="text-base-content/70 animate-pulse font-medium">Démarrage...</p></div>'),er=h("<!> <!>",1),tr=h('<link rel="preconnect" href="https://fonts.googleapis.com"/> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/> <link href="https://fonts.googleapis.com/css2?family=Cherry+Bomb+One&amp;family=Fredoka:wght@300..700&amp;display=swap&amp;family=Sora:wght@100..800&amp;display=swap" rel="stylesheet"/> <div class="grid min-h-screen grid-rows-[auto_1fr]"><!> <div class="bg-base-200"><!></div></div> <!> <!> <!> <!>',1);function ar(u,r){pe(r,!0);let l=H("BOOTING"),_=H(null);async function s(){try{if(m(l,"BOOTING"),await L.initializeAuth(),m(l,"READY"),L.isAuthenticated){const E=Ne.loading("Chargement des données...");Promise.all([Le.loadCache(),We.loadCache(),$e.loadCache(),Ge.loadCache()]).then(async()=>(Ne.update(E,{state:"loading",message:"Mise à jour des données en cours..."}),Promise.all([Le.syncFromRemote(),We.syncFromRemote(),$e.syncFromRemote(),Ue.syncFromRemote(),Ge.syncFromRemote()]))).catch(V=>{console.error("[App] Erreur synchro privée:",V)}).then(async()=>{await Promise.all([We.setupRealtime(),Le.setupRealtime(),$e.setupRealtime(),Ue.setupRealtime(),at.initialize(),Ge.setupRealtime()]),await je.initialize(),Ne.update(E,{state:"success",message:"Données chargées",autoCloseDelay:2e3}),setTimeout(()=>{rt("/dashboard"),rt("/recipe")},3e3)}).catch(V=>{console.error("[App] Erreur setup realtime:",V),Ne.update(E,{state:"warning",message:"Mode hors ligne : données mises en cache",autoCloseDelay:5e3})})}else Le.loadCache().then(()=>Le.syncFromRemotePublicOnly()).then(()=>Promise.all([Le.setupRealtime(),je.initialize()])).then(()=>{setTimeout(()=>{rt("/recipe")},2e3)}).catch(E=>{console.error("[App] Erreur synchro publique:",E)})}catch(E){console.error("[App] Erreur fatale d'initialisation:",E),m(_,E.message||"Erreur critique de chargement",!0),m(l,"ERROR")}}let v=H(!1),o=H(!1);function p(){console.log("[App] Nettoyage des stores privés..."),at.destroy(),Ue.destroy(),We.destroy(),$e.destroy(),Ge.destroy()}Ve(()=>{const E=L.isAuthenticated;e(o)||e(l)!=="BOOTING"&&E!==e(v)&&(m(v,E,!0),E?(console.log("[App] Connexion détectée"),je.destroy()):(console.log("[App] Déconnexion détectée"),p(),je.destroy()),console.log("[App] Changement d'état Auth -> Réinitialisation"),m(o,!0),s().finally(()=>{m(o,!1)}))}),It(()=>{s()}),Rt(()=>{console.log("[App] Destruction de l'application - Nettoyage des stores..."),at.destroy(),Ue.destroy(),We.destroy(),Le.destroy(),$e.destroy(),Ge.destroy(),je.destroy()});let d=me(()=>e(_)||Ot.error);async function y(){L.authModal.isOpen=!1,await L.refreshAuthAfterLogin()}var w=tr(),k=i($(w),6),b=a(k);va(b,{});var O=i(b,2),N=a(O);{var G=E=>{var V=Qa(),Q=a(V);{let ne=me(()=>e(d)||"Erreur inconnue");bt(Q,{get message(){return e(ne)}})}t(V),n(E,V)},W=E=>{var V=ue(),Q=$(V);{var ne=Z=>{var I=Za();n(Z,I)},_e=Z=>{zt(Z,{})};C(Q,Z=>{e(l)==="BOOTING"?Z(ne):Z(_e,!1)},!0)}n(E,V)};C(N,E=>{e(l)==="ERROR"?E(G):E(W,!1)})}t(O),t(k);var T=i(k,2);ya(T,{});var x=i(T,2);wa(x,{});var f=i(x,2);{var q=E=>{var V=er(),Q=$(V);{var ne=Z=>{bt(Z,{get message(){return e(d)}})};C(Q,Z=>{e(d)&&Z(ne)})}var _e=i(Q,2);ka(_e,{}),n(E,V)};C(f,E=>{L.isAuthenticated&&E(q)})}var Y=i(f,2);Ja(Y,{get showLogin(){return L.authModal.showLogin},onAuth_success:y,get isOpen(){return L.authModal.isOpen},set isOpen(E){L.authModal.isOpen=E}}),n(u,w),be()}Ft(ar,{target:document.getElementById("app")});export{Pa as M,ma as a,za as b,La as c,qa as d,ir as e,nr as f,Fe as n,fa as s};
